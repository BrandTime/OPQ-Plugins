2020/09/06 08:16:50.993 [E]  QQLuaVmRun CallGlobal err Unknow Lua Function:ReceiveEvents detail File weatherfy4a.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136074 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:546556936 MsgSeq:136074 UserID:1689236904]
2020/09/06 08:37:08.954 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136101 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:2450459910 GroupID:383770908 MsgRandom:648773847 MsgSeq:136101 UserID:2450459910]
2020/09/06 08:37:56.312 [E]  QQLuaVmRun CallGlobal err <string>:296: cannot perform concat operation between string and nil
stack traceback:
	<string>:296: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{959562190 测试群 2450459910 凤飞翱翔兮丷 {"GroupPic":[{"FileId":3114005357,"FileMd5":"acZ6doC2tX0hlqvcsS3/Dw==","FileSize":29867,"ForwordBuf":"Eip7NjlDNjdBNzYtODBCNi1CNTdELTIxOTYtQUJEQ0IxMkRGRjBGfS5qcGciACoESggDADJgFTYgOTZrRTFBYjk5YmYzNmRjZGM0YzBiNyAgICAgIDUwICAgICAgICAgICAgICAgIHs2OUM2N0E3Ni04MEI2LUI1N0QtMjE5Ni1BQkRDQjEyREZGMEZ9LmpwZzEyMTJBOO3m78wLQLeBk+4MSFBQQVoAYAFqEGnGenaAtrV9IZar3LEt/w9yWy9nY2hhdHBpY19uZXcvMjQ1MDQ1OTkxMC85NTk1NjIxOTAtMzExNDAwNTM1Ny02OUM2N0E3NjgwQjZCNTdEMjE5NkFCRENCMTJERkYwRi8xOTg/dGVybT0yNTWCAVkvZ2NoYXRwaWNfbmV3LzI0NTA0NTk5MTAvOTU5NTYyMTkwLTMxMTQwMDUzNTctNjlDNjdBNzY4MEI2QjU3RDIxOTZBQkRDQjEyREZGMEYvMD90ZXJtPTI1NaAB6AewAe8EuAH2BMgBq+kB2AHDAeABxgH6AVsvZ2NoYXRwaWNfbmV3LzI0NTA0NTk5MTAvOTU5NTYyMTkwLTMxMTQwMDUzNTctNjlDNjdBNzY4MEI2QjU3RDIxOTZBQkRDQjEyREZGMEYvNDAwP3Rlcm09MjU1gAL7AogCgAM=","ForwordField":8,"Url":"http://gchat.qpic.cn/gchatpic_new/2450459910/959562190-2534335053-69C67A7680B6B57D2196ABDCB12DFF0F/0?vuin=1689236904\u0026term=255\u0026pictype=0"}],"Tips":"[群图片]"} PicMsg 1599352676 6425 469058054 <nil>} 
2020/09/06 08:38:01.655 [E]  QQLuaVmRun CallGlobal err <string>:296: cannot perform concat operation between string and nil
stack traceback:
	<string>:296: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{959562190 测试群 2450459910 凤飞翱翔兮丷 {"GroupPic":[{"FileId":3035297055,"FileMd5":"O8XSH1LPEWW4zY1Nh/XpaA==","FileSize":5264,"ForwordBuf":"Eip7M0JDNUQyMUYtNTJDRi0xMTY1LUI4Q0QtOEQ0RDg3RjVFOTY4fS5qcGciACoESggDADJgFTYgOTZrRTFBYjRlYWY1MWZkMmM0YzBiNyAgICAgIDUwICAgICAgICAgICAgICAgIHszQkM1RDIxRi01MkNGLTExNjUtQjhDRC04RDREODdGNUU5Njh9LmpwZzEyMTJBOJ/qq6cLQLeBk5YNSFBQQVoAYAFqEDvF0h9SzxFluM2NTYf16WhyWy9nY2hhdHBpY19uZXcvMjQ1MDQ1OTkxMC85NTk1NjIxOTAtMzAzNTI5NzA1NS0zQkM1RDIxRjUyQ0YxMTY1QjhDRDhENEQ4N0Y1RTk2OC8xOTg/dGVybT0yNTWCAVkvZ2NoYXRwaWNfbmV3LzI0NTA0NTk5MTAvOTU5NTYyMTkwLTMwMzUyOTcwNTUtM0JDNUQyMUY1MkNGMTE2NUI4Q0Q4RDREODdGNUU5NjgvMD90ZXJtPTI1NaAB6AewAcMBuAHGAcgBkCnYAcMB4AHGAfoBWy9nY2hhdHBpY19uZXcvMjQ1MDQ1OTkxMC85NTk1NjIxOTAtMzAzNTI5NzA1NS0zQkM1RDIxRjUyQ0YxMTY1QjhDRDhENEQ4N0Y1RTk2OC80MDA/dGVybT0yNTWAAsMBiALGAQ==","ForwordField":8,"Url":"http://gchat.qpic.cn/gchatpic_new/2450459910/959562190-2534335053-3BC5D21F52CF1165B8CD8D4D87F5E968/0?vuin=1689236904\u0026term=255\u0026pictype=0"}],"Tips":"[群图片]"} PicMsg 1599352681 6426 3050329951 <nil>} 
2020/09/06 08:38:05.647 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{959562190 0 ON_EVENT_GROUP_REVOKE 6426 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:2450459910 GroupID:959562190 MsgRandom:3050329951 MsgSeq:6426 UserID:2450459910]
2020/09/06 08:38:18.341 [E]  QQLuaVmRun CallGlobal err <string>:296: cannot perform concat operation between string and nil
stack traceback:
	<string>:296: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{959562190 测试群 2450459910 凤飞翱翔兮丷 {"GroupPic":[{"FileId":2287812468,"FileMd5":"CwSJAi/zgapi8LVqJBlpuw==","FileSize":165290,"ForwordBuf":"Eip7MEIwNDg5MDItMkZGMy04MUFBLTYyRjAtQjU2QTI0MTk2OUJCfS5qcGciACoEEQAAADJcFTYgOTJrQTFDODg1ZDNmNzRjZGM0YzBiNyAgICAgIDUwICAgICAgICAgICAgICAgIHswQjA0ODkwMi0yRkYzLTgxQUEtNjJGMC1CNTZBMjQxOTY5QkJ9LmpwZ0E49P70wghAt4GT7gxIUFBDWgBgAWoQCwSJAi/zgapi8LVqJBlpu3JbL2djaGF0cGljX25ldy8yNDUwNDU5OTEwLzk1OTU2MjE5MC0yMjg3ODEyNDY4LTBCMDQ4OTAyMkZGMzgxQUE2MkYwQjU2QTI0MTk2OUJCLzE5OD90ZXJtPTI1NYIBWS9nY2hhdHBpY19uZXcvMjQ1MDQ1OTkxMC85NTk1NjIxOTAtMjI4NzgxMjQ2OC0wQjA0ODkwMjJGRjM4MUFBNjJGMEI1NkEyNDE5NjlCQi8wP3Rlcm09MjU1oAHoB7ABuAi4AYAPyAGqiwrYAW/gAcYB+gFbL2djaGF0cGljX25ldy8yNDUwNDU5OTEwLzk1OTU2MjE5MC0yMjg3ODEyNDY4LTBCMDQ4OTAyMkZGMzgxQUE2MkYwQjU2QTI0MTk2OUJCLzQwMD90ZXJtPTI1NYAC2AGIAoAD","ForwordField":8,"Url":"http://gchat.qpic.cn/gchatpic_new/2450459910/959562190-2534335053-0B0489022FF381AA62F0B56A241969BB/0?vuin=1689236904\u0026term=255\u0026pictype=0"}],"Tips":"[群图片]"} PicMsg 1599352698 6427 1094229376 <nil>} 
2020/09/06 08:38:22.899 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{959562190 0 ON_EVENT_GROUP_REVOKE 6427 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:2450459910 GroupID:959562190 MsgRandom:1094229376 MsgSeq:6427 UserID:2450459910]
2020/09/06 08:53:29.515 [E]  当前账号只能登陆一个QQ哦 与历史登陆QQ1689236904不符 如需换绑请联系管理员
2020/09/06 08:54:08.430 [E]  QQLuaVmRun CallGlobal err <string>:296: cannot perform concat operation between string and nil
stack traceback:
	<string>:296: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{959562190 测试群 2450459910 凤飞翱翔兮丷 {"GroupPic":[{"FileId":2728861197,"FileMd5":"acZ6doC2tX0hlqvcsS3/Dw==","FileSize":29867,"ForwordBuf":"Eip7NjlDNjdBNzYtODBCNi1CNTdELTIxOTYtQUJEQ0IxMkRGRjBGfS5qcGciACoESggDADJgFTYgOTZrRTFBYTJhNzFlMGQyYTU2YTdkZiAgICAgIDUwICAgICAgICAgICAgICAgIHs2OUM2N0E3Ni04MEI2LUI1N0QtMjE5Ni1BQkRDQjEyREZGMEZ9LmpwZzEyMTJBOI28nJUKQN/P2tICSFBQQVoAYAFqEGnGenaAtrV9IZar3LEt/w9yWy9nY2hhdHBpY19uZXcvMjQ1MDQ1OTkxMC85NTk1NjIxOTAtMjcyODg2MTE5Ny02OUM2N0E3NjgwQjZCNTdEMjE5NkFCRENCMTJERkYwRi8xOTg/dGVybT0yNTWCAVkvZ2NoYXRwaWNfbmV3LzI0NTA0NTk5MTAvOTU5NTYyMTkwLTI3Mjg4NjExOTctNjlDNjdBNzY4MEI2QjU3RDIxOTZBQkRDQjEyREZGMEYvMD90ZXJtPTI1NaAB6AewAe8EuAH2BMgBq+kB2AHDAeABxgH6AVsvZ2NoYXRwaWNfbmV3LzI0NTA0NTk5MTAvOTU5NTYyMTkwLTI3Mjg4NjExOTctNjlDNjdBNzY4MEI2QjU3RDIxOTZBQkRDQjEyREZGMEYvNDAwP3Rlcm09MjU1gAL7AogCgAM=","ForwordField":8,"Url":"http://gchat.qpic.cn/gchatpic_new/2450459910/959562190-2534335053-69C67A7680B6B57D2196ABDCB12DFF0F/0?vuin=1689236904\u0026term=255\u0026pictype=0"}],"Tips":"[群图片]"} PicMsg 1599353648 6428 371034904 <nil>} 
2020/09/06 08:57:20.685 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136108 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:3440211606 MsgSeq:136108 UserID:1689236904]
2020/09/06 08:57:33.081 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136112 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:307217488 MsgSeq:136112 UserID:1689236904]
2020/09/06 08:57:36.098 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136113 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:612316128 MsgSeq:136113 UserID:1689236904]
2020/09/06 14:45:47.879 [E]  setulocal.lua
2020/09/06 14:45:47.888 [E]  local log = require("log")
local Api = require("coreApi")
local json = require("json")
local http = require("http")

if data.FromGroupId == 383770908 then

function ReceiveFriendMsg(CurrentQQ, data)
    return 1
end
function ReceiveGroupMsg(CurrentQQ, data)
	if data.Content == '看腿' then 
	math.randomseed(tonumber(tostring(os.time()):reverse():sub(1, 6)))
	local randomNum = math.random(1,404)
	-- 图片路径
	local path = "/home/ffaxx/图片/PrettyLegs/"..randomNum..".jpg"
	res = readImg(path)
	base64 = PkgCodec.EncodeBase64(res)
	 Api.Api_SendMsg(
		CurrentQQ,
		{
				toUser = data.FromGroupId,
				sendToType = 2,
				sendMsgType = "PicMsg",
				groupid = 0,
				content = "30s自动撤回",
				picUrl = "",
				picBase64Buf = base64,
				fileMd5 = "",
				atUser = 0
		}
	)
	end
	
	if data.Content == '妹子' then 
	math.randomseed(tonumber(tostring(os.time()):reverse():sub(1, 6)))
	local randomNum = math.random(1000,1563)
	-- 图片路径
	local path = "/home/ffaxx/图片/PrettyLegs/"..randomNum..".jpg"
	res = readImg(path)
	base64 = PkgCodec.EncodeBase64(res)
	 Api.Api_SendMsg(
		CurrentQQ,
		{
				toUser = data.FromGroupId,
				sendToType = 2,
				sendMsgType = "PicMsg",
				groupid = 0,
				content = "30s自动撤回",
				picUrl = "",
				picBase64Buf = base64,
				fileMd5 = "",
				atUser = 0
		}
	)
	end
	
	if data.Content == '18妹子' then 
	math.randomseed(tonumber(tostring(os.time()):reverse():sub(1, 6)))
	local randomNum = math.random(5000,5066)
	-- 图片路径
	local path = "/home/ffaxx/图片/PrettyLegs/"..randomNum..".jpg"
	res = readImg(path)
	base64 = PkgCodec.EncodeBase64(res)
	 Api.Api_SendMsg(
		CurrentQQ,
		{
				toUser = data.FromGroupId,
				sendToType = 2,
				sendMsgType = "PicMsg",
				groupid = 0,
				content = "30s自动撤回",
				picUrl = "",
				picBase64Buf = base64,
				fileMd5 = "",
				atUser = 0
		}
	)
	end
    return 1
end
function ReceiveEvents(CurrentQQ, data, extData)
    return 1
end
function readImg(filePath)
    local f, err = io.open(filePath, "rb")
    if err ~= nil then
        return nil, err
    end
    local content = f:read("*all")
    f:close()
    return content, err
end
end
2020/09/06 14:46:58.962 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136168 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:375106967 MsgSeq:136168 UserID:1689236904]
2020/09/06 15:09:36.479 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{959562190 0 ON_EVENT_GROUP_REVOKE 6431 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:959562190 MsgRandom:2014621013 MsgSeq:6431 UserID:1689236904]
2020/09/06 15:10:06.908 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{959562190 0 ON_EVENT_GROUP_REVOKE 6433 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:959562190 MsgRandom:2722056392 MsgSeq:6433 UserID:1689236904]
2020/09/06 15:12:07.748 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136170 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:3672771473 MsgSeq:136170 UserID:1689236904]
2020/09/06 15:14:40.914 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136173 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:1860361901 MsgSeq:136173 UserID:1689236904]
2020/09/06 15:14:42.064 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136177 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:1013487619 MsgSeq:136177 UserID:1689236904]
2020/09/06 15:14:47.381 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136179 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:129209806 MsgSeq:136179 UserID:1689236904]
2020/09/06 15:15:08.468 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136181 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:2615635386 MsgSeq:136181 UserID:1689236904]
2020/09/06 18:44:09.442 [E]  QQLuaVmRun CallGlobal err Unknow Lua Function:ReceiveEvents detail File weatherfy4a.lua when  call ReceiveEvents params [0] 1689236904  [1] &{1002580618 1689236904 ON_EVENT_GROUP_EXIT 0 群成员退出群聊事件 <nil>}  [2] map[UserID:773324834]
2020/09/06 19:29:05.061 [E]  QQLuaVmRun CallGlobal err <string>:296: cannot perform concat operation between string and nil
stack traceback:
	<string>:296: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{959562190 测试群 2450459910 凤飞翱翔兮丷 {"GroupPic":[{"FileId":2715502313,"FileMd5":"X+7650/H0waWTJcvGFRWXQ==","FileSize":1928,"ForwordBuf":"Eip7NUZFRUZBRTctNEZDNy1EMzA2LTk2NEMtOTcyRjE4NTQ1NjVEfS5qcGciACoESggDADJgFTYgOTZrRTFBYTFkYjQ2ZTkyYTU2YTdkZiAgICAgIDUwICAgICAgICAgICAgICAgIHs1RkVFRkFFNy00RkM3LUQzMDYtOTY0Qy05NzJGMTg1NDU2NUR9LmpwZzEyMTJBOOmN7Y4KQN/P2tICSFBQQVoAYAFqEF/u+udPx9MGlkyXLxhUVl1yWy9nY2hhdHBpY19uZXcvMjQ1MDQ1OTkxMC85NTk1NjIxOTAtMjcxNTUwMjMxMy01RkVFRkFFNzRGQzdEMzA2OTY0Qzk3MkYxODU0NTY1RC8xOTg/dGVybT0yNTWCAVkvZ2NoYXRwaWNfbmV3LzI0NTA0NTk5MTAvOTU5NTYyMTkwLTI3MTU1MDIzMTMtNUZFRUZBRTc0RkM3RDMwNjk2NEM5NzJGMTg1NDU2NUQvMD90ZXJtPTI1NaAB6AewAUq4AUrIAYgP2AFK4AFK+gFbL2djaGF0cGljX25ldy8yNDUwNDU5OTEwLzk1OTU2MjE5MC0yNzE1NTAyMzEzLTVGRUVGQUU3NEZDN0QzMDY5NjRDOTcyRjE4NTQ1NjVELzQwMD90ZXJtPTI1NYACSogCSg==","ForwordField":8,"Url":"http://gchat.qpic.cn/gchatpic_new/2450459910/959562190-2534335053-5FEEFAE74FC7D306964C972F1854565D/0?vuin=1689236904\u0026term=255\u0026pictype=0"}],"Tips":"[群图片]"} PicMsg 1599391744 6434 2425497057 <nil>} 
2020/09/06 19:29:07.106 [E]  QQLuaVmRun CallGlobal err <string>:296: cannot perform concat operation between string and nil
stack traceback:
	<string>:296: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{959562190 测试群 2450459910 凤飞翱翔兮丷 {"GroupPic":[{"FileId":2474135332,"FileMd5":"X+7650/H0waWTJcvGFRWXQ==","FileSize":1928,"ForwordBuf":"Eip7NUZFRUZBRTctNEZDNy1EMzA2LTk2NEMtOTcyRjE4NTQ1NjVEfS5qcGciACoEAAAAADJcFTYgOTJrQTFDOTM3ODRmMjQyMjY4YTdkZiAgICAgIDUwICAgICAgICAgICAgICAgIHs1RkVFRkFFNy00RkM3LUQzMDYtOTY0Qy05NzJGMTg1NDU2NUR9LmpwZ0E4pJ7hmwlA38+ikwJIUFBDWgBgAWoQX+7650/H0waWTJcvGFRWXXJbL2djaGF0cGljX25ldy8yNDUwNDU5OTEwLzk1OTU2MjE5MC0yNDc0MTM1MzMyLTVGRUVGQUU3NEZDN0QzMDY5NjRDOTcyRjE4NTQ1NjVELzE5OD90ZXJtPTI1NYIBWS9nY2hhdHBpY19uZXcvMjQ1MDQ1OTkxMC85NTk1NjIxOTAtMjQ3NDEzNTMzMi01RkVFRkFFNzRGQzdEMzA2OTY0Qzk3MkYxODU0NTY1RC8wP3Rlcm09MjU1oAHoB7ABSrgBSsgBiA/YAUrgAUr6AVsvZ2NoYXRwaWNfbmV3LzI0NTA0NTk5MTAvOTU5NTYyMTkwLTI0NzQxMzUzMzItNUZFRUZBRTc0RkM3RDMwNjk2NEM5NzJGMTg1NDU2NUQvNDAwP3Rlcm09MjU1gAJKiAJK","ForwordField":8,"Url":"http://gchat.qpic.cn/gchatpic_new/2450459910/959562190-2534335053-5FEEFAE74FC7D306964C972F1854565D/0?vuin=1689236904\u0026term=255\u0026pictype=0"}],"Tips":"[群图片]"} PicMsg 1599391746 6435 1008438171 <nil>} 
2020/09/06 19:29:08.428 [E]  QQLuaVmRun CallGlobal err <string>:296: cannot perform concat operation between string and nil
stack traceback:
	<string>:296: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{959562190 测试群 2450459910 凤飞翱翔兮丷 {"GroupPic":[{"FileId":2802048481,"FileMd5":"X+7650/H0waWTJcvGFRWXQ==","FileSize":1928,"ForwordBuf":"Eip7NUZFRUZBRTctNEZDNy1EMzA2LTk2NEMtOTcyRjE4NTQ1NjVEfS5qcGciACoEAAAAADJcFTYgOTJrQTFDYTcwM2RkZTEyYTU2YTdkZiAgICAgIDUwICAgICAgICAgICAgICAgIHs1RkVFRkFFNy00RkM3LUQzMDYtOTY0Qy05NzJGMTg1NDU2NUR9LmpwZ0E44buPuApA38/a0gJIUFBDWgBgAWoQX+7650/H0waWTJcvGFRWXXJbL2djaGF0cGljX25ldy8yNDUwNDU5OTEwLzk1OTU2MjE5MC0yODAyMDQ4NDgxLTVGRUVGQUU3NEZDN0QzMDY5NjRDOTcyRjE4NTQ1NjVELzE5OD90ZXJtPTI1NYIBWS9nY2hhdHBpY19uZXcvMjQ1MDQ1OTkxMC85NTk1NjIxOTAtMjgwMjA0ODQ4MS01RkVFRkFFNzRGQzdEMzA2OTY0Qzk3MkYxODU0NTY1RC8wP3Rlcm09MjU1oAHoB7ABSrgBSsgBiA/YAUrgAUr6AVsvZ2NoYXRwaWNfbmV3LzI0NTA0NTk5MTAvOTU5NTYyMTkwLTI4MDIwNDg0ODEtNUZFRUZBRTc0RkM3RDMwNjk2NEM5NzJGMTg1NDU2NUQvNDAwP3Rlcm09MjU1gAJKiAJK","ForwordField":8,"Url":"http://gchat.qpic.cn/gchatpic_new/2450459910/959562190-2534335053-5FEEFAE74FC7D306964C972F1854565D/0?vuin=1689236904\u0026term=255\u0026pictype=0"}],"Tips":"[群图片]"} PicMsg 1599391748 6436 2974152818 <nil>} 
2020/09/06 19:29:14.267 [E]  QQLuaVmRun CallGlobal err <string>:296: cannot perform concat operation between string and nil
stack traceback:
	<string>:296: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{959562190 测试群 2450459910 凤飞翱翔兮丷 {"GroupPic":[{"FileId":3048457828,"FileMd5":"X+7650/H0waWTJcvGFRWXQ==","FileSize":1928,"ForwordBuf":"Eip7NUZFRUZBRTctNEZDNy1EMzA2LTk2NEMtOTcyRjE4NTQ1NjVEfS5qcGciACoEAAAAADJcFTYgOTJrQTFDYjViM2M2NjQyYTU2YTdkZiAgICAgIDUwICAgICAgICAgICAgICAgIHs1RkVFRkFFNy00RkM3LUQzMDYtOTY0Qy05NzJGMTg1NDU2NUR9LmpwZ0E45IzPrQtA38/a0gJIUFBDWgBgAWoQX+7650/H0waWTJcvGFRWXXJbL2djaGF0cGljX25ldy8yNDUwNDU5OTEwLzk1OTU2MjE5MC0zMDQ4NDU3ODI4LTVGRUVGQUU3NEZDN0QzMDY5NjRDOTcyRjE4NTQ1NjVELzE5OD90ZXJtPTI1NYIBWS9nY2hhdHBpY19uZXcvMjQ1MDQ1OTkxMC85NTk1NjIxOTAtMzA0ODQ1NzgyOC01RkVFRkFFNzRGQzdEMzA2OTY0Qzk3MkYxODU0NTY1RC8wP3Rlcm09MjU1oAHoB7ABSrgBSsgBiA/YAUrgAUr6AVsvZ2NoYXRwaWNfbmV3LzI0NTA0NTk5MTAvOTU5NTYyMTkwLTMwNDg0NTc4MjgtNUZFRUZBRTc0RkM3RDMwNjk2NEM5NzJGMTg1NDU2NUQvNDAwP3Rlcm09MjU1gAJKiAJK","ForwordField":8,"Url":"http://gchat.qpic.cn/gchatpic_new/2450459910/959562190-2534335053-5FEEFAE74FC7D306964C972F1854565D/0?vuin=1689236904\u0026term=255\u0026pictype=0"}],"Tips":"[群图片]"} PicMsg 1599391753 6437 2903944681 <nil>} 
2020/09/06 19:29:46.386 [E]  QQLuaVmRun CallGlobal err <string>:296: cannot perform concat operation between string and nil
stack traceback:
	<string>:296: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{959562190 测试群 2450459910 凤飞翱翔兮丷 {"GroupPic":[{"FileId":2722308661,"FileMd5":"X+7650/H0waWTJcvGFRWXQ==","FileSize":1928,"ForwordBuf":"Eip7NUZFRUZBRTctNEZDNy1EMzA2LTk2NEMtOTcyRjE4NTQ1NjVEfS5qcGciACoEAAAAADJcFTYgOTJrQTFDYTI0MzIyMzVkMmM0YzBiNyAgICAgIDUwICAgICAgICAgICAgICAgIHs1RkVFRkFFNy00RkM3LUQzMDYtOTY0Qy05NzJGMTg1NDU2NUR9LmpwZ0E4tcSMkgpAt4GTlg1IUFBDWgBgAWoQX+7650/H0waWTJcvGFRWXXJbL2djaGF0cGljX25ldy8yNDUwNDU5OTEwLzk1OTU2MjE5MC0yNzIyMzA4NjYxLTVGRUVGQUU3NEZDN0QzMDY5NjRDOTcyRjE4NTQ1NjVELzE5OD90ZXJtPTI1NYIBWS9nY2hhdHBpY19uZXcvMjQ1MDQ1OTkxMC85NTk1NjIxOTAtMjcyMjMwODY2MS01RkVFRkFFNzRGQzdEMzA2OTY0Qzk3MkYxODU0NTY1RC8wP3Rlcm09MjU1oAHoB7ABSrgBSsgBiA/YAUrgAUr6AVsvZ2NoYXRwaWNfbmV3LzI0NTA0NTk5MTAvOTU5NTYyMTkwLTI3MjIzMDg2NjEtNUZFRUZBRTc0RkM3RDMwNjk2NEM5NzJGMTg1NDU2NUQvNDAwP3Rlcm09MjU1gAJKiAJK","ForwordField":8,"Url":"http://gchat.qpic.cn/gchatpic_new/2450459910/959562190-2534335053-5FEEFAE74FC7D306964C972F1854565D/0?vuin=1689236904\u0026term=255\u0026pictype=0"}],"Tips":"[群图片]"} PicMsg 1599391786 6456 3185850166 <nil>} 
2020/09/06 19:29:49.308 [E]  QQLuaVmRun CallGlobal err <string>:296: cannot perform concat operation between string and nil
stack traceback:
	<string>:296: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{959562190 测试群 2450459910 凤飞翱翔兮丷 {"GroupPic":[{"FileId":2245140183,"FileMd5":"X+7650/H0waWTJcvGFRWXQ==","FileSize":1928,"ForwordBuf":"Eip7NUZFRUZBRTctNEZDNy1EMzA2LTk2NEMtOTcyRjE4NTQ1NjVEfS5qcGciACoEAAAAADJcFTYgOTJrQTFDODVkMjFlZDdjZGM0YzBiNyAgICAgIDUwICAgICAgICAgICAgICAgIHs1RkVFRkFFNy00RkM3LUQzMDYtOTY0Qy05NzJGMTg1NDU2NUR9LmpwZ0E4173IrghAt4GT7gxIUFBDWgBgAWoQX+7650/H0waWTJcvGFRWXXJbL2djaGF0cGljX25ldy8yNDUwNDU5OTEwLzk1OTU2MjE5MC0yMjQ1MTQwMTgzLTVGRUVGQUU3NEZDN0QzMDY5NjRDOTcyRjE4NTQ1NjVELzE5OD90ZXJtPTI1NYIBWS9nY2hhdHBpY19uZXcvMjQ1MDQ1OTkxMC85NTk1NjIxOTAtMjI0NTE0MDE4My01RkVFRkFFNzRGQzdEMzA2OTY0Qzk3MkYxODU0NTY1RC8wP3Rlcm09MjU1oAHoB7ABSrgBSsgBiA/YAUrgAUr6AVsvZ2NoYXRwaWNfbmV3LzI0NTA0NTk5MTAvOTU5NTYyMTkwLTIyNDUxNDAxODMtNUZFRUZBRTc0RkM3RDMwNjk2NEM5NzJGMTg1NDU2NUQvNDAwP3Rlcm09MjU1gAJKiAJK","ForwordField":8,"Url":"http://gchat.qpic.cn/gchatpic_new/2450459910/959562190-2534335053-5FEEFAE74FC7D306964C972F1854565D/0?vuin=1689236904\u0026term=255\u0026pictype=0"}],"Tips":"[群图片]"} PicMsg 1599391789 6457 45778240 <nil>} 
2020/09/06 19:29:51.371 [E]  QQLuaVmRun CallGlobal err <string>:296: cannot perform concat operation between string and nil
stack traceback:
	<string>:296: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{959562190 测试群 2450459910 凤飞翱翔兮丷 {"GroupPic":[{"FileId":2264067354,"FileMd5":"X+7650/H0waWTJcvGFRWXQ==","FileSize":1928,"ForwordBuf":"Eip7NUZFRUZBRTctNEZDNy1EMzA2LTk2NEMtOTcyRjE4NTQ1NjVEfS5qcGciACoEAAAAADJcFTYgOTJrQTFDODZmMmVkMWEyNjE5YTNiNCAgICAgIDUwICAgICAgICAgICAgICAgIHs1RkVFRkFFNy00RkM3LUQzMDYtOTY0Qy05NzJGMTg1NDU2NUR9LmpwZ0E4mtrLtwhAtMfmsAJIUFBDWgBgAWoQX+7650/H0waWTJcvGFRWXXJbL2djaGF0cGljX25ldy8yNDUwNDU5OTEwLzk1OTU2MjE5MC0yMjY0MDY3MzU0LTVGRUVGQUU3NEZDN0QzMDY5NjRDOTcyRjE4NTQ1NjVELzE5OD90ZXJtPTI1NYIBWS9nY2hhdHBpY19uZXcvMjQ1MDQ1OTkxMC85NTk1NjIxOTAtMjI2NDA2NzM1NC01RkVFRkFFNzRGQzdEMzA2OTY0Qzk3MkYxODU0NTY1RC8wP3Rlcm09MjU1oAHoB7ABSrgBSsgBiA/YAUrgAUr6AVsvZ2NoYXRwaWNfbmV3LzI0NTA0NTk5MTAvOTU5NTYyMTkwLTIyNjQwNjczNTQtNUZFRUZBRTc0RkM3RDMwNjk2NEM5NzJGMTg1NDU2NUQvNDAwP3Rlcm09MjU1gAJKiAJK","ForwordField":8,"Url":"http://gchat.qpic.cn/gchatpic_new/2450459910/959562190-2534335053-5FEEFAE74FC7D306964C972F1854565D/0?vuin=1689236904\u0026term=255\u0026pictype=0"}],"Tips":"[群图片]"} PicMsg 1599391791 6458 2894630003 <nil>} 
2020/09/06 19:29:53.710 [E]  QQLuaVmRun CallGlobal err <string>:296: cannot perform concat operation between string and nil
stack traceback:
	<string>:296: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{959562190 测试群 2450459910 凤飞翱翔兮丷 {"GroupPic":[{"FileId":2366363517,"FileMd5":"X+7650/H0waWTJcvGFRWXQ==","FileSize":1928,"ForwordBuf":"Eip7NUZFRUZBRTctNEZDNy1EMzA2LTk2NEMtOTcyRjE4NTQ1NjVEfS5qcGciACoEAAAAADJcFTYgOTJrQTFDOGQwYmQ3N2RkMmM0YzBiNyAgICAgIDUwICAgICAgICAgICAgICAgIHs1RkVFRkFFNy00RkM3LUQzMDYtOTY0Qy05NzJGMTg1NDU2NUR9LmpwZ0E4/a6v6AhAt4GTlg1IUFBDWgBgAWoQX+7650/H0waWTJcvGFRWXXJbL2djaGF0cGljX25ldy8yNDUwNDU5OTEwLzk1OTU2MjE5MC0yMzY2MzYzNTE3LTVGRUVGQUU3NEZDN0QzMDY5NjRDOTcyRjE4NTQ1NjVELzE5OD90ZXJtPTI1NYIBWS9nY2hhdHBpY19uZXcvMjQ1MDQ1OTkxMC85NTk1NjIxOTAtMjM2NjM2MzUxNy01RkVFRkFFNzRGQzdEMzA2OTY0Qzk3MkYxODU0NTY1RC8wP3Rlcm09MjU1oAHoB7ABSrgBSsgBiA/YAUrgAUr6AVsvZ2NoYXRwaWNfbmV3LzI0NTA0NTk5MTAvOTU5NTYyMTkwLTIzNjYzNjM1MTctNUZFRUZBRTc0RkM3RDMwNjk2NEM5NzJGMTg1NDU2NUQvNDAwP3Rlcm09MjU1gAJKiAJK","ForwordField":8,"Url":"http://gchat.qpic.cn/gchatpic_new/2450459910/959562190-2534335053-5FEEFAE74FC7D306964C972F1854565D/0?vuin=1689236904\u0026term=255\u0026pictype=0"}],"Tips":"[群图片]"} PicMsg 1599391793 6459 846124371 <nil>} 
2020/09/06 19:29:56.397 [E]  QQLuaVmRun CallGlobal err <string>:296: cannot perform concat operation between string and nil
stack traceback:
	<string>:296: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{959562190 测试群 2450459910 凤飞翱翔兮丷 {"GroupPic":[{"FileId":2427040867,"FileMd5":"X+7650/H0waWTJcvGFRWXQ==","FileSize":1928,"ForwordBuf":"Eip7NUZFRUZBRTctNEZDNy1EMzA2LTk2NEMtOTcyRjE4NTQ1NjVEfS5qcGciACoEAAAAADJcFTYgOTJrQTFDOTBhOWI0NjMyNjE5YTNiNCAgICAgIDUwICAgICAgICAgICAgICAgIHs1RkVFRkFFNy00RkM3LUQzMDYtOTY0Qy05NzJGMTg1NDU2NUR9LmpwZ0E44+imhQlAtMfmsAJIUFBDWgBgAWoQX+7650/H0waWTJcvGFRWXXJbL2djaGF0cGljX25ldy8yNDUwNDU5OTEwLzk1OTU2MjE5MC0yNDI3MDQwODY3LTVGRUVGQUU3NEZDN0QzMDY5NjRDOTcyRjE4NTQ1NjVELzE5OD90ZXJtPTI1NYIBWS9nY2hhdHBpY19uZXcvMjQ1MDQ1OTkxMC85NTk1NjIxOTAtMjQyNzA0MDg2Ny01RkVFRkFFNzRGQzdEMzA2OTY0Qzk3MkYxODU0NTY1RC8wP3Rlcm09MjU1oAHoB7ABSrgBSsgBiA/YAUrgAUr6AVsvZ2NoYXRwaWNfbmV3LzI0NTA0NTk5MTAvOTU5NTYyMTkwLTI0MjcwNDA4NjctNUZFRUZBRTc0RkM3RDMwNjk2NEM5NzJGMTg1NDU2NUQvNDAwP3Rlcm09MjU1gAJKiAJK","ForwordField":8,"Url":"http://gchat.qpic.cn/gchatpic_new/2450459910/959562190-2534335053-5FEEFAE74FC7D306964C972F1854565D/0?vuin=1689236904\u0026term=255\u0026pictype=0"}],"Tips":"[群图片]"} PicMsg 1599391796 6460 1453907207 <nil>} 
2020/09/06 19:29:59.138 [E]  QQLuaVmRun CallGlobal err <string>:296: cannot perform concat operation between string and nil
stack traceback:
	<string>:296: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{959562190 测试群 2450459910 凤飞翱翔兮丷 {"GroupPic":[{"FileId":2399848624,"FileMd5":"X+7650/H0waWTJcvGFRWXQ==","FileSize":1928,"ForwordBuf":"Eip7NUZFRUZBRTctNEZDNy1EMzA2LTk2NEMtOTcyRjE4NTQ1NjVEfS5qcGciACoEAAAAADJcFTYgOTJrQTFDOGYwYWM4YjAyNjE5YTNiNCAgICAgIDUwICAgICAgICAgICAgICAgIHs1RkVFRkFFNy00RkM3LUQzMDYtOTY0Qy05NzJGMTg1NDU2NUR9LmpwZ0E4sJGr+AhAtMfmsAJIUFBDWgBgAWoQX+7650/H0waWTJcvGFRWXXJbL2djaGF0cGljX25ldy8yNDUwNDU5OTEwLzk1OTU2MjE5MC0yMzk5ODQ4NjI0LTVGRUVGQUU3NEZDN0QzMDY5NjRDOTcyRjE4NTQ1NjVELzE5OD90ZXJtPTI1NYIBWS9nY2hhdHBpY19uZXcvMjQ1MDQ1OTkxMC85NTk1NjIxOTAtMjM5OTg0ODYyNC01RkVFRkFFNzRGQzdEMzA2OTY0Qzk3MkYxODU0NTY1RC8wP3Rlcm09MjU1oAHoB7ABSrgBSsgBiA/YAUrgAUr6AVsvZ2NoYXRwaWNfbmV3LzI0NTA0NTk5MTAvOTU5NTYyMTkwLTIzOTk4NDg2MjQtNUZFRUZBRTc0RkM3RDMwNjk2NEM5NzJGMTg1NDU2NUQvNDAwP3Rlcm09MjU1gAJKiAJK","ForwordField":8,"Url":"http://gchat.qpic.cn/gchatpic_new/2450459910/959562190-2534335053-5FEEFAE74FC7D306964C972F1854565D/0?vuin=1689236904\u0026term=255\u0026pictype=0"}],"Tips":"[群图片]"} PicMsg 1599391798 6461 3355761194 <nil>} 
2020/09/06 19:30:01.589 [E]  QQLuaVmRun CallGlobal err <string>:296: cannot perform concat operation between string and nil
stack traceback:
	<string>:296: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{959562190 测试群 2450459910 凤飞翱翔兮丷 {"GroupPic":[{"FileId":2989797493,"FileMd5":"X+7650/H0waWTJcvGFRWXQ==","FileSize":1928,"ForwordBuf":"Eip7NUZFRUZBRTctNEZDNy1EMzA2LTk2NEMtOTcyRjE4NTQ1NjVEfS5qcGciACoEAAAAADJcFTYgOTJrQTFDYjIzNGIwNzUyMjY4YTdkZiAgICAgIDUwICAgICAgICAgICAgICAgIHs1RkVFRkFFNy00RkM3LUQzMDYtOTY0Qy05NzJGMTg1NDU2NUR9LmpwZ0E49eDSkQtA38+ikwJIUFBDWgBgAWoQX+7650/H0waWTJcvGFRWXXJbL2djaGF0cGljX25ldy8yNDUwNDU5OTEwLzk1OTU2MjE5MC0yOTg5Nzk3NDkzLTVGRUVGQUU3NEZDN0QzMDY5NjRDOTcyRjE4NTQ1NjVELzE5OD90ZXJtPTI1NYIBWS9nY2hhdHBpY19uZXcvMjQ1MDQ1OTkxMC85NTk1NjIxOTAtMjk4OTc5NzQ5My01RkVFRkFFNzRGQzdEMzA2OTY0Qzk3MkYxODU0NTY1RC8wP3Rlcm09MjU1oAHoB7ABSrgBSsgBiA/YAUrgAUr6AVsvZ2NoYXRwaWNfbmV3LzI0NTA0NTk5MTAvOTU5NTYyMTkwLTI5ODk3OTc0OTMtNUZFRUZBRTc0RkM3RDMwNjk2NEM5NzJGMTg1NDU2NUQvNDAwP3Rlcm09MjU1gAJKiAJK","ForwordField":8,"Url":"http://gchat.qpic.cn/gchatpic_new/2450459910/959562190-2534335053-5FEEFAE74FC7D306964C972F1854565D/0?vuin=1689236904\u0026term=255\u0026pictype=0"}],"Tips":"[群图片]"} PicMsg 1599391801 6462 3862876946 <nil>} 
2020/09/06 19:30:04.712 [E]  QQLuaVmRun CallGlobal err <string>:296: cannot perform concat operation between string and nil
stack traceback:
	<string>:296: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{959562190 测试群 2450459910 凤飞翱翔兮丷 {"GroupPic":[{"FileId":2898675233,"FileMd5":"X+7650/H0waWTJcvGFRWXQ==","FileSize":1928,"ForwordBuf":"Eip7NUZFRUZBRTctNEZDNy1EMzA2LTk2NEMtOTcyRjE4NTQ1NjVEfS5qcGciACoEAAAAADJcFTYgOTJrQTFDYWNjNjQ2MjFkMmM0YzBiNyAgICAgIDUwICAgICAgICAgICAgICAgIHs1RkVFRkFFNy00RkM3LUQzMDYtOTY0Qy05NzJGMTg1NDU2NUR9LmpwZ0E4oYyZ5gpAt4GTlg1IUFBDWgBgAWoQX+7650/H0waWTJcvGFRWXXJbL2djaGF0cGljX25ldy8yNDUwNDU5OTEwLzk1OTU2MjE5MC0yODk4Njc1MjMzLTVGRUVGQUU3NEZDN0QzMDY5NjRDOTcyRjE4NTQ1NjVELzE5OD90ZXJtPTI1NYIBWS9nY2hhdHBpY19uZXcvMjQ1MDQ1OTkxMC85NTk1NjIxOTAtMjg5ODY3NTIzMy01RkVFRkFFNzRGQzdEMzA2OTY0Qzk3MkYxODU0NTY1RC8wP3Rlcm09MjU1oAHoB7ABSrgBSsgBiA/YAUrgAUr6AVsvZ2NoYXRwaWNfbmV3LzI0NTA0NTk5MTAvOTU5NTYyMTkwLTI4OTg2NzUyMzMtNUZFRUZBRTc0RkM3RDMwNjk2NEM5NzJGMTg1NDU2NUQvNDAwP3Rlcm09MjU1gAJKiAJK","ForwordField":8,"Url":"http://gchat.qpic.cn/gchatpic_new/2450459910/959562190-2534335053-5FEEFAE74FC7D306964C972F1854565D/0?vuin=1689236904\u0026term=255\u0026pictype=0"}],"Tips":"[群图片]"} PicMsg 1599391804 6463 3473477581 <nil>} 
2020/09/06 19:43:27.282 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136235 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:2675304836 GroupID:383770908 MsgRandom:1634739710 MsgSeq:136235 UserID:2675304836]
2020/09/06 19:43:33.036 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136234 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:1599392582 MsgSeq:136234 UserID:1689236904]
2020/09/06 19:52:19.147 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136283 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:2915618049 MsgSeq:136283 UserID:1689236904]
2020/09/06 19:52:22.321 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136285 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:2098804882 MsgSeq:136285 UserID:1689236904]
2020/09/06 19:52:26.160 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136287 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:514803960 MsgSeq:136287 UserID:1689236904]
2020/09/06 19:52:29.820 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136289 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:3464857958 MsgSeq:136289 UserID:1689236904]
2020/09/06 19:52:33.440 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136291 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:1057264886 MsgSeq:136291 UserID:1689236904]
2020/09/06 19:52:40.479 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136294 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:2161840493 MsgSeq:136294 UserID:1689236904]
2020/09/06 19:52:52.379 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136296 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:3357432615 MsgSeq:136296 UserID:1689236904]
2020/09/06 19:52:57.408 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136298 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:3351910514 MsgSeq:136298 UserID:1689236904]
2020/09/06 19:53:00.864 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136300 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:2087623000 MsgSeq:136300 UserID:1689236904]
2020/09/06 19:53:11.312 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136304 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:1920344159 MsgSeq:136304 UserID:1689236904]
2020/09/06 19:53:16.533 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136306 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:1956814499 MsgSeq:136306 UserID:1689236904]
2020/09/06 20:02:11.671 [E]  QQLuaVmRun CallGlobal err Unknow Lua Function:ReceiveEvents detail File weatherfy4a.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136315 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:668431639 MsgSeq:136315 UserID:1689236904]
2020/09/06 20:02:20.630 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136317 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:1940026859 MsgSeq:136317 UserID:1689236904]
2020/09/06 20:02:31.378 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136319 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:4243540688 MsgSeq:136319 UserID:1689236904]
2020/09/06 20:02:40.024 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136321 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:1375832313 MsgSeq:136321 UserID:1689236904]
2020/09/06 20:02:55.415 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136323 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:2617429580 MsgSeq:136323 UserID:1689236904]
2020/09/06 20:03:14.009 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136326 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:369842180 MsgSeq:136326 UserID:1689236904]
2020/09/06 20:06:08.499 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136329 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:1223208839 MsgSeq:136329 UserID:1689236904]
2020/09/06 20:06:58.167 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136333 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:167514290 MsgSeq:136333 UserID:1689236904]
2020/09/06 20:07:02.144 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136335 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:1340231960 MsgSeq:136335 UserID:1689236904]
2020/09/06 20:08:59.131 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136338 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:1799738235 MsgSeq:136338 UserID:1689236904]
2020/09/06 20:12:20.147 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136340 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:2815999495 MsgSeq:136340 UserID:1689236904]
2020/09/06 20:36:50.375 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136347 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:3301944123 MsgSeq:136347 UserID:1689236904]
2020/09/06 20:37:05.521 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136349 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:4229477731 MsgSeq:136349 UserID:1689236904]
2020/09/06 20:38:01.994 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136352 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:814519727 MsgSeq:136352 UserID:1689236904]
2020/09/06 20:38:03.568 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136354 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:1519523597 MsgSeq:136354 UserID:1689236904]
2020/09/06 20:38:04.431 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136355 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:4024935522 MsgSeq:136355 UserID:1689236904]
2020/09/06 20:38:20.969 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136358 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:125082472 MsgSeq:136358 UserID:1689236904]
2020/09/06 20:45:10.311 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{959562190 0 ON_EVENT_GROUP_REVOKE 6466 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:959562190 MsgRandom:1643034739 MsgSeq:6466 UserID:1689236904]
2020/09/06 20:52:53.831 [E]  QQLuaVmRun CallGlobal err <string>:373: attempt to compare number with nil
stack traceback:
	<string>:373: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{928308961 大 洗 女 子 学 园 188232674 咸鱼 涩图 TextMsg 1599396772 529546 1761253821 <nil>} 
2020/09/06 21:02:43.123 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{959562190 0 ON_EVENT_GROUP_REVOKE 6476 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:959562190 MsgRandom:2574882868 MsgSeq:6476 UserID:1689236904]
2020/09/06 21:29:35.456 [E]  QQLuaVmRun CallGlobal err <string>:42: context deadline exceeded
stack traceback:
	<string>:42: in main chunk
	[G]: ? detail File setulolicon.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{928308961 大 洗 女 子 学 园 651494329 再歪人都傻了 涩图 TextMsg 1599398752 529574 921659921 <nil>} 
2020/09/06 21:39:46.332 [E]  QQLuaVmRun CallGlobal err <string>:42: context deadline exceeded
stack traceback:
	<string>:42: in main chunk
	[G]: ? detail File setulolicon.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{928308961 大 洗 女 子 学 园 188232674 咸鱼 涩图 TextMsg 1599399481 529578 1619459201 <nil>} 
2020/09/06 21:58:39.745 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136377 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:3616962683 MsgSeq:136377 UserID:1689236904]
2020/09/06 22:03:17.847 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136379 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:1764835126 MsgSeq:136379 UserID:1689236904]
2020/09/06 22:03:32.648 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136381 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:4288513835 MsgSeq:136381 UserID:1689236904]
2020/09/06 22:03:48.598 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136384 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:1793399123 MsgSeq:136384 UserID:1689236904]
2020/09/06 22:03:52.165 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136385 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:3552286265 MsgSeq:136385 UserID:1689236904]
2020/09/06 22:11:07.062 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136387 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:767916298 MsgSeq:136387 UserID:1689236904]
2020/09/06 22:11:08.114 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136389 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:1124809183 MsgSeq:136389 UserID:1689236904]
2020/09/06 22:11:30.210 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136392 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:4102309800 MsgSeq:136392 UserID:1689236904]
2020/09/06 22:19:53.730 [E]  QQLuaVmRun CallGlobal err <string>:296: cannot perform concat operation between string and nil
stack traceback:
	<string>:296: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{959562190 测试群 2450459910 凤飞翱翔兮丷 {"Content":"搜图","GroupPic":[{"FileId":3117744003,"FileMd5":"MgF8DIJd3CN8A5WMvIIeZg==","FileSize":201656,"ForwordBuf":"Eip7MzIwMTdDMEMtODI1RC1EQzIzLTdDMDMtOTU4Q0JDODIxRTY2fS5qcGciACoEAAAAADJcFTYgOTJrQTFDYjlkNGZmODNkMmM0YzBiNyAgICAgIDUwICAgICAgICAgICAgICAgIHszMjAxN0MwQy04MjVELURDMjMtN0MwMy05NThDQkM4MjFFNjZ9LmpwZ0E4g//TzgtAt4GTlg1IUFBDWgBgAWoQMgF8DIJd3CN8A5WMvIIeZnJbL2djaGF0cGljX25ldy8yNDUwNDU5OTEwLzk1OTU2MjE5MC0zMTE3NzQ0MDAzLTMyMDE3QzBDODI1RERDMjM3QzAzOTU4Q0JDODIxRTY2LzE5OD90ZXJtPTI1NYIBWS9nY2hhdHBpY19uZXcvMjQ1MDQ1OTkxMC85NTk1NjIxOTAtMzExNzc0NDAwMy0zMjAxN0MwQzgyNUREQzIzN0MwMzk1OENCQzgyMUU2Ni8wP3Rlcm09MjU1oAHoB7ABgAq4AekPyAG4pwzYAX3gAcYB+gFbL2djaGF0cGljX25ldy8yNDUwNDU5OTEwLzk1OTU2MjE5MC0zMTE3NzQ0MDAzLTMyMDE3QzBDODI1RERDMjM3QzAzOTU4Q0JDODIxRTY2LzQwMD90ZXJtPTI1NYAC8gGIAoAD","ForwordField":8,"Url":"http://gchat.qpic.cn/gchatpic_new/2450459910/959562190-2534335053-32017C0C825DDC237C03958CBC821E66/0?vuin=1689236904\u0026term=255\u0026pictype=0"}],"Tips":"[群图片]"} PicMsg 1599401993 6479 2069582081 <nil>} 
2020/09/06 22:21:06.051 [E]  QQLuaVmRun CallGlobal err <string>:296: cannot perform concat operation between string and nil
stack traceback:
	<string>:296: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{959562190 测试群 2450459910 凤飞翱翔兮丷 {"Content":"搜图","GroupPic":[{"FileId":2302347175,"FileMd5":"MgF8DIJd3CN8A5WMvIIeZg==","FileSize":201656,"ForwordBuf":"Eip7MzIwMTdDMEMtODI1RC1EQzIzLTdDMDMtOTU4Q0JDODIxRTY2fS5qcGciACoEAAAAADJcFTYgOTJrQTFDODkzYjA3YTc2ZDhmZTM2NSAgICAgIDUwICAgICAgICAgICAgICAgIHszMjAxN0MwQy04MjVELURDMjMtN0MwMy05NThDQkM4MjFFNjZ9LmpwZ0E4p4/syQhA5ca/7AZIUFBDWgBgAWoQMgF8DIJd3CN8A5WMvIIeZnJbL2djaGF0cGljX25ldy8yNDUwNDU5OTEwLzk1OTU2MjE5MC0yMzAyMzQ3MTc1LTMyMDE3QzBDODI1RERDMjM3QzAzOTU4Q0JDODIxRTY2LzE5OD90ZXJtPTI1NYIBWS9nY2hhdHBpY19uZXcvMjQ1MDQ1OTkxMC85NTk1NjIxOTAtMjMwMjM0NzE3NS0zMjAxN0MwQzgyNUREQzIzN0MwMzk1OENCQzgyMUU2Ni8wP3Rlcm09MjU1oAHoB7ABgAq4AekPyAG4pwzYAX3gAcYB+gFbL2djaGF0cGljX25ldy8yNDUwNDU5OTEwLzk1OTU2MjE5MC0yMzAyMzQ3MTc1LTMyMDE3QzBDODI1RERDMjM3QzAzOTU4Q0JDODIxRTY2LzQwMD90ZXJtPTI1NYAC8gGIAoAD","ForwordField":8,"Url":"http://gchat.qpic.cn/gchatpic_new/2450459910/959562190-2534335053-32017C0C825DDC237C03958CBC821E66/0?vuin=1689236904\u0026term=255\u0026pictype=0"}],"Tips":"[群图片]"} PicMsg 1599402058 6481 4116117251 <nil>} 
2020/09/06 22:24:39.966 [E]  QQLuaVmRun CallGlobal err <string>:42: context deadline exceeded
stack traceback:
	<string>:42: in main chunk
	[G]: ? detail File setulolicon.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{928308961 大 洗 女 子 学 园 188232674 咸鱼 涩图 TextMsg 1599402120 529598 1288462672 <nil>} 
2020/09/06 22:34:48.735 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{959562190 0 ON_EVENT_GROUP_REVOKE 6487 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:959562190 MsgRandom:3948273470 MsgSeq:6487 UserID:1689236904]
2020/09/06 22:35:19.311 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136394 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:2238344667 MsgSeq:136394 UserID:1689236904]
2020/09/06 22:36:05.073 [E]  QQLuaVmRun CallGlobal err <string>:90: context deadline exceeded
stack traceback:
	<string>:90: in main chunk
	[G]: ? detail File setulocal.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{383770908 帝豪高級娛樂會所 1300894976 会所创始人 动图 TextMsg 1599402903 136397 616121645 <nil>} 
2020/09/06 22:36:12.299 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136400 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:2901299734 MsgSeq:136400 UserID:1689236904]
2020/09/06 22:36:16.239 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136401 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:1799639812 MsgSeq:136401 UserID:1689236904]
2020/09/06 22:36:20.587 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136402 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:3036300138 MsgSeq:136402 UserID:1689236904]
2020/09/06 22:36:27.875 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136403 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:865438910 MsgSeq:136403 UserID:1689236904]
2020/09/06 22:36:35.459 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136404 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:65804477 MsgSeq:136404 UserID:1689236904]
2020/09/06 22:43:04.529 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136407 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:3589824178 MsgSeq:136407 UserID:1689236904]
2020/09/06 22:43:59.232 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136409 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:1781985704 MsgSeq:136409 UserID:1689236904]
2020/09/06 22:46:32.530 [E]  QQLuaVmRun CallGlobal err <string>:296: cannot perform concat operation between string and nil
stack traceback:
	<string>:296: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{959562190 测试群 2450459910 凤飞翱翔兮丷 {"GroupPic":[{"FileId":2428897193,"FileMd5":"HZHCxB8ALog6XhnT3ah/zQ==","FileSize":10080,"ForwordBuf":"Eip7MUQ5MUMyQzQtMUYwMC0yRTg4LTNBNUUtMTlEM0REQTg3RkNEfS5wbmciACoEAAAAADJcFTYgOTJrQTEAOTBjNjA3YTk1ZWYzZmY5ZCAgICAgIDUwICAgICAgICAgICAgICAgIHsxRDkxQzJDNC0xRjAwLTJFODgtM0E1RS0xOUQzRERBODdGQ0R9LnBuZ0E4qY+YhglAnf/P9wVIUFAAWgBgAWoQHZHCxB8ALog6XhnT3ah/zXJbL2djaGF0cGljX25ldy8yNDUwNDU5OTEwLzk1OTU2MjE5MC0yNDI4ODk3MTkzLTFEOTFDMkM0MUYwMDJFODgzQTVFMTlEM0REQTg3RkNELzE5OD90ZXJtPTI1NYIBWS9nY2hhdHBpY19uZXcvMjQ1MDQ1OTkxMC85NTk1NjIxOTAtMjQyODg5NzE5My0xRDkxQzJDNDFGMDAyRTg4M0E1RTE5RDNEREE4N0ZDRC8wP3Rlcm09MjU1oAHpB7ABhAO4ATDIAeBO2AHGAeABMPoBWy9nY2hhdHBpY19uZXcvMjQ1MDQ1OTkxMC85NTk1NjIxOTAtMjQyODg5NzE5My0xRDkxQzJDNDFGMDAyRTg4M0E1RTE5RDNEREE4N0ZDRC80MDA/dGVybT0yNTWAAoADiAIw","ForwordField":8,"Url":"http://gchat.qpic.cn/gchatpic_new/2450459910/959562190-2534335053-1D91C2C41F002E883A5E19D3DDA87FCD/0?vuin=1689236904\u0026term=255\u0026pictype=0"}],"Tips":"[群图片]"} PicMsg 1599403592 6488 88676146 <nil>} 
2020/09/06 22:49:14.823 [E]  QQLuaVmRun CallGlobal err <string>:12: context deadline exceeded
stack traceback:
	<string>:12: in main chunk
	[G]: ? detail File revoke.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{383770908 帝豪高級娛樂會所 1689236904 落伍机器人 {"Content":"30s自动撤回","GroupPic":[{"FileId":0,"FileMd5":"FZ7p9BBTI2lx1mn2C2XDcw==","FileSize":0,"ForwordBuf":"Eip7MTU5RUU5RjQtMTA1My0yMzY5LTcxRDYtNjlGNjBCNjVDMzczfS5qcGc4AGABahAVnun0EFMjaXHWafYLZcNzclMvZ2NoYXRwaWNfbmV3LzE2ODkyMzY5MDQvMjY0ODc3MDkwOC0wLTE1OUVFOUY0MTA1MzIzNjk3MUQ2NjlGNjBCNjVDMzczLzE5OD90ZXJtPTI1NYIBUS9nY2hhdHBpY19uZXcvMTY4OTIzNjkwNC8yNjQ4NzcwOTA4LTAtMTU5RUU5RjQxMDUzMjM2OTcxRDY2OUY2MEI2NUMzNzMvMD90ZXJtPTI1NbABuAO4AdUCyAEA2AHGAeABmQH6AVMvZ2NoYXRwaWNfbmV3LzE2ODkyMzY5MDQvMjY0ODc3MDkwOC0wLTE1OUVFOUY0MTA1MzIzNjk3MUQ2NjlGNjBCNjVDMzczLzQwMD90ZXJtPTI1NYACgAOIAqkC","ForwordField":8,"Url":"http://gchat.qpic.cn/gchatpic_new/1689236904/383770908-2534335053-159EE9F41053236971D669F60B65C373/0?vuin=1689236904\u0026term=255\u0026pictype=0"}],"Tips":"[群图片]"} PicMsg 1599403691 136411 1096602163 <nil>} 
2020/09/06 22:56:22.638 [E]  QQLuaVmRun CallGlobal err <string>:296: cannot perform concat operation between string and nil
stack traceback:
	<string>:296: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{959562190 测试群 2450459910 凤飞翱翔兮丷 {"GroupPic":[{"FileId":2476169168,"FileMd5":"vxcYXwBl1rOu2qxx2LI1mA==","FileSize":9268,"ForwordBuf":"Eip7QkYxNzE4NUYtMDA2NS1ENkIzLUFFREEtQUM3MUQ4QjIzNTk4fS5wbmciACoEAAAAADJcFTYgOTJrQTEAOTM5NzU3ZDA1ZWYzZmY5ZCAgICAgIDUwICAgICAgICAgICAgICAgIHtCRjE3MTg1Ri0wMDY1LUQ2QjMtQUVEQS1BQzcxRDhCMjM1OTh9LnBuZ0E40K/dnAlAnf/P9wVIUFAAWgBgAWoQvxcYXwBl1rOu2qxx2LI1mHJbL2djaGF0cGljX25ldy8yNDUwNDU5OTEwLzk1OTU2MjE5MC0yNDc2MTY5MTY4LUJGMTcxODVGMDA2NUQ2QjNBRURBQUM3MUQ4QjIzNTk4LzE5OD90ZXJtPTI1NYIBWS9nY2hhdHBpY19uZXcvMjQ1MDQ1OTkxMC85NTk1NjIxOTAtMjQ3NjE2OTE2OC1CRjE3MTg1RjAwNjVENkIzQUVEQUFDNzFEOEIyMzU5OC8wP3Rlcm09MjU1oAHpB7ABnQO4ASrIAbRI2AHGAeABKvoBWy9nY2hhdHBpY19uZXcvMjQ1MDQ1OTkxMC85NTk1NjIxOTAtMjQ3NjE2OTE2OC1CRjE3MTg1RjAwNjVENkIzQUVEQUFDNzFEOEIyMzU5OC80MDA/dGVybT0yNTWAAoADiAIq","ForwordField":8,"Url":"http://gchat.qpic.cn/gchatpic_new/2450459910/959562190-2534335053-BF17185F0065D6B3AEDAAC71D8B23598/0?vuin=1689236904\u0026term=255\u0026pictype=0"}],"Tips":"[群图片]"} PicMsg 1599404182 6491 584401661 <nil>} 
2020/09/06 22:56:38.845 [E]  QQLuaVmRun CallGlobal err <string>:296: cannot perform concat operation between string and nil
stack traceback:
	<string>:296: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{959562190 测试群 2450459910 凤飞翱翔兮丷 {"GroupPic":[{"FileId":3001126224,"FileMd5":"vxcYXwBl1rOu2qxx2LI1mA==","FileSize":9268,"ForwordBuf":"Eip7QkYxNzE4NUYtMDA2NS1ENkIzLUFFREEtQUM3MUQ4QjIzNTk4fS5wbmciACoEAAAAADJcFTYgOTJrQTEAYjJlMThkNTAyMjY4YTdkZiAgICAgIDUwICAgICAgICAgICAgICAgIHtCRjE3MTg1Ri0wMDY1LUQ2QjMtQUVEQS1BQzcxRDhCMjM1OTh9LnBuZ0E40JqGlwtA38+ikwJIUFAAWgBgAWoQvxcYXwBl1rOu2qxx2LI1mHJbL2djaGF0cGljX25ldy8yNDUwNDU5OTEwLzk1OTU2MjE5MC0zMDAxMTI2MjI0LUJGMTcxODVGMDA2NUQ2QjNBRURBQUM3MUQ4QjIzNTk4LzE5OD90ZXJtPTI1NYIBWS9nY2hhdHBpY19uZXcvMjQ1MDQ1OTkxMC85NTk1NjIxOTAtMzAwMTEyNjIyNC1CRjE3MTg1RjAwNjVENkIzQUVEQUFDNzFEOEIyMzU5OC8wP3Rlcm09MjU1oAHpB7ABnQO4ASrIAbRI2AHGAeABKvoBWy9nY2hhdHBpY19uZXcvMjQ1MDQ1OTkxMC85NTk1NjIxOTAtMzAwMTEyNjIyNC1CRjE3MTg1RjAwNjVENkIzQUVEQUFDNzFEOEIyMzU5OC80MDA/dGVybT0yNTWAAoADiAIq","ForwordField":8,"Url":"http://gchat.qpic.cn/gchatpic_new/2450459910/959562190-2534335053-BF17185F0065D6B3AEDAAC71D8B23598/0?vuin=1689236904\u0026term=255\u0026pictype=0"}],"Tips":"[群图片]"} PicMsg 1599404198 6494 868599970 <nil>} 
2020/09/06 22:56:43.523 [E]  QQLuaVmRun CallGlobal err <string>:263: cannot perform concat operation between nil and string
stack traceback:
	<string>:263: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{959562190 测试群 2450459910 凤飞翱翔兮丷 本群状态 TextMsg 1599404203 6495 522637444 <nil>} 
2020/09/06 22:56:49.466 [E]  QQLuaVmRun CallGlobal err <string>:263: cannot perform concat operation between nil and string
stack traceback:
	<string>:263: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{959562190 测试群 2450459910 凤飞翱翔兮丷 本群状态 TextMsg 1599404209 6496 3288612890 <nil>} 
2020/09/06 22:57:27.295 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136418 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:876883019 MsgSeq:136418 UserID:1689236904]
2020/09/06 22:57:29.611 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136419 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:930060926 MsgSeq:136419 UserID:1689236904]
2020/09/06 22:57:42.940 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136421 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:3595412083 MsgSeq:136421 UserID:1689236904]
2020/09/06 23:10:21.682 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136440 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:37517516 MsgSeq:136440 UserID:1689236904]
2020/09/06 23:11:09.644 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136450 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:4077932263 MsgSeq:136450 UserID:1689236904]
2020/09/06 23:11:11.983 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136451 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:2858094754 MsgSeq:136451 UserID:1689236904]
2020/09/06 23:11:13.260 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136452 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:2648051541 MsgSeq:136452 UserID:1689236904]
2020/09/06 23:11:13.626 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136454 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:2968226866 MsgSeq:136454 UserID:1689236904]
2020/09/06 23:12:09.959 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136458 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:1952445566 MsgSeq:136458 UserID:1689236904]
2020/09/06 23:12:21.590 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136459 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:3472566619 MsgSeq:136459 UserID:1689236904]
2020/09/06 23:12:24.606 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136460 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:3920704969 MsgSeq:136460 UserID:1689236904]
2020/09/06 23:32:44.969 [E]  mimoio.lua
2020/09/06 23:32:44.969 [E]  local log = require("log")
local Api = require("coreApi")
local json = require("json")
local http = require("http")
local mysql = require("mysql")

--版本号(不要改动)
Vabr = "1.0.2"
--数据库配置
mysqlhost = "localhost"--默认不动
mysqldb = "ffaxx001"--数据库名
mysqluser = "ffaxx001"--数据库用户名
mysqlpass = "123456"--数据库密码
--不使用请不要改动

function ReceiveFriendMsg(CurrentQQ, data)
    if (data.Content == "使用方法") then
	    sendfrimsg(CurrentQQ,data,"添加授权者的方法\n对单个机器人私聊发送[添加授权者+授权者QQ]\n\n授权群的方法\n到需要授权的群里发送[授权+主人QQ]。注意:授权必须是授权者进行操作,管理员授权不了")
	end
    --数据初始化
    if (data.Content == "初始化") then
	    root = Read("mimoio\/"..data.FromUin..".txt")
	    if (root ~= nil) then
		    sendfrimsg(CurrentQQ,data,"∴请不要重复初始化")
			return 1
		end
    --os.execute('mkdir mimoio/机器授权')
	    os.execute('mkdir mimoio')
		os.execute('mkdir mimoio/复读机')
		os.execute('mkdir mimoio/复读机/次数')
		os.execute('mkdir mimoio/复读机/内容')
		os.execute('mkdir mimoio/机器授权')
		os.execute('mkdir mimoio/机器配置')
		os.execute('mkdir mimoio/机器配置/机器主人')
		os.execute('mkdir mimoio/机器配置/机器聊天')
		os.execute('mkdir mimoio/机器调教')
		os.execute('mkdir mimoio/状态数据')
		os.execute('mkdir mimoio/状态数据/抢红包')
		os.execute('mkdir mimoio/状态数据/机器聊天')
		os.execute('mkdir mimoio/状态数据/机器开关')
		os.execute('mkdir mimoio/状态数据/撤回检测')
		os.execute('mkdir mimoio/状态数据/图片解析')
		os.execute('mkdir mimoio/状态数据/视频解析')
		os.execute('mkdir mimoio/状态数据/闪照检测')
		Wirte("mimoio\/"..data.FromUin..".txt","999")
		sendfrimsg(CurrentQQ,data,"初始化完毕！\n发送[使用方法]了解使用吧")
	end
	--添加授权者操作(私聊机器人发送)
	if (string.find(data.Content, "^添加授权者")) then
	    msg = data.Content:gsub("添加授权者", "")
		--Wirte("mimoio\/状态数据\/抢红包\/"..data.FromUin..".txt","关闭")
		root = Read("mimoio\/"..data.FromUin..".txt")
	    if (root == nil) then
		    sendfrimsg(CurrentQQ,data,"∴你不是我的管理者")
			return 1
		end
		Wirte("mimoio\/机器授权\/"..msg..CurrentQQ..".txt","999")
		sendfrimsg(CurrentQQ,data,"∴添加授权者成功")
	end
	--删除授权者操作(私聊机器人发送)
	if (string.find(data.Content, "^删除授权者")) then
	    msg = data.Content:gsub("删除授权者", "")
		--Wirte("mimoio\/状态数据\/抢红包\/"..data.FromUin..".txt","关闭")
		root = Read("mimoio\/"..data.FromUin..".txt")
	    if (root == nil) then
		    sendfrimsg(CurrentQQ,data,"∴你不是我的管理者")
			return 1
		end
		os.remove("mimoio\/机器授权\/"..msg..CurrentQQ..".txt")
		sendfrimsg(CurrentQQ,data,"∴删除授权者成功")
	end
    return 1
end
function ReceiveGroupMsg(CurrentQQ, data)
    if (tostring(data.FromUserId) == CurrentQQ) then
	    return 1
	end
	--群聊授权(到需要授权的群里操作)
	if (string.find(data.Content, "^授权")) then
	    root = Read("mimoio\/机器授权\/"..data.FromUserId..CurrentQQ..".txt","999")
		if (root == nil) then
		    sedmsg(CurrentQQ,data,"∴你不是我的授权者")
			return 1
		end
		msg = data.Content:gsub("授权", "")
		os.execute('mkdir mimoio/机器调教/'..data.FromGroupId)
		os.execute('mkdir mimoio/机器配置/机器主人/'..data.FromGroupId)
		Wirte("mimoio\/机器配置\/机器主人\/"..data.FromGroupId.."\/"..msg..".txt","999")
		Wirte("mimoio\/状态数据\/抢红包\/"..data.FromGroupId..".txt","关闭")
		Wirte("mimoio\/状态数据\/机器聊天\/"..data.FromGroupId..".txt","关闭")
		Wirte("mimoio\/状态数据\/撤回检测\/"..data.FromGroupId..".txt","关闭")
		Wirte("mimoio\/状态数据\/视频解析\/"..data.FromGroupId..".txt","关闭")
		Wirte("mimoio\/状态数据\/闪照检测\/"..data.FromGroupId..".txt","关闭")
		Wirte("mimoio\/状态数据\/图片解析\/"..data.FromGroupId..".txt","关闭")
		Wirte("mimoio\/机器配置\/机器聊天\/"..data.FromGroupId..".txt","回复聊天")
		sedmsg(CurrentQQ,data,"∴授权成功！\n发送[开启机器人]使用吧")
	end
	--删除授权操作(到需要删除授权的群里操作)
	if (string.find(data.Content, "^删除授权")) then
	    root = Read("mimoio\/机器授权\/"..data.FromUserId..CurrentQQ..".txt","999")
		if (root == nil) then
		    sedmsg(CurrentQQ,data,"∴你不是我的授权者")
			return 1
		end
		msg = data.Content:gsub("删除授权", "")
		os.remove("mimoio\/机器配置\/机器主人\/"..data.FromGroupId.."\/"..msg..".txt")
		os.remove("mimoio\/状态数据\/机器开关\/"..data.FromGroupId..CurrentQQ..".txt")
		sedmsg(CurrentQQ,data,"∴删除授权成功！")
	end
	--机器开关指令
	if (data.Content == "开启机器人" or data.Content == "关闭机器人") then
        mim = Read("mimoio\/机器配置\/机器主人\/"..data.FromGroupId.."\/"..data.FromUserId..".txt")
        if (mim ~= nil) then
            msg = data.Content:gsub("机器人", "")
            str = Read("mimoio\/状态数据\/机器开关\/"..data.FromGroupId..CurrentQQ..".txt")
			if (str == nil) then
			    Wirte("mimoio\/状态数据\/机器开关\/"..data.FromGroupId..CurrentQQ..".txt",msg)
                sedmsg(CurrentQQ,data,"∴机器人"..msg.."成功！")
				log.info("Str ====> %s", str)
                return 1
			end
			
            if (string.find(str, msg)) then
                sedmsg(CurrentQQ,data,"∴机器一直是"..msg.."的呐")
                return 1
            end
            Wirte("mimoio\/状态数据\/机器开关\/"..data.FromGroupId..CurrentQQ..".txt",msg)
            sedmsg(CurrentQQ,data,"∴机器人"..msg.."成功！")
            return 1
        else
            sedmsg(CurrentQQ,data,"∴你不是我主人呐")
            return 1
        end
	end
    --机器人开启检测
    str = Read("mimoio\/状态数据\/机器开关\/"..data.FromGroupId..CurrentQQ..".txt")
	if (str == nil) then
	    log.info("Str ====> %s", str)
        return 1
	end
	if (string.find(str, "关闭")) then
	    return 1
	end
	--at消息处理
	msgs = ""
	atqq = 0
	if (string.find(data.Content, "AT消息")) then
	    msgs = json.decode(data.Content).Content
		atqq = json.decode(data.Content).UserID
	end
	--尾巴自定义(待完善)
	tips = "——凤飞翱翔兮丷"
    --功能模块
    if (data.Content == "功能" or data.Content == "主界面") then
        face = faceArray()
        sedimgmsg(CurrentQQ,data,"http://q1.qlogo.cn/g?b=qq&nk="..data.FromUserId.."&s=640",face.."影视搜索\n"..face.."聊天娱乐\n"..face.."便利功能\n"..face.."机器调教\n"..face.."管理系统\n"..face.."bug反馈\n"..face.."本群状态\n"..face.."更新检测\n\n"..tips)
    end
    --影视搜索模块
    if (data.Content == "影视搜索") then
        face = faceArray()
		sedimgmsg(CurrentQQ,data,"http://q1.qlogo.cn/g?b=qq&nk="..data.FromUserId.."&s=640",face.."搜索+影视名\n"..face.."我想看+影视名\n"..face.."我要看+影视名\n\n"..tips)
    elseif (string.find(data.Content, "^搜索")) then
	    msg = data.Content:gsub("搜索", "")
		Sousuo(CurrentQQ,data,msg)
	elseif (string.find(data.Content, "^我想看")) then
	    msg = data.Content:gsub("我想看", "")
		Sousuo(CurrentQQ,data,msg)
    elseif (string.find(data.Content, "^我要看")) then
	    msg = data.Content:gsub("我要看", "")
		Sousuo(CurrentQQ,data,msg)
	end
	--聊天娱乐模块
	if (data.Content == "聊天娱乐") then
        face = faceArray()
		sedimgmsg(CurrentQQ,data,"http://q1.qlogo.cn/g?b=qq&nk="..data.FromUserId.."&s=640",face.."切换文字聊天\n"..face.."切换回复聊天\n"..face.."切换语音聊天\n\n"..tips)
    elseif (data.Content == "切换文字聊天") then
		liaotian(CurrentQQ,data,1)
	elseif (data.Content == "切换语音聊天") then
	    liaotian(CurrentQQ,data,2)
    elseif (data.Content == "切换回复聊天") then
	    liaotian(CurrentQQ,data,3)
	else
	    ownthink(CurrentQQ,data,msgs,atqq)
	end
	--便利功能模块
	if (data.Content == "便利功能") then
        face = faceArray()
		sedimgmsg(CurrentQQ,data,"http://q1.qlogo.cn/g?b=qq&nk="..data.FromUserId.."&s=640",face.."百科大全\n"..face.."音乐点歌\n"..face.."闪他@xx\n"..face.."天气查询\n\n"..tips)
	elseif (data.Content == "百科大全") then
		sedmsg(CurrentQQ,data,"发送:[百科+关键词]\n例如:百科洛天依")
    elseif (data.Content == "音乐点歌") then
		sedmsg(CurrentQQ,data,"发送:[点歌+歌名]\n例如:点歌青柠")
	elseif (data.Content == "天气查询") then
		sedmsg(CurrentQQ,data,"发送:[天气+地方名]\n例如:天气北京(限于国内)")
    elseif (string.find(data.Content, "^天气")) then
        tianqi(CurrentQQ,data)
	    --msg = data.Content:gsub("搜索", "")
		--Sousuo(CurrentQQ,data,msg)
	elseif (string.find(data.Content, "^百科")) then
	    baike(CurrentQQ,data)
	    --msg = data.Content:gsub("我想看", "")
		--Sousuo(CurrentQQ,data,msg)music(CurrentQQ,data)
    elseif (string.find(data.Content, "^点歌")) then
	    music(CurrentQQ,data)
	end
	--机器调教模块
	if (data.Content == "机器调教") then
        face = faceArray()
		sedimgmsg(CurrentQQ,data,"http://q1.qlogo.cn/g?b=qq&nk="..data.FromUserId.."&s=640",face.."文字调教\n"..face.."语音调教\n"..face.."唱歌调教\n"..face.."音乐调教\n"..face.."图片调教\n"..face.."删除调教\n\n"..tips)
    elseif (data.Content == "文字调教") then
		sedmsg(CurrentQQ,data,"发送[调教(指令)#(内容)]\n例如:调教你好#你好啊")
	elseif (data.Content == "语音调教") then
		sedmsg(CurrentQQ,data,"发送[调教(指令)#语音(内容)]\n例如:调教你好#语音你好啊")
	elseif (data.Content == "图片调教") then
		sedmsg(CurrentQQ,data,"发送[调教(指令)#图片(链接)]\n例如:调教你好#图片http://../1.jpg")
	elseif (data.Content == "音乐调教") then
		sedmsg(CurrentQQ,data,"发送[调教(指令)#点歌(歌名)]\n例如:调教喵#点歌学猫叫")
	elseif (data.Content == "唱歌调教") then
		sedmsg(CurrentQQ,data,"发送[调教(指令)#唱歌(歌名)]\n例如:调教喵#唱歌学猫叫")
	elseif (data.Content == "删除调教") then
		sedmsg(CurrentQQ,data,"发送[删除调教(指令)]\n例如:删除调教你好")
	elseif (string.find(data.Content, "^调教")) then
        tiaojiao(CurrentQQ,data)
	elseif (string.find(data.Content, "^删除调教")) then
        tiaojiao(CurrentQQ,data)
	end
	--管理系统模块
	if (data.Content == "管理系统") then
        face = faceArray()
		sedimgmsg(CurrentQQ,data,"http://q1.qlogo.cn/g?b=qq&nk="..data.FromUserId.."&s=640",face.."开启/关闭机器人\n"..face.."开启/关闭抢红包\n"..face.."开启/关闭机器聊天\n"..face.."开启/关闭闪照检测\n"..face.."开启/关闭图片解析\n"..face.."开启/关闭视频解析\n"..face.."开启/关闭撤回检测\n\n"..tips)
    elseif (data.Content == "开启机器聊天" or data.Content == "关闭机器聊天") then
        adminio(CurrentQQ,data,"机器聊天")
    elseif (data.Content == "开启撤回检测" or data.Content == "关闭撤回检测") then
        adminio(CurrentQQ,data,"撤回检测")
	elseif (data.Content == "开启闪照检测" or data.Content == "关闭闪照检测") then
        adminio(CurrentQQ,data,"闪照检测")
	elseif (data.Content == "开启抢红包" or data.Content == "关闭抢红包") then
        adminio(CurrentQQ,data,"抢红包")
	elseif (data.Content == "开启视频解析" or data.Content == "关闭视频解析") then
        adminio(CurrentQQ,data,"视频解析")
	elseif (data.Content == "开启图片解析" or data.Content == "关闭图片解析") then
        adminio(CurrentQQ,data,"图片解析")
	end
	--bug反馈模块
	if (data.Content == "BUG反馈" or data.Content == "bug反馈") then
        face = faceArray()
		sedimgmsg(CurrentQQ,data,"http://q1.qlogo.cn/g?b=qq&nk="..data.FromUserId.."&s=640",face.."邮件反馈\n"..face.."QQ反馈\n\n"..tips)
    elseif (data.Content == "QQ反馈") then
        sedmsg(CurrentQQ,data,"???Σ(ﾟ∀ﾟﾉ)ﾉ\n插件有问题可以反馈到:\nQQ:2353065854")
    elseif (data.Content == "邮件反馈") then
        sedmsg(CurrentQQ,data,"宝贝咋啦=͟͟͞͞(꒪ᗜ꒪ ‧̣̥̇)\n插件有问题可以反馈到:\n邮箱📬:ym-o@qq.com")
	end
	--本群状态模板
	if (data.Content == "本群状态") then
        face = faceArray()
        hb = Read("mimoio\/状态数据\/抢红包\/"..data.FromGroupId..".txt")
        sz = Read("mimoio\/状态数据\/闪照检测\/"..data.FromGroupId..".txt")
		tp = Read("mimoio\/状态数据\/图片解析\/"..data.FromGroupId..".txt")
        sp = Read("mimoio\/状态数据\/视频解析\/"..data.FromGroupId..".txt")
        jqr = Read("mimoio\/状态数据\/机器开关\/"..data.FromGroupId..CurrentQQ..".txt")
        lt = Read("mimoio\/状态数据\/机器聊天\/"..data.FromGroupId..".txt")
        ch = Read("mimoio\/状态数据\/撤回检测\/"..data.FromGroupId..".txt")
		sedmsg(CurrentQQ,data,"状态数据列表↓↓↓\n"..face.."机器人:"..jqr.."\n"..face.."抢红包:"..hb.."\n"..face.."图片解析:"..tp.."\n"..face.."撤回检测:"..ch.."\n"..face.."视频解析:"..sp.."\n"..face.."机器聊天:"..lt.."\n"..face.."闪照检测:"..sz.."\n\n"..tips)
	end
	--更新模块
	if (data.Content == "更新检测") then
        str = geturl("GET","http://118.25.41.32/Lsb/lua/Vabr.txt","")
		log.info("Str ====> %s", str)
        if (string.find(str, Vabr)) then
            sedmsg(CurrentQQ,data,"当前版本为最新版")
        else
            sedmsg(CurrentQQ,data,"发现新版本!\n当前版本:"..Vabr.."\n新版本号:"..str.."\n赶快发送[更新插件]吧")
        end
	elseif (data.Content == "更新插件") then
	    mim = Read("mimoio\/机器配置\/机器主人\/"..data.FromGroupId.."\/"..data.FromUserId..".txt")
        if (mim == nil) then
            sedmsg(CurrentQQ,data,"∴你不是我主人呐")
            return 1
        end
        str = geturl("GET","http://118.25.41.32/Lsb/lua/Vabr.txt","")
		log.info("Str ====> %s", str)
        if (string.find(str, Vabr)) then
            sedmsg(CurrentQQ,data,"当前版本为最新版")
        else
            str = geturl("GET","http://118.25.41.32/Lsb/lua/mimoio.txt","")
            Wirte("Plugins\/mimoio.lua",str)
            sedmsg(CurrentQQ,data,"更新完毕！")
        end
	end
	--图片类型消息处理
    if (data.MsgType == "PicMsg") then
	    msg = Read("mimoio\/状态数据\/图片解析\/"..data.FromGroupId..".txt")
		jData = json.decode(data.Content)
	    if (msg ~= nil and jData.tips ~= "[群消息-QQ闪照]") then
            if (string.find(str, "开启")) then
	            sedmsg(CurrentQQ,data,"图片链接解析如下↓↓\n"..jData.url)
				return 1
	        end
	    end
	    --开关判断模块
	    str = Read("mimoio\/状态数据\/闪照检测\/"..data.FromGroupId..".txt")
	    if (str == nil) then
            return 1
	    end
	    if (string.find(str, "关闭")) then
	        return 1
	    end
	    --闪照、图片处理模块
		PicFlag(CurrentQQ, data)
    end
	--抢红包处理
	if (string.find(data.MsgType, "RedBagMsg") == 1) then
	    --开关判断模块
	    str = Read("mimoio\/状态数据\/抢红包\/"..data.FromGroupId..".txt")
		if (str == nil) then
	        log.info("Str ====> %s", str)
            return 1
	    end
	    if (string.find(str, "关闭")) then
	        return 1
	    end
	    RedBag(CurrentQQ, data)
	end
	--视频解析处理
	if (string.find(data.MsgType, "VideoMsg") == 1) then
	    --开关判断模块
	    str = Read("mimoio\/状态数据\/视频解析\/"..data.FromGroupId..".txt")
		if (str == nil) then
	        log.info("Str ====> %s", str)
            return 1
	    end
	    if (string.find(str, "关闭")) then
	        return 1
	    end
	    Video(CurrentQQ, data)
	end
	--at闪图
	if (data.MsgType == "AtMsg") and (string.find(data.Content, "闪他")) then
	    shantu(CurrentQQ, data)
    end
	--调教搜索引擎
	mim = Read("mimoio\/机器调教\/"..data.FromGroupId.."\/"..data.Content..".txt")
	if (mim == nil) then
	    --人类的本质是复读机
	    msg = Read("mimoio\/复读机\/内容\/"..data.FromGroupId..".txt")
		if (msg ~= nil) then
		    cs = Read("mimoio\/复读机\/次数\/"..data.FromGroupId..".txt")
			ii = tonumber(cs)
			if (string.find(msg, "^"..data.Content.."$")) then
			    if (ii > 2) then
			         math.randomseed(os.time())
                     sj = math.random(1, 5)
		             if (sj == 1 or sj == 2) then
			             sedmsg(CurrentQQ,data,msg)
					     rr = ii + 1
		                 Wirte("mimoio\/复读机\/次数\/"..data.FromGroupId..".txt",tostring(rr))
				     elseif (sj == 3) then
				         os.remove("mimoio\/复读机\/次数\/"..data.FromGroupId..".txt")
					     os.remove("mimoio\/复读机\/内容\/"..data.FromGroupId..".txt")
					     fdArray = {"突然截断复读(ﾟ⊿ﾟ)ﾂ","复读可耻(•̀へ •́ ╮ )","不要复读了啦","这就是所谓的人类的本质","你们咋不上天呐","又复读上瘾了啊"}
                         math.randomseed(os.time())
                         fdsj = math.random(1, 6)
				         sedmsg(CurrentQQ,data,fdArray[fdsj])
				     else
			             rr = ii + 1
		                 Wirte("mimoio\/复读机\/次数\/"..data.FromGroupId..".txt",tostring(rr))
		             end
			    else
			        rr = ii + 1
		            Wirte("mimoio\/复读机\/次数\/"..data.FromGroupId..".txt",tostring(rr))
			    end
			else
			    if (ii > 2) then
			        math.randomseed(os.time())
                    sj2 = math.random(1, 3)
					if (sj2 == 2) then
					    fdArray2 = {"中断复读可耻","打断复读可耻(•̀へ •́ ╮ )","你为什么要打断复读啊","复读不香嘛","破坏氛围(งᵒ̌皿ᵒ̌)ง⁼³₌₃"}
                        math.randomseed(os.time())
                        fdsj2 = math.random(1, 5)
				        sedmsg(CurrentQQ,data,fdArray2[fdsj2])
					end
				end
				Wirte("mimoio\/复读机\/次数\/"..data.FromGroupId..".txt","1")
			    Wirte("mimoio\/复读机\/内容\/"..data.FromGroupId..".txt",data.Content)
			end
		else
		    Wirte("mimoio\/复读机\/次数\/"..data.FromGroupId..".txt","1")
			Wirte("mimoio\/复读机\/内容\/"..data.FromGroupId..".txt",data.Content)
		end
	    --如果调教指令不存在，则进行其他操作
	    msgsql(CurrentQQ,data)--数据储蓄
		--随机回复消息概率0.04
	    math.randomseed(os.time())
        num = math.random(1, 40)
		if (num == 12) then
		    j = xiaosiapi(CurrentQQ,data,data.Content)
			sedmsg(CurrentQQ,data,j.data.info.text)
		end
	else
	    --触发调教指令
		funic(CurrentQQ,data,mim)
	end
    return 1
end

function ReceiveEvents(CurrentQQ, data, extData)
  if data.MsgType == "ON_EVENT_GROUP_REVOKE" then --监听 群撤回事件
    --撤回事件处理
    str = Read("mimoio\/状态数据\/撤回检测\/"..extData.GroupID..".txt")
    if (str == nil) then
	    log.info("Str ====> %s", str)
        return 1
	end
	if (string.find(str, "关闭")) then
		return 1
	end
	CheHui(CurrentQQ, data, extData)
	--xxxxxxxxxxxxxxx
    return 1
  end
  --进群秀图欢迎
  if (string.find(data.MsgType, "ON_EVENT_GROUP_JOIN") == 1) then
      --机器人开启检测
    str = Read("mimoio\/状态数据\/机器开关\/"..data.FromUin..CurrentQQ..".txt")
	if (str == nil) then
	    log.info("Str ====> %s", str)
        return 1
	end
	if (string.find(str, "关闭")) then
	    return 1
	end
      xiutu(CurrentQQ, data, extData)
  end
end

--秀图函数
function xiutu(CurrentQQ, data, extData)
    math.randomseed(os.time())
    num = math.random(40001, 40002)
    Api.Api_SendMsg( --通过图片md5发送图片 秒发不用上传 相当于转发
           CurrentQQ,
           {
               toUser = data.FromUin,
               sendToType = 2,
               sendMsgType = "PicMsg",
               --发送图文消息
               content = string.format("[秀图%d]欢迎【%s】加入[PICFLAG]",40002,extData.UserName),
               --通过宏[PICFLAG]改变图文顺序  改为现文字后图片
               --通过宏[秀图40001] 范围 40000-40006 实现秀图发送 群有效好友无效
               atUser = 0,
               picUrl = "http://q1.qlogo.cn/g?b=qq&nk=".. extData.UserID .. "&s=640",
               pi机器人ase64Buf = "",
               fileMd5 = ""
           }
       )
end

--闪图检测处理
function shantu(CurrentQQ, data)
        math.randomseed(os.time())
        ShowType = math.random(40001, 40002)
        jData = json.decode(data.Content)
        Api.Api_SendMsg( --通过Url发送图片
            CurrentQQ,
            {
                toUser = data.FromGroupId,
                sendToType = 2,
                sendMsgType = "PicMsg",
                --发送图文消息
                content = string.format("[秀图%d]", ShowType),
                --通过宏[PICFLAG]改变图文顺序  改为现文字后图片
                --通过宏[秀图40001] 范围 40000-40005 实现秀图发送 群有效好友无效
                atUser = 0,
                voiceUrl = "",
                voiceBase64Buf = "",
                picUrl = "http://q1.qlogo.cn/g?b=qq&nk=" .. jData.UserID .. "&s=640",
                pi机器人ase64Buf = "",
                fileMd5 = ""
            }
        )
		return 1
end

--闪照检测处理
function PicFlag(CurrentQQ, data)
    jData = json.decode(data.Content)
		if (jData.tips == "[群消息-QQ闪照]") then
			Api.Api_SendMsg( --通过图片md5发送图片 秒发不用上传 相当于转发
                        CurrentQQ,
                        {
                            toUser = data.FromGroupId,
                            sendToType = 2,
                            sendMsgType = "PicMsg",
                            --发送图文消息
                            content = string.format(
                                "捕获到成员 %d\n═══════════\n闪照内容为:[PICFLAG]",
                                data.FromUserId
                            ),
                            --通过宏[PICFLAG]改变图文顺序  改为现文字后图片
                            atUser = 0,
                            voiceUrl = "",
                            voiceBase64Buf = "",
                            picUrl = "",
                            pi机器人ase64Buf = "",
                            fileMd5 = jData.FileMd5
                        }
                    )
             return 1
	    end
end

--功能组
function funic(CurrentQQ,data,msg)
    if string.find(msg, "^点歌") then
	    data.Content = msg
        music(CurrentQQ,data,msg)
		return 1
	elseif string.find(msg, "^语音") then
	    keyWord = msg:gsub("语音", "")
        sedvoicemsg(CurrentQQ,data,keyWord)
		return 1
	elseif string.find(msg, "^图片") then
	    keyWord = msg:gsub("图片", "")
        sedimgmsg(CurrentQQ,data,keyWord,"")
		return 1
    elseif string.find(msg, "^唱歌") then
        keyWord = msg:gsub("唱歌", "")
		if (keyWord == "") then
		    sedmsg(CurrentQQ,data,"歌名不能空着哦")
		    return 1
		end
		sedmsg(CurrentQQ,data,"天依正在努力加载٩(˃̶͈̀௰˂̶͈́)و")
        response, error_message =
            http.request(
            "POST",
            "http://127.0.0.1:8888/SilkApi/UrlToBuf",--修改此处ip及端口即可
            {
                body = keyWord --传入歌曲名
            }
        )
        log.notice("err   %v", error_message)
        html = response.body --返回silk base64 buf
		if (string.find(html, "δ")) then
				    sedmsg(CurrentQQ,data,"天依没有找到相关的歌呀(ÒωÓױ)！")
					c.close(c)
				    return 2
				end
        luaRes =
            Api.Api_SendMsg(
            CurrentQQ,
            {
                toUser = data.FromGroupId,
                sendToType = 2,
                sendMsgType = "VoiceMsg",
                groupid = 0,
                content = "",
                atUser = 0,
                voiceUrl = "",
                voiceBase64Buf = html 
            }
        )
		return 1
	end
    sedmsg(CurrentQQ,data,msg)
end

--影视搜索用
function Sousuo(CurrentQQ,data,msg)
    response, error_message =
        http.request(
            "GET",
            "http://localhost/index.php/ajax/suggest",
            {
                query = "mid=1&f=admin&wd="..msg.."&limit=10&timestamp=1567914326746"
            }
        )
    html = response.body
	json = json.decode(html)
	if (json.total == 0) then
	    sedmsg(CurrentQQ,data,"影视查询错误\n请检查影视名是否正确\n═══════════\n注意⚠️影视名不要带无关或多余的字符")
	else
        sedmsg(CurrentQQ,data,"资源地址如下↓↓↓\n══════════\nhttp://118.25.41.32/index.php/vod/search/wd/"..escape(msg)..".html\n═══════════\n注意:如果QQ出现停止访问现象，请复制链接用浏览器打开")
	end
end

--单纯发消息图文通用
function sedimgmsg(CurrentQQ,data,url,msg)
    ApiRet = Api.Api_SendMsg(
        CurrentQQ,
        {
        toUser = data.FromGroupId,
        sendToType = 2,
        sendMsgType = "PicMsg",
        groupid = 0,
        content = msg,
        pi机器人ase64Buf = "",
        --发本地送图片的buf 转 bas64 编码 文本型
        fileMd5 = "",
		picUrl = url,
        atUser = 0
        }
    )
	return ApiRet
end

--单纯发消息用
function sedmsg(CurrentQQ,data,msg)
    ApiRet = Api.Api_SendMsg(
        CurrentQQ,
        {
        toUser = data.FromGroupId,
        sendToType = 2,
        sendMsgType = "TextMsg",
        groupid = 0,
        content = msg,
        pi机器人ase64Buf = "",
        --发本地送图片的buf 转 bas64 编码 文本型
        fileMd5 = "",
		picUrl = "",
        atUser = 0
        }
    )
	return ApiRet
end

--单纯发私聊消息用
function sendfrimsg(CurrentQQ,data,msg)
    ApiRet = Api.Api_SendMsg(
        CurrentQQ,
        {
        toUser = data.FromUin,
        sendToType = 1,
        sendMsgType = "TextMsg",
        groupid = 0,
        content = msg,
        pi机器人ase64Buf = "",
        --发本地送图片的buf 转 bas64 编码 文本型
        fileMd5 = "",
		picUrl = "",
        atUser = 0
        }
    )
	return ApiRet
end

--单纯发json消息用
function sedjsonmsg(CurrentQQ,data,msg)
    ApiRet = Api.Api_SendMsg(
        CurrentQQ,
        {
        toUser = data.FromGroupId,
        sendToType = 2,
        sendMsgType = "JsonMsg",
        groupid = 0,
        content = msg,
        pi机器人ase64Buf = "",
        --发本地送图片的buf 转 bas64 编码 文本型
        fileMd5 = "",
		picUrl = "",
        atUser = 0
        }
    )
	return ApiRet
end

--聊天模块切换函数
function liaotian(CurrentQQ,data,msg)
    mim = Read("mimoio\/机器配置\/机器主人\/"..data.FromGroupId.."\/"..data.FromUserId..".txt")
    if (mim == nil) then
        sedmsg(CurrentQQ,data,"∴你不是我主人呐")
        return 1
    end
    str = Read("mimoio\/状态数据\/机器聊天\/"..data.FromGroupId..".txt")
	if (str == nil) then
        return 1
    end
	if (string.find(str, "关闭")) then
	    sedmsg(CurrentQQ,data,"机器聊天处于关闭状态\n∴请先开启机器聊天")
	    return 1
	end
	--切换处理
	file = io.open("mimoio\/机器配置\/机器聊天\/"..data.FromGroupId..".txt", "w")
	if (msg == 1) then
	    file:write("文字聊天")
	    sedmsg(CurrentQQ,data,"∴成功切换到文字聊天")
	elseif (msg == 2) then
	    file:write("语音聊天")
	    sedmsg(CurrentQQ,data,"∴成功切换到语音聊天")
	elseif (msg == 3) then
	    file:write("回复聊天")
	    sedmsg(CurrentQQ,data,"∴成功切换到回复聊天")
	end
	file:close()
end

--随机表情函数
function faceArray()
    faceArray = {"[表情147]","🍀","🔥","🍻","💎","[表情185]","[表情219]","[表情176]"}
    math.randomseed(os.time())
    num = math.random(1, 9)
    return faceArray[num]
end

--url编码转换
function escape(w)
	pattern="[^%w%d%._%-%* ]"
	s=string.gsub(w,pattern,function(c)
		local c=string.format("%%%02X",string.byte(c))
		return c
	end)
	s=string.gsub(s," ","+")
	return s
end

--读取数据函数
function Read(url)
    file = io.open(url, "r")
	if (file == nil) then
	    return nil
	else
        file:seek("set")
	    str = file:read("*a")
	    file:close()
        return str
	end
end

--写入数据函数
function Wirte(url,msg)
    file = io.open(url, "w+")
    file:write(msg)
	file:close()
    return "ok"
end

--小思聊天函数
function xiaosiapi(CurrentQQ,data,str)
    response, error_message =
            http.request(
            "GET",
            "https://api.ownthink.com/bot",
            {
                query = "appid="..tostring(data.FromUserId).."&spoken=" .. url_encode(str),
                headers = {
                    Accept = "*/*"
                }
            }
        )
        html = response.body
		jData = json.decode(html)
		return jData
end

--机器聊天函数
function ownthink(CurrentQQ,data,msgs,atqq)
    if (tostring(atqq) == CurrentQQ) then
        m = Read("mimoio\/状态数据\/机器聊天\/"..data.FromGroupId..".txt")
        if (m == nil) then
	        log.info("Str ====> %s", m)
            return 1
	    end
	    if (string.find(m, "关闭")) then
	        sedmsg(CurrentQQ,data,"机器聊天处于关闭状态\n∴请先开启机器聊天")
	        return 1
	    end
		res2 = string.find(msgs, " ")
		str = string.sub(msgs,res2)
		jData = xiaosiapi(CurrentQQ,data,str)
		Data = json.decode(data.Content)
		m = Read("mimoio\/机器配置\/机器聊天\/"..data.FromGroupId..".txt")
		if (m == nil) then
	        log.info("Str ====> %s", m)
            return 1
	    end
		if (string.find(m, "回复聊天")) then
		    Api.Api_SendMsg(
                CurrentQQ,
                {
                toUser = data.FromGroupId,
                sendToType = 2,
                sendMsgType = "ReplayMsg",
                groupid = 0,
                content = jData.data.info.text,
                atUser = 0,
				replayInfo = {
                    MsgSeq = data.MsgSeq,
                    --回复消息的Seq
                    MsgTime = data.MsgTime,
                    --回复消息的事件
                    UserID = data.FromUserId,
                    --回复消息对象
                    RawContent = Data.Content --回复消息的原内容
                }
				}
            )
			return 1
		elseif (string.find(m, "文字聊天")) then
		    sedmsg(CurrentQQ,data,jData.data.info.text)
		else
		    sedvoicemsg(CurrentQQ,data,url_encode(jData.data.info.text))
		end
    end
end

--发送语音消息
function sedvoicemsg(CurrentQQ,data,str)
    ApiRet = Api.Api_SendMsg(
        CurrentQQ,
        {
        toUser = data.FromGroupId,
        sendToType = 2,
        sendMsgType = "VoiceMsg",
        groupid = 0,
		voiceUrl = "https://dds.dui.ai/runtime/v1/synthesize?voiceId=qianranfa&speed=0.7&volume=100&audioType=wav&text="..str, --发送语音的网络地址 文本型
        voiceBase64Buf = "",
        content = "",
        atUser = 0
        }
    )
	return ApiRet
end

--天气查询函数
function tianqi(CurrentQQ,data)
    keyWord = data.Content:gsub("天气", "")
        if keyWord == "" then
            return 1
        end

        cookies = Api.Api_GetUserCook(CurrentQQ)

        response, error_message =
            http.request(
            "GET",
            "https://weather.mp.qq.com/cgi-bin/rich",
            {
                query = "g_tk=" .. cookies.Gtk .. "&city=" .. url_encode(keyWord),
                headers = {
                    Referer = "http://weather.mp.qq.com/ark"
                },
                cookies = {
                    uin = CurrentQQ,
                    skey = cookies.Skey
                }
            }
        )
        local html = response.body
        log.notice("From Lua html -->%s", html)

        local j = json.decode(html)
        if j.code ~= 0 then
            return 1
        end

        ApiRet =
            Api.Api_SendMsg(
            CurrentQQ,
            {
                toUser = data.FromGroupId,
                sendToType = 2,
                sendMsgType = "JsonMsg",
                groupid = 0,
                content = string.format(
                    --{"config":{"forward":1,"autosize":1},"prompt":"[应用]天气","app":"com.tencent.weather","ver":"0.0.0.1","view":"RichInfoView","meta":{"richinfo":{"adcode":"101210701","city":"成都","air":"58","min":"20","ts":"1500550866","wind":"1","date":"6月27日 周四","max":"28","type":"201"}},"desc":"天气"}
                    --[[{"app":"com.tencent.weather","desc":"","meta":{"weather":{"ad":[{"icon":"http://imgcache.qq.com/ac/tq/xz2/tp.jpg","p":"ptype=star","t":"2","title":"星座 | 今天会因为感情和家庭的问题，影响工作，还有，也要注意人...","url":""},{"icon":"http://imgcache.qq.com/ac/qqweather/image/2019/6/27.png","p":"ptype=lunar","t":"4","title":"黄历 | 农历五月廿五。宜订盟.纳采.出行.祈福.斋醮.安床.会...","url":""}],"info":{"it1":{"adcode":"101050101","city":"武汉","hour":"18","max":"29","min":"17","temp":"24","type":"202","ut":"1561630401","wea":"多云"},"it2":{"hour":"19","temp":"22","type":"202"},"it3":{"hour":"20","temp":"21","type":"202"},"ts":"1561631244"},"url":""}},"prompt":"【哈尔滨】多云 17°/29°, 18:13更新~","ver":"1.0.0.106","view":"WeatherThreeView"}]]
                    [[{"app":"com.tencent.weather","desc":"天气","view":"RichInfoView","ver":"1.0.0.217","prompt":"[应用]天气","meta":{"richinfo":{"adcode":"%s","air":"%s","city":"%s","date":"%s","max":"%s","min":"%s","ts":"1554951408","type":"%s","wind":"%s"}},"config":{"forward":1,"autosize":1,"type":"card"}}]],
                    j.data.adcode,
                    j.data.air,
                    j.data.city,
                    j.data.date,
                    j.data.max,
                    j.data.min,
                    j.data.type,
                    j.data.wind
                ),
                atUser = 0
            }
        )
end

--调教处理函数(待处理)
function tiaojiao(CurrentQQ,data)
    mim = Read("mimoio\/机器配置\/机器主人\/"..data.FromGroupId.."\/"..data.FromUserId..".txt")
	if (mim == nil) then
		sedmsg(CurrentQQ,data,"∴你不是我主人哇")
		return 1
	end
	if (string.find(data.Content, "^删除调教")) then
	    msg = data.Content:gsub("删除调教", "")
	    if (msg == "") then
		    sedmsg(CurrentQQ,data,"要删除的调教指令不能为空哦")
		    return 1
		end
		rese = Read("mimoio\/机器调教\/"..tostring(data.FromGroupId).."\/"..msg..".txt")
	    if (rese == nil) then
			sedmsg(CurrentQQ,data,"这个指令不存在了哦")
		    return 1
		end
		rm_file = os.remove("mimoio\/机器调教\/"..tostring(data.FromGroupId).."\/"..msg..".txt")
		log.info("删除调教 ====> %s", rm_file)
		sedmsg(CurrentQQ,data,"删除成功\n你不喜欢被这样调教的我吗[表情9]")
		return 1
	end
    msgs = data.Content:gsub("调教", "")
		res2 = string.find(msgs, "#")
		str = string.sub(msgs,res2+1)
		str2 = string.sub(msgs,1,res2-1)
		        
		        if (str == "") then
		            sedmsg(CurrentQQ,data,"调教的回答内容不能为空哦")
			        return 1
		        end
				if (str2 == "") then
		            sedmsg(CurrentQQ,data,"调教的指令内容不能为空哦")
			        return 1
		        end
		        rese = Read("mimoio\/机器调教\/"..data.FromGroupId.."\/"..str2..".txt")
					if (rese ~= nil) then
				        sedmsg(CurrentQQ,data,"指令已经存在了哦")
				        return 1
				    end
				Wirte("mimoio\/机器调教\/"..data.FromGroupId.."\/"..str2..".txt",str)
				sedmsg(CurrentQQ,data,"调教成功\n你还想再调教我一次吗[表情6]")
		        return 1
end

function url_encode(str)
    if (str) then
        str = string.gsub(str, "\n", "\r\n")
        str =
            string.gsub(
            str,
            "([^%w ])",
            function(c)
                return string.format("%%%02X", string.byte(c))
            end
        )
        str = string.gsub(str, " ", "+")
    end
    return str
end

--抢红包处理
function RedBag(CurrentQQ, data)
    Api.Api_OpenRedBag(CurrentQQ, data.RedBaginfo)
    if (data.RedBaginfo.RedType == 12) then
         luaRes =
                Api.Api_SendMsg(
                CurrentQQ,
                {
                    toUser = data.FromGroupId,
                    sendToType = 2,
                    sendMsgType = "TextMsg",
                    groupid = 0,
                    content = data.RedBaginfo.Tittle,
                    atUser = 0
                }
            )
        log.notice("From Lua SendMsg Ret\n%d", luaRes.Ret)
    end
end

--视频解析处理
function Video(CurrentQQ, data)
    vdata = json.decode(data.Content)
        videodata = {
            GroupID = data.FromGroupId,
            VideoUrl = vdata.VideoUrl,
            VideoMd5 = vdata.VideoMd5
        }
        --构造table 参数表
        luaResp = Api.Api_CallFunc(CurrentQQ, "PttCenterSvr.ShortVideoDownReq", videodata) --通过cmd调用功能包
        luaRes =
            Api.Api_SendMsg(
            CurrentQQ,
            {
                toUser = data.FromGroupId,
                sendToType = 2,
                sendMsgType = "TextMsg",
                groupid = 0,
                content = "解析视频URL-->" .. luaResp.VideoUrl,
                atUser = 0
            }
        )
end

--管理开关通用
function adminio(CurrentQQ,data,oio)
    mim = Read("mimoio\/机器配置\/机器主人\/"..data.FromGroupId.."\/"..data.FromUserId..".txt")
        if (mim ~= nil) then
            msg = data.Content:gsub(oio, "")
            str = Read("mimoio\/状态数据\/机器开关\/"..data.FromGroupId..CurrentQQ..".txt")
            if (string.find(str, "关闭")) then
                sedmsg(CurrentQQ,data,"∴机器人已被关闭...\n请先开启机器人")
                return 1
            end
			str2 = Read("mimoio\/状态数据\/"..oio.."\/"..data.FromGroupId..".txt")
			if (string.find(str2, msg)) then
			    sedmsg(CurrentQQ,data,"∴"..oio.."本就是"..str2.."状态")
                return 1
			end
            Wirte("mimoio\/状态数据\/"..oio.."\/"..data.FromGroupId..".txt",msg)
            sedmsg(CurrentQQ,data,"∴"..oio..msg.."成功")
            return 1
        else
            sedmsg(CurrentQQ,data,"∴你不是我主人呐")
            return 1
        end
end

--百科大全
function baike(CurrentQQ,data)
    keyWord = data.Content:gsub("百科", "")
        if keyWord == "" then
            return 1
        end
        response, error_message =
            http.request(
            "GET",
            "http://baike.baidu.com/api/openapi/BaikeLemmaCardApi",
            {
                query = "scope=103&format=json&appid=379020&bk_key=" .. url_encode(keyWord) .. "&bk_length=600"
            }
        )
        html = response.body
        while(string.find(html, '"errno":2')) do
            response, error_message =
            http.request(
            "GET",
            "http://baike.baidu.com/api/openapi/BaikeLemmaCardApi",
            {
                query = "scope=103&format=json&appid=379020&bk_key=" .. url_encode(keyWord) .. "&bk_length=600"
            })
			html = response.body
        end
        local j = json.decode(html)
        sedmsg(CurrentQQ,data,j.abstract.."\n"..j.url)
end

--音乐点歌
function music(CurrentQQ,data)
    keyWord = data.Content:gsub("点歌", "")
        if keyWord == "" then
            return 1
        end
        response, error_message =
            http.request(
            "GET",
            "https://c.y.qq.com/soso/fcgi-bin/client_search_cp",
            {
                query = "aggr=1&cr=1&flag_qc=0&p=1&n=6&w=" .. url_encode(keyWord)
            }
        )
        html = response.body
		str = string.sub(html,10,-2)
        j = json.decode(str)
        if (j.code == 0) then
            msg = ""
            num = j.data.song.list
            list = num[1]
            songname = list.songname
            singername = list.singer[1].name
            payplay = list.pay.payplay
			albummid = list.albummid
			songmid = list.songmid
	        sedjsonmsg(CurrentQQ,data,'{"app":"com.tencent.structmsg","desc":"音乐","view":"music","ver":"0.0.0.1","prompt":"[分享]' ..songname.. '","meta":{"music":{"sourceMsgId":"0","title":"' ..songname.. '","desc":"' ..singername.. '","preview":"y.gtimg.cn/music/photo_new/T002R150x150M000'..albummid..'.jpg","tag":"QQ音乐","musicUrl":"https://v1.itooi.cn/tencent/url?id='..songmid..'","jumpUrl":"y.qq.com/n/yqq/song/'..songmid..'.html","appid":100497308,"app_type":1,"action":"","source_url":"url.cn/5aSZ8Gc","source_icon":"url.cn/5tLgzTm","android_pkg_name":"com.tencent.qqmusic"}},"config":{"forward":true,"type":"normal","autosize":true}}')
			return 1
        else
            sedmsg(CurrentQQ,data,"∴Error:"..j.code)
			return 1
        end
end

--访问url
function geturl(url_class,url,caulrt)
        response, error_message =
            http.request(
            url_class,
            url,
            {
                query = caulrt
            }
        )
        html = response.body
		return html
end

--消息储蓄
function msgsql(CurrentQQ,data)
    if (mysqlpass == "") then
	    return 1
	end
    c = mysql.new()
    -- 初始化mysql对象
    ok, err = c:connect({host = mysqlhost, port = 3306, database = mysqldb, user = mysqluser, password = mysqlpass})
    --建立连接
    if ok then
        sqlstr =
            string.format(
            [[INSERT INTO msgcache (GroupID, MsgSeq, MsgRandom,MsgType,Data,MsgTime)VALUES (%d,%d,%d,'%s','%s',%d)]],
            data.FromGroupId,
            data.MsgSeq,
            data.MsgRandom,
            data.MsgType,
            data.Content,
            data.MsgTime
        )
        res, err = c:query(sqlstr) --入库缓存消息
        log.info("%s", err)
        c.close(c)
    --释放连接
    end
    return 1
end

--撤回检测
function CheHui(CurrentQQ, data, extData)
    c = mysql.new()
    -- 初始化mysql对象
	if (mysqlpass == "") then
	    return 1
	end
	
    if data.MsgType == "ON_EVENT_GROUP_REVOKE" then --监听 群撤回事件
        str = string.format("群成 %d  成员 UserID %s 撤回了消息Seq %s \n", extData.GroupID, extData.UserID, extData.MsgSeq)
        log.info("%s", str)
        ok, err = c:connect({host = mysqlhost, port = 3306, database = mysqldb, user = mysqluser, password = mysqlpass})
        --建立连接
        log.info("sql %v", err)
        if ok then
            sqlstr =
                string.format(
                "select * from msgcache where `GroupID`= %d and `MsgSeq` = %d",
                extData.GroupID,
                extData.MsgSeq
            )
            res, err = c:query(sqlstr) --跟群群id和消息SEQ查询出撤回的消息内容
            if err == nil then
                c.close(c)
                GroupID = tonumber(res[1]["GroupID"])
                MsgType = res[1]["MsgType"]
                Data = res[1]["Data"]

                if MsgType == "TextMsg" then
                    Api.Api_SendMsg(
                        CurrentQQ,
                        {
                            toUser = GroupID,
                            sendToType = 2,
                            sendMsgType = "TextMsg",
                            --发送文本消息
                            groupid = 0,
                            content = string.format(
                                "捕获到成员 %d\n═══════════\n撤回了一条文本消息\n消息内容为：\n%s",
                                extData.UserID,
                                Data
                            ),
                            atUser = 0
                        }
                    )
                end
                if MsgType == "SmallFaceMsg" then
                    --Data {"Content":"[表情101]","Hex":"FKY=","Index":101,"tips":"[小表情]"}
                    Api.Api_SendMsg(
                        CurrentQQ,
                        {
                            toUser = GroupID,
                            sendToType = 2,
                            sendMsgType = "TextMsg",
                            groupid = 0,
                            content = string.format(
                                "捕获到成员 %d\n═══════════\n撤回了一条表情消息\n消息内容为：\n%s",
                                extData.UserID,
                                json.decode(Data).Content
                            ),
                            atUser = 0
                        }
                    )
                end
                if MsgType == "PicMsg" then
                    --Data {"Content":"","FileId":2820717626,"FileMd5":"q0oEC5aloJJMFr10mplaXw==","FileSize":7026,"tips":"[群图片]","url":"http://gchat.qpic.cn/gchatpic_new/1700487478/960839480-2534335053-AB4A040B96A5A0924C16BD749A995A5F/0?vuin=u0026term=255u0026pictype=0"}
                    jData = json.decode(Data)
					if (jData.tips == "[群消息-QQ闪照]") then
					    
					Api.Api_SendMsg( 
                    CurrentQQ,
                    {
                        toUser = GroupID,
                        sendToType = 2,
                        sendMsgType = "ForwordMsg",
                        content = "",
                        atUser = 0,
                        groupid = 0,
                        voiceUrl = "",
                        voiceBase64Buf = "",
                        picUrl = "",
                        pi机器人ase64Buf = "",
                        forwordBuf = json.decode(Data).ForwordBuf, --欲转发的base64buf 图片消息 视频消息 会给出此参数
                        forwordField = json.decode(Data).ForwordField --欲写入协议的字段ID 图片消息 视频消息 会给出此参数
                    }
                )
				    return 1
					end
                    Api.Api_SendMsg( --通过图片md5发送图片 秒发不用上传 相当于转发
                        CurrentQQ,
                        {
                            toUser = GroupID,
                            sendToType = 2,
                            sendMsgType = "PicMsg",
                            --发送图文消息
                            content = string.format(
                                "捕获到成员 %d\n═══════════\n撤回了一条图片消息\n消息内容为：[PICFLAG]%s",
                                extData.UserID,
                                jData.Content
                            ),
                            --通过宏[PICFLAG]改变图文顺序  改为现文字后图片
                            atUser = 0,
                            voiceUrl = "",
                            voiceBase64Buf = "",
                            picUrl = "",
                            pi机器人ase64Buf = "",
                            fileMd5 = jData.FileMd5
                        }
                    )
                end
                if MsgType == "AtMsg" then
                    --Data {"Content":"@Kar98k skjjkssjkjs","UserID":123456789,"tips":"[AT消息]"}
                    Api.Api_SendMsg(
                        CurrentQQ,
                        {
                            toUser = GroupID,
                            sendToType = 2,
                            sendMsgType = "TextMsg",
                            groupid = 0,
                            content = string.format(
                                "捕获到成员 %d\n═══════════\n撤回了一条at消息\n消息内容为：\n%s",
                                extData.UserID,
                                json.decode(Data).Content
                            ),
                            atUser = 0
                        }
                    )
                end
                if MsgType == "VoiceMsg" then
                    --Data {"tips":"[语音]","url":"http://grouptalk.c2c.qq.com/?ver=0u0026rkey=3062020101045b305902010102010102041fdef8ae042439416931554e5142586c536d78706a314c686843664959725f327a5f573064697653755902045dac2a21041f0000000866696c6574797065000000013100000005636f64656300000001310400u0026filetype=1u0026voice_codec=1"}
                    --log.info("sql %s", json.decode(Data).url)
                    Api.Api_SendMsg(
                        CurrentQQ,
                        {
                            toUser = GroupID,
                            sendToType = 2,
                            sendMsgType = "VoiceMsg",
                            --发送群语音消息
                            groupid = 0,
                            content = "",
                            atUser = 0,
                            voiceUrl = json.decode(Data).url,
                            --通过网络url进行发送语音
                            voiceBase64Buf = "",
                            picUrl = "",
                            pi机器人ase64Buf = ""
                        }
                    )
                end

                if MsgType == "ReplayMsg" then
                    --Data {"MsgSeq":3536,"ReplayContent":"11 @Mac","SrcContent":"...","UserID":123123,"tips":"[回复]"}
                    --log.info("sql %s", json.decode(Data).url)
                    Api.Api_SendMsg(
                        CurrentQQ,
                        {
                            toUser = GroupID,
                            sendToType = 2,
                            sendMsgType = "TextMsg",
                            groupid = 0,
                            content = string.format(
                                "捕获到成员 %d\n═══════════\n撤回了一条回复消息\n消息内容为：\n%s",
                                extData.UserID,
                                json.decode(Data).ReplayContent
                            ),
                            atUser = 0
                        }
                    )
                end
				if MsgType == "VideoMsg" then
	             Api.Api_SendMsg( 
                    CurrentQQ,
                    {
                        toUser = GroupID,
                        sendToType = 2,
                        sendMsgType = "ForwordMsg",
                        content = "",
                        atUser = 0,
                        groupid = 0,
                        voiceUrl = "",
                        voiceBase64Buf = "",
                        picUrl = "",
                        pi机器人ase64Buf = "",
                        forwordBuf = json.decode(Data).ForwordBuf, --欲转发的base64buf 图片消息 视频消息 会给出此参数
                        forwordField = json.decode(Data).ForwordField --欲写入协议的字段ID 图片消息 视频消息 会给出此参数
                    }
                )
				end
                if MsgType == "XmlMsg" then
				    
                    --Data {"MsgSeq":3536,"ReplayContent":"11 @Mac","SrcContent":"...","UserID":123123,"tips":"[回复]"}
                    --log.info("sql %s", json.decode(Data).url)
                    Api.Api_SendMsg(
                        CurrentQQ,
                        {
                            toUser = GroupID,
                            sendToType = 2,
                            sendMsgType = "XmlMsg",
                            groupid = 0,
                            content = string.format("%s", Data),
                            atUser = 0
                        }
                    )
                end
				if MsgType == "JsonMsg" then
				    
                    --Data {"MsgSeq":3536,"ReplayContent":"11 @Mac","SrcContent":"...","UserID":123123,"tips":"[回复]"}
                    --log.info("sql %s", json.decode(Data).url)
                    Api.Api_SendMsg(
                        CurrentQQ,
                        {
                            toUser = GroupID,
                            sendToType = 2,
                            sendMsgType = "JsonMsg",
                            groupid = 0,
                            content = string.format("%s", Data),
                            atUser = 0
                        }
                    )
                end
            end
        end
    end
    return 1
end
2020/09/06 23:33:15.368 [E]  mimoio.lua
2020/09/06 23:33:15.368 [E]  local log = require("log")
local Api = require("coreApi")
local json = require("json")
local http = require("http")
local mysql = require("mysql")

--版本号(不要改动)
Vabr = "1.0.2"
--数据库配置
mysqlhost = "localhost"--默认不动
mysqldb = "ffaxx001"--数据库名
mysqluser = "ffaxx001"--数据库用户名
mysqlpass = "123456"--数据库密码
--不使用请不要改动

function ReceiveFriendMsg(CurrentQQ, data)
    if (data.Content == "使用方法") then
	    sendfrimsg(CurrentQQ,data,"添加授权者的方法\n对单个机器人私聊发送[添加授权者+授权者QQ]\n\n授权群的方法\n到需要授权的群里发送[授权+主人QQ]。注意:授权必须是授权者进行操作,管理员授权不了")
	end
    --数据初始化
    if (data.Content == "初始化") then
	    root = Read("mimoio\/"..data.FromUin..".txt")
	    if (root ~= nil) then
		    sendfrimsg(CurrentQQ,data,"∴请不要重复初始化")
			return 1
		end
    --os.execute('mkdir mimoio/机器授权')
	    os.execute('mkdir mimoio')
		os.execute('mkdir mimoio/复读机')
		os.execute('mkdir mimoio/复读机/次数')
		os.execute('mkdir mimoio/复读机/内容')
		os.execute('mkdir mimoio/机器授权')
		os.execute('mkdir mimoio/机器配置')
		os.execute('mkdir mimoio/机器配置/机器主人')
		os.execute('mkdir mimoio/机器配置/机器聊天')
		os.execute('mkdir mimoio/机器调教')
		os.execute('mkdir mimoio/状态数据')
		os.execute('mkdir mimoio/状态数据/抢红包')
		os.execute('mkdir mimoio/状态数据/机器聊天')
		os.execute('mkdir mimoio/状态数据/机器开关')
		os.execute('mkdir mimoio/状态数据/撤回检测')
		os.execute('mkdir mimoio/状态数据/图片解析')
		os.execute('mkdir mimoio/状态数据/视频解析')
		os.execute('mkdir mimoio/状态数据/闪照检测')
		Wirte("mimoio\/"..data.FromUin..".txt","999")
		sendfrimsg(CurrentQQ,data,"初始化完毕！\n发送[使用方法]了解使用吧")
	end
	--添加授权者操作(私聊机器人发送)
	if (string.find(data.Content, "^添加授权者")) then
	    msg = data.Content:gsub("添加授权者", "")
		--Wirte("mimoio\/状态数据\/抢红包\/"..data.FromUin..".txt","关闭")
		root = Read("mimoio\/"..data.FromUin..".txt")
	    if (root == nil) then
		    sendfrimsg(CurrentQQ,data,"∴你不是我的管理者")
			return 1
		end
		Wirte("mimoio\/机器授权\/"..msg..CurrentQQ..".txt","999")
		sendfrimsg(CurrentQQ,data,"∴添加授权者成功")
	end
	--删除授权者操作(私聊机器人发送)
	if (string.find(data.Content, "^删除授权者")) then
	    msg = data.Content:gsub("删除授权者", "")
		--Wirte("mimoio\/状态数据\/抢红包\/"..data.FromUin..".txt","关闭")
		root = Read("mimoio\/"..data.FromUin..".txt")
	    if (root == nil) then
		    sendfrimsg(CurrentQQ,data,"∴你不是我的管理者")
			return 1
		end
		os.remove("mimoio\/机器授权\/"..msg..CurrentQQ..".txt")
		sendfrimsg(CurrentQQ,data,"∴删除授权者成功")
	end
    return 1
end
function ReceiveGroupMsg(CurrentQQ, data)
    if (tostring(data.FromUserId) == CurrentQQ) then
	    return 1
	end
	--群聊授权(到需要授权的群里操作)
	if (string.find(data.Content, "^授权")) then
	    root = Read("mimoio\/机器授权\/"..data.FromUserId..CurrentQQ..".txt","999")
		if (root == nil) then
		    sedmsg(CurrentQQ,data,"∴你不是我的授权者")
			return 1
		end
		msg = data.Content:gsub("授权", "")
		os.execute('mkdir mimoio/机器调教/'..data.FromGroupId)
		os.execute('mkdir mimoio/机器配置/机器主人/'..data.FromGroupId)
		Wirte("mimoio\/机器配置\/机器主人\/"..data.FromGroupId.."\/"..msg..".txt","999")
		Wirte("mimoio\/状态数据\/抢红包\/"..data.FromGroupId..".txt","关闭")
		Wirte("mimoio\/状态数据\/机器聊天\/"..data.FromGroupId..".txt","关闭")
		Wirte("mimoio\/状态数据\/撤回检测\/"..data.FromGroupId..".txt","关闭")
		Wirte("mimoio\/状态数据\/视频解析\/"..data.FromGroupId..".txt","关闭")
		Wirte("mimoio\/状态数据\/闪照检测\/"..data.FromGroupId..".txt","关闭")
		Wirte("mimoio\/状态数据\/图片解析\/"..data.FromGroupId..".txt","关闭")
		Wirte("mimoio\/机器配置\/机器聊天\/"..data.FromGroupId..".txt","回复聊天")
		sedmsg(CurrentQQ,data,"∴授权成功！\n发送[开启机器人]使用吧")
	end
	--删除授权操作(到需要删除授权的群里操作)
	if (string.find(data.Content, "^删除授权")) then
	    root = Read("mimoio\/机器授权\/"..data.FromUserId..CurrentQQ..".txt","999")
		if (root == nil) then
		    sedmsg(CurrentQQ,data,"∴你不是我的授权者")
			return 1
		end
		msg = data.Content:gsub("删除授权", "")
		os.remove("mimoio\/机器配置\/机器主人\/"..data.FromGroupId.."\/"..msg..".txt")
		os.remove("mimoio\/状态数据\/机器开关\/"..data.FromGroupId..CurrentQQ..".txt")
		sedmsg(CurrentQQ,data,"∴删除授权成功！")
	end
	--机器开关指令
	if (data.Content == "开启机器人" or data.Content == "关闭机器人") then
        mim = Read("mimoio\/机器配置\/机器主人\/"..data.FromGroupId.."\/"..data.FromUserId..".txt")
        if (mim ~= nil) then
            msg = data.Content:gsub("机器人", "")
            str = Read("mimoio\/状态数据\/机器开关\/"..data.FromGroupId..CurrentQQ..".txt")
			if (str == nil) then
			    Wirte("mimoio\/状态数据\/机器开关\/"..data.FromGroupId..CurrentQQ..".txt",msg)
                sedmsg(CurrentQQ,data,"∴机器人"..msg.."成功！")
				log.info("Str ====> %s", str)
                return 1
			end
			
            if (string.find(str, msg)) then
                sedmsg(CurrentQQ,data,"∴机器一直是"..msg.."的呐")
                return 1
            end
            Wirte("mimoio\/状态数据\/机器开关\/"..data.FromGroupId..CurrentQQ..".txt",msg)
            sedmsg(CurrentQQ,data,"∴机器人"..msg.."成功！")
            return 1
        else
            sedmsg(CurrentQQ,data,"∴你不是我主人呐")
            return 1
        end
	end
    --机器人开启检测
    str = Read("mimoio\/状态数据\/机器开关\/"..data.FromGroupId..CurrentQQ..".txt")
	if (str == nil) then
	    log.info("Str ====> %s", str)
        return 1
	end
	if (string.find(str, "关闭")) then
	    return 1
	end
	--at消息处理
	msgs = ""
	atqq = 0
	if (string.find(data.Content, "AT消息")) then
	    msgs = json.decode(data.Content).Content
		atqq = json.decode(data.Content).UserID
	end
	--尾巴自定义(待完善)
	tips = "——凤飞翱翔兮丷"
    --功能模块
    if (data.Content == "功能" or data.Content == "主界面") then
        face = faceArray()
        sedimgmsg(CurrentQQ,data,"http://q1.qlogo.cn/g?b=qq&nk="..data.FromUserId.."&s=640",face.."影视搜索\n"..face.."聊天娱乐\n"..face.."便利功能\n"..face.."机器调教\n"..face.."管理系统\n"..face.."bug反馈\n"..face.."本群状态\n"..face.."更新检测\n\n"..tips)
    end
    --影视搜索模块
    if (data.Content == "影视搜索") then
        face = faceArray()
		sedimgmsg(CurrentQQ,data,"http://q1.qlogo.cn/g?b=qq&nk="..data.FromUserId.."&s=640",face.."搜索+影视名\n"..face.."我想看+影视名\n"..face.."我要看+影视名\n\n"..tips)
    elseif (string.find(data.Content, "^搜索")) then
	    msg = data.Content:gsub("搜索", "")
		Sousuo(CurrentQQ,data,msg)
	elseif (string.find(data.Content, "^我想看")) then
	    msg = data.Content:gsub("我想看", "")
		Sousuo(CurrentQQ,data,msg)
    elseif (string.find(data.Content, "^我要看")) then
	    msg = data.Content:gsub("我要看", "")
		Sousuo(CurrentQQ,data,msg)
	end
	--聊天娱乐模块
	if (data.Content == "聊天娱乐") then
        face = faceArray()
		sedimgmsg(CurrentQQ,data,"http://q1.qlogo.cn/g?b=qq&nk="..data.FromUserId.."&s=640",face.."切换文字聊天\n"..face.."切换回复聊天\n"..face.."切换语音聊天\n\n"..tips)
    elseif (data.Content == "切换文字聊天") then
		liaotian(CurrentQQ,data,1)
	elseif (data.Content == "切换语音聊天") then
	    liaotian(CurrentQQ,data,2)
    elseif (data.Content == "切换回复聊天") then
	    liaotian(CurrentQQ,data,3)
	else
	    ownthink(CurrentQQ,data,msgs,atqq)
	end
	--便利功能模块
	if (data.Content == "便利功能") then
        face = faceArray()
		sedimgmsg(CurrentQQ,data,"http://q1.qlogo.cn/g?b=qq&nk="..data.FromUserId.."&s=640",face.."百科大全\n"..face.."音乐点歌\n"..face.."闪他@xx\n"..face.."天气查询\n\n"..tips)
	elseif (data.Content == "百科大全") then
		sedmsg(CurrentQQ,data,"发送:[百科+关键词]\n例如:百科洛天依")
    elseif (data.Content == "音乐点歌") then
		sedmsg(CurrentQQ,data,"发送:[点歌+歌名]\n例如:点歌青柠")
	elseif (data.Content == "天气查询") then
		sedmsg(CurrentQQ,data,"发送:[天气+地方名]\n例如:天气北京(限于国内)")
    elseif (string.find(data.Content, "^天气")) then
        tianqi(CurrentQQ,data)
	    --msg = data.Content:gsub("搜索", "")
		--Sousuo(CurrentQQ,data,msg)
	elseif (string.find(data.Content, "^百科")) then
	    baike(CurrentQQ,data)
	    --msg = data.Content:gsub("我想看", "")
		--Sousuo(CurrentQQ,data,msg)music(CurrentQQ,data)
    elseif (string.find(data.Content, "^点歌")) then
	    music(CurrentQQ,data)
	end
	--机器调教模块
	if (data.Content == "机器调教") then
        face = faceArray()
		sedimgmsg(CurrentQQ,data,"http://q1.qlogo.cn/g?b=qq&nk="..data.FromUserId.."&s=640",face.."文字调教\n"..face.."语音调教\n"..face.."唱歌调教\n"..face.."音乐调教\n"..face.."图片调教\n"..face.."删除调教\n\n"..tips)
    elseif (data.Content == "文字调教") then
		sedmsg(CurrentQQ,data,"发送[调教(指令)#(内容)]\n例如:调教你好#你好啊")
	elseif (data.Content == "语音调教") then
		sedmsg(CurrentQQ,data,"发送[调教(指令)#语音(内容)]\n例如:调教你好#语音你好啊")
	elseif (data.Content == "图片调教") then
		sedmsg(CurrentQQ,data,"发送[调教(指令)#图片(链接)]\n例如:调教你好#图片http://../1.jpg")
	elseif (data.Content == "音乐调教") then
		sedmsg(CurrentQQ,data,"发送[调教(指令)#点歌(歌名)]\n例如:调教喵#点歌学猫叫")
	elseif (data.Content == "唱歌调教") then
		sedmsg(CurrentQQ,data,"发送[调教(指令)#唱歌(歌名)]\n例如:调教喵#唱歌学猫叫")
	elseif (data.Content == "删除调教") then
		sedmsg(CurrentQQ,data,"发送[删除调教(指令)]\n例如:删除调教你好")
	elseif (string.find(data.Content, "^调教")) then
        tiaojiao(CurrentQQ,data)
	elseif (string.find(data.Content, "^删除调教")) then
        tiaojiao(CurrentQQ,data)
	end
	--管理系统模块
	if (data.Content == "管理系统") then
        face = faceArray()
		sedimgmsg(CurrentQQ,data,"http://q1.qlogo.cn/g?b=qq&nk="..data.FromUserId.."&s=640",face.."开启/关闭机器人\n"..face.."开启/关闭抢红包\n"..face.."开启/关闭机器聊天\n"..face.."开启/关闭闪照检测\n"..face.."开启/关闭图片解析\n"..face.."开启/关闭视频解析\n"..face.."开启/关闭撤回检测\n\n"..tips)
    elseif (data.Content == "开启机器聊天" or data.Content == "关闭机器聊天") then
        adminio(CurrentQQ,data,"机器聊天")
    elseif (data.Content == "开启撤回检测" or data.Content == "关闭撤回检测") then
        adminio(CurrentQQ,data,"撤回检测")
	elseif (data.Content == "开启闪照检测" or data.Content == "关闭闪照检测") then
        adminio(CurrentQQ,data,"闪照检测")
	elseif (data.Content == "开启抢红包" or data.Content == "关闭抢红包") then
        adminio(CurrentQQ,data,"抢红包")
	elseif (data.Content == "开启视频解析" or data.Content == "关闭视频解析") then
        adminio(CurrentQQ,data,"视频解析")
	elseif (data.Content == "开启图片解析" or data.Content == "关闭图片解析") then
        adminio(CurrentQQ,data,"图片解析")
	end
	--bug反馈模块
	if (data.Content == "BUG反馈" or data.Content == "bug反馈") then
        face = faceArray()
		sedimgmsg(CurrentQQ,data,"http://q1.qlogo.cn/g?b=qq&nk="..data.FromUserId.."&s=640",face.."邮件反馈\n"..face.."QQ反馈\n\n"..tips)
    elseif (data.Content == "QQ反馈") then
        sedmsg(CurrentQQ,data,"???Σ(ﾟ∀ﾟﾉ)ﾉ\n插件有问题可以反馈到:\nQQ:2353065854")
    elseif (data.Content == "邮件反馈") then
        sedmsg(CurrentQQ,data,"宝贝咋啦=͟͟͞͞(꒪ᗜ꒪ ‧̣̥̇)\n插件有问题可以反馈到:\n邮箱📬:ym-o@qq.com")
	end
	--本群状态模板
	if (data.Content == "本群状态") then
        face = faceArray()
        hb = Read("mimoio\/状态数据\/抢红包\/"..data.FromGroupId..".txt")
        sz = Read("mimoio\/状态数据\/闪照检测\/"..data.FromGroupId..".txt")
		tp = Read("mimoio\/状态数据\/图片解析\/"..data.FromGroupId..".txt")
        sp = Read("mimoio\/状态数据\/视频解析\/"..data.FromGroupId..".txt")
        jqr = Read("mimoio\/状态数据\/机器开关\/"..data.FromGroupId..CurrentQQ..".txt")
        lt = Read("mimoio\/状态数据\/机器聊天\/"..data.FromGroupId..".txt")
        ch = Read("mimoio\/状态数据\/撤回检测\/"..data.FromGroupId..".txt")
		sedmsg(CurrentQQ,data,"状态数据列表↓↓↓\n"..face.."机器人:"..jqr.."\n"..face.."抢红包:"..hb.."\n"..face.."图片解析:"..tp.."\n"..face.."撤回检测:"..ch.."\n"..face.."视频解析:"..sp.."\n"..face.."机器聊天:"..lt.."\n"..face.."闪照检测:"..sz.."\n\n"..tips)
	end
	--更新模块
	if (data.Content == "更新检测") then
        str = geturl("GET","http://118.25.41.32/Lsb/lua/Vabr.txt","")
		log.info("Str ====> %s", str)
        if (string.find(str, Vabr)) then
            sedmsg(CurrentQQ,data,"当前版本为最新版")
        else
            sedmsg(CurrentQQ,data,"发现新版本!\n当前版本:"..Vabr.."\n新版本号:"..str.."\n赶快发送[更新插件]吧")
        end
	elseif (data.Content == "更新插件") then
	    mim = Read("mimoio\/机器配置\/机器主人\/"..data.FromGroupId.."\/"..data.FromUserId..".txt")
        if (mim == nil) then
            sedmsg(CurrentQQ,data,"∴你不是我主人呐")
            return 1
        end
        str = geturl("GET","http://118.25.41.32/Lsb/lua/Vabr.txt","")
		log.info("Str ====> %s", str)
        if (string.find(str, Vabr)) then
            sedmsg(CurrentQQ,data,"当前版本为最新版")
        else
            str = geturl("GET","http://118.25.41.32/Lsb/lua/mimoio.txt","")
            Wirte("Plugins\/mimoio.lua",str)
            sedmsg(CurrentQQ,data,"更新完毕！")
        end
	end
	--图片类型消息处理
    if (data.MsgType == "PicMsg") then
	    msg = Read("mimoio\/状态数据\/图片解析\/"..data.FromGroupId..".txt")
		jData = json.decode(data.Content)
	    if (msg ~= nil and jData.tips ~= "[群消息-QQ闪照]") then
            if (string.find(str, "开启")) then
	            sedmsg(CurrentQQ,data,"图片链接解析如下↓↓\n"..jData.url)
				return 1
	        end
	    end
	    --开关判断模块
	    str = Read("mimoio\/状态数据\/闪照检测\/"..data.FromGroupId..".txt")
	    if (str == nil) then
            return 1
	    end
	    if (string.find(str, "关闭")) then
	        return 1
	    end
	    --闪照、图片处理模块
		PicFlag(CurrentQQ, data)
    end
	--抢红包处理
	if (string.find(data.MsgType, "RedBagMsg") == 1) then
	    --开关判断模块
	    str = Read("mimoio\/状态数据\/抢红包\/"..data.FromGroupId..".txt")
		if (str == nil) then
	        log.info("Str ====> %s", str)
            return 1
	    end
	    if (string.find(str, "关闭")) then
	        return 1
	    end
	    RedBag(CurrentQQ, data)
	end
	--视频解析处理
	if (string.find(data.MsgType, "VideoMsg") == 1) then
	    --开关判断模块
	    str = Read("mimoio\/状态数据\/视频解析\/"..data.FromGroupId..".txt")
		if (str == nil) then
	        log.info("Str ====> %s", str)
            return 1
	    end
	    if (string.find(str, "关闭")) then
	        return 1
	    end
	    Video(CurrentQQ, data)
	end
	--at闪图
	if (data.MsgType == "AtMsg") and (string.find(data.Content, "闪他")) then
	    shantu(CurrentQQ, data)
    end
	--调教搜索引擎
	mim = Read("mimoio\/机器调教\/"..data.FromGroupId.."\/"..data.Content..".txt")
	if (mim == nil) then
	    --人类的本质是复读机
	    msg = Read("mimoio\/复读机\/内容\/"..data.FromGroupId..".txt")
		if (msg ~= nil) then
		    cs = Read("mimoio\/复读机\/次数\/"..data.FromGroupId..".txt")
			ii = tonumber(cs)
			if (string.find(msg, "^"..data.Content.."$")) then
			    if (ii > 2) then
			         math.randomseed(os.time())
                     sj = math.random(1, 5)
		             if (sj == 1 or sj == 2) then
			             sedmsg(CurrentQQ,data,msg)
					     rr = ii + 1
		                 Wirte("mimoio\/复读机\/次数\/"..data.FromGroupId..".txt",tostring(rr))
				     elseif (sj == 3) then
				         os.remove("mimoio\/复读机\/次数\/"..data.FromGroupId..".txt")
					     os.remove("mimoio\/复读机\/内容\/"..data.FromGroupId..".txt")
					     fdArray = {"突然截断复读(ﾟ⊿ﾟ)ﾂ","复读可耻(•̀へ •́ ╮ )","不要复读了啦","这就是所谓的人类的本质","你们咋不上天呐","又复读上瘾了啊"}
                         math.randomseed(os.time())
                         fdsj = math.random(1, 6)
				         sedmsg(CurrentQQ,data,fdArray[fdsj])
				     else
			             rr = ii + 1
		                 Wirte("mimoio\/复读机\/次数\/"..data.FromGroupId..".txt",tostring(rr))
		             end
			    else
			        rr = ii + 1
		            Wirte("mimoio\/复读机\/次数\/"..data.FromGroupId..".txt",tostring(rr))
			    end
			else
			    if (ii > 2) then
			        math.randomseed(os.time())
                    sj2 = math.random(1, 3)
					if (sj2 == 2) then
					    fdArray2 = {"中断复读可耻","打断复读可耻(•̀へ •́ ╮ )","你为什么要打断复读啊","复读不香嘛","破坏氛围(งᵒ̌皿ᵒ̌)ง⁼³₌₃"}
                        math.randomseed(os.time())
                        fdsj2 = math.random(1, 5)
				        sedmsg(CurrentQQ,data,fdArray2[fdsj2])
					end
				end
				Wirte("mimoio\/复读机\/次数\/"..data.FromGroupId..".txt","1")
			    Wirte("mimoio\/复读机\/内容\/"..data.FromGroupId..".txt",data.Content)
			end
		else
		    Wirte("mimoio\/复读机\/次数\/"..data.FromGroupId..".txt","1")
			Wirte("mimoio\/复读机\/内容\/"..data.FromGroupId..".txt",data.Content)
		end
	    --如果调教指令不存在，则进行其他操作
	    msgsql(CurrentQQ,data)--数据储蓄
		--随机回复消息概率0.04
	    math.randomseed(os.time())
        num = math.random(1, 40)
		if (num == 12) then
		    j = xiaosiapi(CurrentQQ,data,data.Content)
			sedmsg(CurrentQQ,data,j.data.info.text)
		end
	else
	    --触发调教指令
		funic(CurrentQQ,data,mim)
	end
    return 1
end

function ReceiveEvents(CurrentQQ, data, extData)
  if data.MsgType == "ON_EVENT_GROUP_REVOKE" then --监听 群撤回事件
    --撤回事件处理
    str = Read("mimoio\/状态数据\/撤回检测\/"..extData.GroupID..".txt")
    if (str == nil) then
	    log.info("Str ====> %s", str)
        return 1
	end
	if (string.find(str, "关闭")) then
		return 1
	end
	CheHui(CurrentQQ, data, extData)
	--xxxxxxxxxxxxxxx
    return 1
  end
  --进群秀图欢迎
  if (string.find(data.MsgType, "ON_EVENT_GROUP_JOIN") == 1) then
      --机器人开启检测
    str = Read("mimoio\/状态数据\/机器开关\/"..data.FromUin..CurrentQQ..".txt")
	if (str == nil) then
	    log.info("Str ====> %s", str)
        return 1
	end
	if (string.find(str, "关闭")) then
	    return 1
	end
      xiutu(CurrentQQ, data, extData)
  end
end

--秀图函数
function xiutu(CurrentQQ, data, extData)
    math.randomseed(os.time())
    num = math.random(40001, 40002)
    Api.Api_SendMsg( --通过图片md5发送图片 秒发不用上传 相当于转发
           CurrentQQ,
           {
               toUser = data.FromUin,
               sendToType = 2,
               sendMsgType = "PicMsg",
               --发送图文消息
               content = string.format("[秀图%d]欢迎【%s】加入[PICFLAG]",40002,extData.UserName),
               --通过宏[PICFLAG]改变图文顺序  改为现文字后图片
               --通过宏[秀图40001] 范围 40000-40006 实现秀图发送 群有效好友无效
               atUser = 0,
               picUrl = "http://q1.qlogo.cn/g?b=qq&nk=".. extData.UserID .. "&s=640",
               pi机器人ase64Buf = "",
               fileMd5 = ""
           }
       )
end

--闪图检测处理
function shantu(CurrentQQ, data)
        math.randomseed(os.time())
        ShowType = math.random(40001, 40002)
        jData = json.decode(data.Content)
        Api.Api_SendMsg( --通过Url发送图片
            CurrentQQ,
            {
                toUser = data.FromGroupId,
                sendToType = 2,
                sendMsgType = "PicMsg",
                --发送图文消息
                content = string.format("[秀图%d]", ShowType),
                --通过宏[PICFLAG]改变图文顺序  改为现文字后图片
                --通过宏[秀图40001] 范围 40000-40005 实现秀图发送 群有效好友无效
                atUser = 0,
                voiceUrl = "",
                voiceBase64Buf = "",
                picUrl = "http://q1.qlogo.cn/g?b=qq&nk=" .. jData.UserID .. "&s=640",
                pi机器人ase64Buf = "",
                fileMd5 = ""
            }
        )
		return 1
end

--闪照检测处理
function PicFlag(CurrentQQ, data)
    jData = json.decode(data.Content)
		if (jData.tips == "[群消息-QQ闪照]") then
			Api.Api_SendMsg( --通过图片md5发送图片 秒发不用上传 相当于转发
                        CurrentQQ,
                        {
                            toUser = data.FromGroupId,
                            sendToType = 2,
                            sendMsgType = "PicMsg",
                            --发送图文消息
                            content = string.format(
                                "捕获到成员 %d\n═══════════\n闪照内容为:[PICFLAG]",
                                data.FromUserId
                            ),
                            --通过宏[PICFLAG]改变图文顺序  改为现文字后图片
                            atUser = 0,
                            voiceUrl = "",
                            voiceBase64Buf = "",
                            picUrl = "",
                            pi机器人ase64Buf = "",
                            fileMd5 = jData.FileMd5
                        }
                    )
             return 1
	    end
end

--功能组
function funic(CurrentQQ,data,msg)
    if string.find(msg, "^点歌") then
	    data.Content = msg
        music(CurrentQQ,data,msg)
		return 1
	elseif string.find(msg, "^语音") then
	    keyWord = msg:gsub("语音", "")
        sedvoicemsg(CurrentQQ,data,keyWord)
		return 1
	elseif string.find(msg, "^图片") then
	    keyWord = msg:gsub("图片", "")
        sedimgmsg(CurrentQQ,data,keyWord,"")
		return 1
    elseif string.find(msg, "^唱歌") then
        keyWord = msg:gsub("唱歌", "")
		if (keyWord == "") then
		    sedmsg(CurrentQQ,data,"歌名不能空着哦")
		    return 1
		end
		sedmsg(CurrentQQ,data,"天依正在努力加载٩(˃̶͈̀௰˂̶͈́)و")
        response, error_message =
            http.request(
            "POST",
            "http://127.0.0.1:8888/SilkApi/UrlToBuf",--修改此处ip及端口即可
            {
                body = keyWord --传入歌曲名
            }
        )
        log.notice("err   %v", error_message)
        html = response.body --返回silk base64 buf
		if (string.find(html, "δ")) then
				    sedmsg(CurrentQQ,data,"天依没有找到相关的歌呀(ÒωÓױ)！")
					c.close(c)
				    return 2
				end
        luaRes =
            Api.Api_SendMsg(
            CurrentQQ,
            {
                toUser = data.FromGroupId,
                sendToType = 2,
                sendMsgType = "VoiceMsg",
                groupid = 0,
                content = "",
                atUser = 0,
                voiceUrl = "",
                voiceBase64Buf = html 
            }
        )
		return 1
	end
    sedmsg(CurrentQQ,data,msg)
end

--影视搜索用
function Sousuo(CurrentQQ,data,msg)
    response, error_message =
        http.request(
            "GET",
            "http://localhost/index.php/ajax/suggest",
            {
                query = "mid=1&f=admin&wd="..msg.."&limit=10&timestamp=1567914326746"
            }
        )
    html = response.body
	json = json.decode(html)
	if (json.total == 0) then
	    sedmsg(CurrentQQ,data,"影视查询错误\n请检查影视名是否正确\n═══════════\n注意⚠️影视名不要带无关或多余的字符")
	else
        sedmsg(CurrentQQ,data,"资源地址如下↓↓↓\n══════════\nhttp://118.25.41.32/index.php/vod/search/wd/"..escape(msg)..".html\n═══════════\n注意:如果QQ出现停止访问现象，请复制链接用浏览器打开")
	end
end

--单纯发消息图文通用
function sedimgmsg(CurrentQQ,data,url,msg)
    ApiRet = Api.Api_SendMsg(
        CurrentQQ,
        {
        toUser = data.FromGroupId,
        sendToType = 2,
        sendMsgType = "PicMsg",
        groupid = 0,
        content = msg,
        pi机器人ase64Buf = "",
        --发本地送图片的buf 转 bas64 编码 文本型
        fileMd5 = "",
		picUrl = url,
        atUser = 0
        }
    )
	return ApiRet
end

--单纯发消息用
function sedmsg(CurrentQQ,data,msg)
    ApiRet = Api.Api_SendMsg(
        CurrentQQ,
        {
        toUser = data.FromGroupId,
        sendToType = 2,
        sendMsgType = "TextMsg",
        groupid = 0,
        content = msg,
        pi机器人ase64Buf = "",
        --发本地送图片的buf 转 bas64 编码 文本型
        fileMd5 = "",
		picUrl = "",
        atUser = 0
        }
    )
	return ApiRet
end

--单纯发私聊消息用
function sendfrimsg(CurrentQQ,data,msg)
    ApiRet = Api.Api_SendMsg(
        CurrentQQ,
        {
        toUser = data.FromUin,
        sendToType = 1,
        sendMsgType = "TextMsg",
        groupid = 0,
        content = msg,
        pi机器人ase64Buf = "",
        --发本地送图片的buf 转 bas64 编码 文本型
        fileMd5 = "",
		picUrl = "",
        atUser = 0
        }
    )
	return ApiRet
end

--单纯发json消息用
function sedjsonmsg(CurrentQQ,data,msg)
    ApiRet = Api.Api_SendMsg(
        CurrentQQ,
        {
        toUser = data.FromGroupId,
        sendToType = 2,
        sendMsgType = "JsonMsg",
        groupid = 0,
        content = msg,
        pi机器人ase64Buf = "",
        --发本地送图片的buf 转 bas64 编码 文本型
        fileMd5 = "",
		picUrl = "",
        atUser = 0
        }
    )
	return ApiRet
end

--聊天模块切换函数
function liaotian(CurrentQQ,data,msg)
    mim = Read("mimoio\/机器配置\/机器主人\/"..data.FromGroupId.."\/"..data.FromUserId..".txt")
    if (mim == nil) then
        sedmsg(CurrentQQ,data,"∴你不是我主人呐")
        return 1
    end
    str = Read("mimoio\/状态数据\/机器聊天\/"..data.FromGroupId..".txt")
	if (str == nil) then
        return 1
    end
	if (string.find(str, "关闭")) then
	    sedmsg(CurrentQQ,data,"机器聊天处于关闭状态\n∴请先开启机器聊天")
	    return 1
	end
	--切换处理
	file = io.open("mimoio\/机器配置\/机器聊天\/"..data.FromGroupId..".txt", "w")
	if (msg == 1) then
	    file:write("文字聊天")
	    sedmsg(CurrentQQ,data,"∴成功切换到文字聊天")
	elseif (msg == 2) then
	    file:write("语音聊天")
	    sedmsg(CurrentQQ,data,"∴成功切换到语音聊天")
	elseif (msg == 3) then
	    file:write("回复聊天")
	    sedmsg(CurrentQQ,data,"∴成功切换到回复聊天")
	end
	file:close()
end

--随机表情函数
function faceArray()
    faceArray = {"[表情147]","🍀","🔥","🍻","💎","[表情185]","[表情219]","[表情176]"}
    math.randomseed(os.time())
    num = math.random(1, 9)
    return faceArray[num]
end

--url编码转换
function escape(w)
	pattern="[^%w%d%._%-%* ]"
	s=string.gsub(w,pattern,function(c)
		local c=string.format("%%%02X",string.byte(c))
		return c
	end)
	s=string.gsub(s," ","+")
	return s
end

--读取数据函数
function Read(url)
    file = io.open(url, "r")
	if (file == nil) then
	    return nil
	else
        file:seek("set")
	    str = file:read("*a")
	    file:close()
        return str
	end
end

--写入数据函数
function Wirte(url,msg)
    file = io.open(url, "w+")
    file:write(msg)
	file:close()
    return "ok"
end

--小思聊天函数
function xiaosiapi(CurrentQQ,data,str)
    response, error_message =
            http.request(
            "GET",
            "https://api.ownthink.com/bot",
            {
                query = "appid="..tostring(data.FromUserId).."&spoken=" .. url_encode(str),
                headers = {
                    Accept = "*/*"
                }
            }
        )
        html = response.body
		jData = json.decode(html)
		return jData
end

--机器聊天函数
function ownthink(CurrentQQ,data,msgs,atqq)
    if (tostring(atqq) == CurrentQQ) then
        m = Read("mimoio\/状态数据\/机器聊天\/"..data.FromGroupId..".txt")
        if (m == nil) then
	        log.info("Str ====> %s", m)
            return 1
	    end
	    if (string.find(m, "关闭")) then
	        sedmsg(CurrentQQ,data,"机器聊天处于关闭状态\n∴请先开启机器聊天")
	        return 1
	    end
		res2 = string.find(msgs, " ")
		str = string.sub(msgs,res2)
		jData = xiaosiapi(CurrentQQ,data,str)
		Data = json.decode(data.Content)
		m = Read("mimoio\/机器配置\/机器聊天\/"..data.FromGroupId..".txt")
		if (m == nil) then
	        log.info("Str ====> %s", m)
            return 1
	    end
		if (string.find(m, "回复聊天")) then
		    Api.Api_SendMsg(
                CurrentQQ,
                {
                toUser = data.FromGroupId,
                sendToType = 2,
                sendMsgType = "ReplayMsg",
                groupid = 0,
                content = jData.data.info.text,
                atUser = 0,
				replayInfo = {
                    MsgSeq = data.MsgSeq,
                    --回复消息的Seq
                    MsgTime = data.MsgTime,
                    --回复消息的事件
                    UserID = data.FromUserId,
                    --回复消息对象
                    RawContent = Data.Content --回复消息的原内容
                }
				}
            )
			return 1
		elseif (string.find(m, "文字聊天")) then
		    sedmsg(CurrentQQ,data,jData.data.info.text)
		else
		    sedvoicemsg(CurrentQQ,data,url_encode(jData.data.info.text))
		end
    end
end

--发送语音消息
function sedvoicemsg(CurrentQQ,data,str)
    ApiRet = Api.Api_SendMsg(
        CurrentQQ,
        {
        toUser = data.FromGroupId,
        sendToType = 2,
        sendMsgType = "VoiceMsg",
        groupid = 0,
		voiceUrl = "https://dds.dui.ai/runtime/v1/synthesize?voiceId=qianranfa&speed=0.7&volume=100&audioType=wav&text="..str, --发送语音的网络地址 文本型
        voiceBase64Buf = "",
        content = "",
        atUser = 0
        }
    )
	return ApiRet
end

--天气查询函数
function tianqi(CurrentQQ,data)
    keyWord = data.Content:gsub("天气", "")
        if keyWord == "" then
            return 1
        end

        cookies = Api.Api_GetUserCook(CurrentQQ)

        response, error_message =
            http.request(
            "GET",
            "https://weather.mp.qq.com/cgi-bin/rich",
            {
                query = "g_tk=" .. cookies.Gtk .. "&city=" .. url_encode(keyWord),
                headers = {
                    Referer = "http://weather.mp.qq.com/ark"
                },
                cookies = {
                    uin = CurrentQQ,
                    skey = cookies.Skey
                }
            }
        )
        local html = response.body
        log.notice("From Lua html -->%s", html)

        local j = json.decode(html)
        if j.code ~= 0 then
            return 1
        end

        ApiRet =
            Api.Api_SendMsg(
            CurrentQQ,
            {
                toUser = data.FromGroupId,
                sendToType = 2,
                sendMsgType = "JsonMsg",
                groupid = 0,
                content = string.format(
                    --{"config":{"forward":1,"autosize":1},"prompt":"[应用]天气","app":"com.tencent.weather","ver":"0.0.0.1","view":"RichInfoView","meta":{"richinfo":{"adcode":"101210701","city":"成都","air":"58","min":"20","ts":"1500550866","wind":"1","date":"6月27日 周四","max":"28","type":"201"}},"desc":"天气"}
                    --[[{"app":"com.tencent.weather","desc":"","meta":{"weather":{"ad":[{"icon":"http://imgcache.qq.com/ac/tq/xz2/tp.jpg","p":"ptype=star","t":"2","title":"星座 | 今天会因为感情和家庭的问题，影响工作，还有，也要注意人...","url":""},{"icon":"http://imgcache.qq.com/ac/qqweather/image/2019/6/27.png","p":"ptype=lunar","t":"4","title":"黄历 | 农历五月廿五。宜订盟.纳采.出行.祈福.斋醮.安床.会...","url":""}],"info":{"it1":{"adcode":"101050101","city":"武汉","hour":"18","max":"29","min":"17","temp":"24","type":"202","ut":"1561630401","wea":"多云"},"it2":{"hour":"19","temp":"22","type":"202"},"it3":{"hour":"20","temp":"21","type":"202"},"ts":"1561631244"},"url":""}},"prompt":"【哈尔滨】多云 17°/29°, 18:13更新~","ver":"1.0.0.106","view":"WeatherThreeView"}]]
                    [[{"app":"com.tencent.weather","desc":"天气","view":"RichInfoView","ver":"1.0.0.217","prompt":"[应用]天气","meta":{"richinfo":{"adcode":"%s","air":"%s","city":"%s","date":"%s","max":"%s","min":"%s","ts":"1554951408","type":"%s","wind":"%s"}},"config":{"forward":1,"autosize":1,"type":"card"}}]],
                    j.data.adcode,
                    j.data.air,
                    j.data.city,
                    j.data.date,
                    j.data.max,
                    j.data.min,
                    j.data.type,
                    j.data.wind
                ),
                atUser = 0
            }
        )
end

--调教处理函数(待处理)
function tiaojiao(CurrentQQ,data)
    mim = Read("mimoio\/机器配置\/机器主人\/"..data.FromGroupId.."\/"..data.FromUserId..".txt")
	if (mim == nil) then
		sedmsg(CurrentQQ,data,"∴你不是我主人哇")
		return 1
	end
	if (string.find(data.Content, "^删除调教")) then
	    msg = data.Content:gsub("删除调教", "")
	    if (msg == "") then
		    sedmsg(CurrentQQ,data,"要删除的调教指令不能为空哦")
		    return 1
		end
		rese = Read("mimoio\/机器调教\/"..tostring(data.FromGroupId).."\/"..msg..".txt")
	    if (rese == nil) then
			sedmsg(CurrentQQ,data,"这个指令不存在了哦")
		    return 1
		end
		rm_file = os.remove("mimoio\/机器调教\/"..tostring(data.FromGroupId).."\/"..msg..".txt")
		log.info("删除调教 ====> %s", rm_file)
		sedmsg(CurrentQQ,data,"删除成功\n你不喜欢被这样调教的我吗[表情9]")
		return 1
	end
    msgs = data.Content:gsub("调教", "")
		res2 = string.find(msgs, "#")
		str = string.sub(msgs,res2+1)
		str2 = string.sub(msgs,1,res2-1)
		        
		        if (str == "") then
		            sedmsg(CurrentQQ,data,"调教的回答内容不能为空哦")
			        return 1
		        end
				if (str2 == "") then
		            sedmsg(CurrentQQ,data,"调教的指令内容不能为空哦")
			        return 1
		        end
		        rese = Read("mimoio\/机器调教\/"..data.FromGroupId.."\/"..str2..".txt")
					if (rese ~= nil) then
				        sedmsg(CurrentQQ,data,"指令已经存在了哦")
				        return 1
				    end
				Wirte("mimoio\/机器调教\/"..data.FromGroupId.."\/"..str2..".txt",str)
				sedmsg(CurrentQQ,data,"调教成功\n你还想再调教我一次吗[表情6]")
		        return 1
end

function url_encode(str)
    if (str) then
        str = string.gsub(str, "\n", "\r\n")
        str =
            string.gsub(
            str,
            "([^%w ])",
            function(c)
                return string.format("%%%02X", string.byte(c))
            end
        )
        str = string.gsub(str, " ", "+")
    end
    return str
end

--抢红包处理
function RedBag(CurrentQQ, data)
    Api.Api_OpenRedBag(CurrentQQ, data.RedBaginfo)
    if (data.RedBaginfo.RedType == 12) then
         luaRes =
                Api.Api_SendMsg(
                CurrentQQ,
                {
                    toUser = data.FromGroupId,
                    sendToType = 2,
                    sendMsgType = "TextMsg",
                    groupid = 0,
                    content = data.RedBaginfo.Tittle,
                    atUser = 0
                }
            )
        log.notice("From Lua SendMsg Ret\n%d", luaRes.Ret)
    end
end

--视频解析处理
function Video(CurrentQQ, data)
    vdata = json.decode(data.Content)
        videodata = {
            GroupID = data.FromGroupId,
            VideoUrl = vdata.VideoUrl,
            VideoMd5 = vdata.VideoMd5
        }
        --构造table 参数表
        luaResp = Api.Api_CallFunc(CurrentQQ, "PttCenterSvr.ShortVideoDownReq", videodata) --通过cmd调用功能包
        luaRes =
            Api.Api_SendMsg(
            CurrentQQ,
            {
                toUser = data.FromGroupId,
                sendToType = 2,
                sendMsgType = "TextMsg",
                groupid = 0,
                content = "解析视频URL-->" .. luaResp.VideoUrl,
                atUser = 0
            }
        )
end

--管理开关通用
function adminio(CurrentQQ,data,oio)
    mim = Read("mimoio\/机器配置\/机器主人\/"..data.FromGroupId.."\/"..data.FromUserId..".txt")
        if (mim ~= nil) then
            msg = data.Content:gsub(oio, "")
            str = Read("mimoio\/状态数据\/机器开关\/"..data.FromGroupId..CurrentQQ..".txt")
            if (string.find(str, "关闭")) then
                sedmsg(CurrentQQ,data,"∴机器人已被关闭...\n请先开启机器人")
                return 1
            end
			str2 = Read("mimoio\/状态数据\/"..oio.."\/"..data.FromGroupId..".txt")
			if (string.find(str2, msg)) then
			    sedmsg(CurrentQQ,data,"∴"..oio.."本就是"..str2.."状态")
                return 1
			end
            Wirte("mimoio\/状态数据\/"..oio.."\/"..data.FromGroupId..".txt",msg)
            sedmsg(CurrentQQ,data,"∴"..oio..msg.."成功")
            return 1
        else
            sedmsg(CurrentQQ,data,"∴你不是我主人呐")
            return 1
        end
end

--百科大全
function baike(CurrentQQ,data)
    keyWord = data.Content:gsub("百科", "")
        if keyWord == "" then
            return 1
        end
        response, error_message =
            http.request(
            "GET",
            "http://baike.baidu.com/api/openapi/BaikeLemmaCardApi",
            {
                query = "scope=103&format=json&appid=379020&bk_key=" .. url_encode(keyWord) .. "&bk_length=600"
            }
        )
        html = response.body
        while(string.find(html, '"errno":2')) do
            response, error_message =
            http.request(
            "GET",
            "http://baike.baidu.com/api/openapi/BaikeLemmaCardApi",
            {
                query = "scope=103&format=json&appid=379020&bk_key=" .. url_encode(keyWord) .. "&bk_length=600"
            })
			html = response.body
        end
        local j = json.decode(html)
        sedmsg(CurrentQQ,data,j.abstract.."\n"..j.url)
end

--音乐点歌
function music(CurrentQQ,data)
    keyWord = data.Content:gsub("点歌", "")
        if keyWord == "" then
            return 1
        end
        response, error_message =
            http.request(
            "GET",
            "https://c.y.qq.com/soso/fcgi-bin/client_search_cp",
            {
                query = "aggr=1&cr=1&flag_qc=0&p=1&n=6&w=" .. url_encode(keyWord)
            }
        )
        html = response.body
		str = string.sub(html,10,-2)
        j = json.decode(str)
        if (j.code == 0) then
            msg = ""
            num = j.data.song.list
            list = num[1]
            songname = list.songname
            singername = list.singer[1].name
            payplay = list.pay.payplay
			albummid = list.albummid
			songmid = list.songmid
	        sedjsonmsg(CurrentQQ,data,'{"app":"com.tencent.structmsg","desc":"音乐","view":"music","ver":"0.0.0.1","prompt":"[分享]' ..songname.. '","meta":{"music":{"sourceMsgId":"0","title":"' ..songname.. '","desc":"' ..singername.. '","preview":"y.gtimg.cn/music/photo_new/T002R150x150M000'..albummid..'.jpg","tag":"QQ音乐","musicUrl":"https://v1.itooi.cn/tencent/url?id='..songmid..'","jumpUrl":"y.qq.com/n/yqq/song/'..songmid..'.html","appid":100497308,"app_type":1,"action":"","source_url":"url.cn/5aSZ8Gc","source_icon":"url.cn/5tLgzTm","android_pkg_name":"com.tencent.qqmusic"}},"config":{"forward":true,"type":"normal","autosize":true}}')
			return 1
        else
            sedmsg(CurrentQQ,data,"∴Error:"..j.code)
			return 1
        end
end

--访问url
function geturl(url_class,url,caulrt)
        response, error_message =
            http.request(
            url_class,
            url,
            {
                query = caulrt
            }
        )
        html = response.body
		return html
end

--消息储蓄
function msgsql(CurrentQQ,data)
    if (mysqlpass == "") then
	    return 1
	end
    c = mysql.new()
    -- 初始化mysql对象
    ok, err = c:connect({host = mysqlhost, port = 3306, database = mysqldb, user = mysqluser, password = mysqlpass})
    --建立连接
    if ok then
        sqlstr =
            string.format(
            [[INSERT INTO msgcache (GroupID, MsgSeq, MsgRandom,MsgType,Data,MsgTime)VALUES (%d,%d,%d,'%s','%s',%d)]],
            data.FromGroupId,
            data.MsgSeq,
            data.MsgRandom,
            data.MsgType,
            data.Content,
            data.MsgTime
        )
        res, err = c:query(sqlstr) --入库缓存消息
        log.info("%s", err)
        c.close(c)
    --释放连接
    end
    return 1
end

--撤回检测
function CheHui(CurrentQQ, data, extData)
    c = mysql.new()
    -- 初始化mysql对象
	if (mysqlpass == "") then
	    return 1
	end
	
    if data.MsgType == "ON_EVENT_GROUP_REVOKE" then --监听 群撤回事件
        str = string.format("群成 %d  成员 UserID %s 撤回了消息Seq %s \n", extData.GroupID, extData.UserID, extData.MsgSeq)
        log.info("%s", str)
        ok, err = c:connect({host = mysqlhost, port = 3306, database = mysqldb, user = mysqluser, password = mysqlpass})
        --建立连接
        log.info("sql %v", err)
        if ok then
            sqlstr =
                string.format(
                "select * from msgcache where `GroupID`= %d and `MsgSeq` = %d",
                extData.GroupID,
                extData.MsgSeq
            )
            res, err = c:query(sqlstr) --跟群群id和消息SEQ查询出撤回的消息内容
            if err == nil then
                c.close(c)
                GroupID = tonumber(res[1]["GroupID"])
                MsgType = res[1]["MsgType"]
                Data = res[1]["Data"]

                if MsgType == "TextMsg" then
                    Api.Api_SendMsg(
                        CurrentQQ,
                        {
                            toUser = GroupID,
                            sendToType = 2,
                            sendMsgType = "TextMsg",
                            --发送文本消息
                            groupid = 0,
                            content = string.format(
                                "捕获到成员 %d\n═══════════\n撤回了一条文本消息\n消息内容为：\n%s",
                                extData.UserID,
                                Data
                            ),
                            atUser = 0
                        }
                    )
                end
                if MsgType == "SmallFaceMsg" then
                    --Data {"Content":"[表情101]","Hex":"FKY=","Index":101,"tips":"[小表情]"}
                    Api.Api_SendMsg(
                        CurrentQQ,
                        {
                            toUser = GroupID,
                            sendToType = 2,
                            sendMsgType = "TextMsg",
                            groupid = 0,
                            content = string.format(
                                "捕获到成员 %d\n═══════════\n撤回了一条表情消息\n消息内容为：\n%s",
                                extData.UserID,
                                json.decode(Data).Content
                            ),
                            atUser = 0
                        }
                    )
                end
                if MsgType == "PicMsg" then
                    --Data {"Content":"","FileId":2820717626,"FileMd5":"q0oEC5aloJJMFr10mplaXw==","FileSize":7026,"tips":"[群图片]","url":"http://gchat.qpic.cn/gchatpic_new/1700487478/960839480-2534335053-AB4A040B96A5A0924C16BD749A995A5F/0?vuin=u0026term=255u0026pictype=0"}
                    jData = json.decode(Data)
					if (jData.tips == "[群消息-QQ闪照]") then
					    
					Api.Api_SendMsg( 
                    CurrentQQ,
                    {
                        toUser = GroupID,
                        sendToType = 2,
                        sendMsgType = "ForwordMsg",
                        content = "",
                        atUser = 0,
                        groupid = 0,
                        voiceUrl = "",
                        voiceBase64Buf = "",
                        picUrl = "",
                        pi机器人ase64Buf = "",
                        forwordBuf = json.decode(Data).ForwordBuf, --欲转发的base64buf 图片消息 视频消息 会给出此参数
                        forwordField = json.decode(Data).ForwordField --欲写入协议的字段ID 图片消息 视频消息 会给出此参数
                    }
                )
				    return 1
					end
                    Api.Api_SendMsg( --通过图片md5发送图片 秒发不用上传 相当于转发
                        CurrentQQ,
                        {
                            toUser = GroupID,
                            sendToType = 2,
                            sendMsgType = "PicMsg",
                            --发送图文消息
                            content = string.format(
                                "捕获到成员 %d\n═══════════\n撤回了一条图片消息\n消息内容为：[PICFLAG]%s",
                                extData.UserID,
                                jData.Content
                            ),
                            --通过宏[PICFLAG]改变图文顺序  改为现文字后图片
                            atUser = 0,
                            voiceUrl = "",
                            voiceBase64Buf = "",
                            picUrl = "",
                            pi机器人ase64Buf = "",
                            fileMd5 = jData.FileMd5
                        }
                    )
                end
                if MsgType == "AtMsg" then
                    --Data {"Content":"@Kar98k skjjkssjkjs","UserID":123456789,"tips":"[AT消息]"}
                    Api.Api_SendMsg(
                        CurrentQQ,
                        {
                            toUser = GroupID,
                            sendToType = 2,
                            sendMsgType = "TextMsg",
                            groupid = 0,
                            content = string.format(
                                "捕获到成员 %d\n═══════════\n撤回了一条at消息\n消息内容为：\n%s",
                                extData.UserID,
                                json.decode(Data).Content
                            ),
                            atUser = 0
                        }
                    )
                end
                if MsgType == "VoiceMsg" then
                    --Data {"tips":"[语音]","url":"http://grouptalk.c2c.qq.com/?ver=0u0026rkey=3062020101045b305902010102010102041fdef8ae042439416931554e5142586c536d78706a314c686843664959725f327a5f573064697653755902045dac2a21041f0000000866696c6574797065000000013100000005636f64656300000001310400u0026filetype=1u0026voice_codec=1"}
                    --log.info("sql %s", json.decode(Data).url)
                    Api.Api_SendMsg(
                        CurrentQQ,
                        {
                            toUser = GroupID,
                            sendToType = 2,
                            sendMsgType = "VoiceMsg",
                            --发送群语音消息
                            groupid = 0,
                            content = "",
                            atUser = 0,
                            voiceUrl = json.decode(Data).url,
                            --通过网络url进行发送语音
                            voiceBase64Buf = "",
                            picUrl = "",
                            pi机器人ase64Buf = ""
                        }
                    )
                end

                if MsgType == "ReplayMsg" then
                    --Data {"MsgSeq":3536,"ReplayContent":"11 @Mac","SrcContent":"...","UserID":123123,"tips":"[回复]"}
                    --log.info("sql %s", json.decode(Data).url)
                    Api.Api_SendMsg(
                        CurrentQQ,
                        {
                            toUser = GroupID,
                            sendToType = 2,
                            sendMsgType = "TextMsg",
                            groupid = 0,
                            content = string.format(
                                "捕获到成员 %d\n═══════════\n撤回了一条回复消息\n消息内容为：\n%s",
                                extData.UserID,
                                json.decode(Data).ReplayContent
                            ),
                            atUser = 0
                        }
                    )
                end
				if MsgType == "VideoMsg" then
	             Api.Api_SendMsg( 
                    CurrentQQ,
                    {
                        toUser = GroupID,
                        sendToType = 2,
                        sendMsgType = "ForwordMsg",
                        content = "",
                        atUser = 0,
                        groupid = 0,
                        voiceUrl = "",
                        voiceBase64Buf = "",
                        picUrl = "",
                        pi机器人ase64Buf = "",
                        forwordBuf = json.decode(Data).ForwordBuf, --欲转发的base64buf 图片消息 视频消息 会给出此参数
                        forwordField = json.decode(Data).ForwordField --欲写入协议的字段ID 图片消息 视频消息 会给出此参数
                    }
                )
				end
                if MsgType == "XmlMsg" then
				    
                    --Data {"MsgSeq":3536,"ReplayContent":"11 @Mac","SrcContent":"...","UserID":123123,"tips":"[回复]"}
                    --log.info("sql %s", json.decode(Data).url)
                    Api.Api_SendMsg(
                        CurrentQQ,
                        {
                            toUser = GroupID,
                            sendToType = 2,
                            sendMsgType = "XmlMsg",
                            groupid = 0,
                            content = string.format("%s", Data),
                            atUser = 0
                        }
                    )
                end
				if MsgType == "JsonMsg" then
				    
                    --Data {"MsgSeq":3536,"ReplayContent":"11 @Mac","SrcContent":"...","UserID":123123,"tips":"[回复]"}
                    --log.info("sql %s", json.decode(Data).url)
                    Api.Api_SendMsg(
                        CurrentQQ,
                        {
                            toUser = GroupID,
                            sendToType = 2,
                            sendMsgType = "JsonMsg",
                            groupid = 0,
                            content = string.format("%s", Data),
                            atUser = 0
                        }
                    )
                end
            end
        end
    end
    return 1
end
2020/09/06 23:33:27.701 [E]  mimoio.lua
2020/09/06 23:33:27.701 [E]  local log = require("log")
local Api = require("coreApi")
local json = require("json")
local http = require("http")
local mysql = require("mysql")

--版本号(不要改动)
Vabr = "1.0.2"
--数据库配置
mysqlhost = "localhost"--默认不动
mysqldb = "ffaxx001"--数据库名
mysqluser = "ffaxx001"--数据库用户名
mysqlpass = "123456"--数据库密码
--不使用请不要改动

function ReceiveFriendMsg(CurrentQQ, data)
    if (data.Content == "使用方法") then
	    sendfrimsg(CurrentQQ,data,"添加授权者的方法\n对单个机器人私聊发送[添加授权者+授权者QQ]\n\n授权群的方法\n到需要授权的群里发送[授权+主人QQ]。注意:授权必须是授权者进行操作,管理员授权不了")
	end
    --数据初始化
    if (data.Content == "初始化") then
	    root = Read("mimoio\/"..data.FromUin..".txt")
	    if (root ~= nil) then
		    sendfrimsg(CurrentQQ,data,"∴请不要重复初始化")
			return 1
		end
    --os.execute('mkdir mimoio/机器授权')
	    os.execute('mkdir mimoio')
		os.execute('mkdir mimoio/复读机')
		os.execute('mkdir mimoio/复读机/次数')
		os.execute('mkdir mimoio/复读机/内容')
		os.execute('mkdir mimoio/机器授权')
		os.execute('mkdir mimoio/机器配置')
		os.execute('mkdir mimoio/机器配置/机器主人')
		os.execute('mkdir mimoio/机器配置/机器聊天')
		os.execute('mkdir mimoio/机器调教')
		os.execute('mkdir mimoio/状态数据')
		os.execute('mkdir mimoio/状态数据/抢红包')
		os.execute('mkdir mimoio/状态数据/机器聊天')
		os.execute('mkdir mimoio/状态数据/机器开关')
		os.execute('mkdir mimoio/状态数据/撤回检测')
		os.execute('mkdir mimoio/状态数据/图片解析')
		os.execute('mkdir mimoio/状态数据/视频解析')
		os.execute('mkdir mimoio/状态数据/闪照检测')
		Wirte("mimoio\/"..data.FromUin..".txt","999")
		sendfrimsg(CurrentQQ,data,"初始化完毕！\n发送[使用方法]了解使用吧")
	end
	--添加授权者操作(私聊机器人发送)
	if (string.find(data.Content, "^添加授权者")) then
	    msg = data.Content:gsub("添加授权者", "")
		--Wirte("mimoio\/状态数据\/抢红包\/"..data.FromUin..".txt","关闭")
		root = Read("mimoio\/"..data.FromUin..".txt")
	    if (root == nil) then
		    sendfrimsg(CurrentQQ,data,"∴你不是我的管理者")
			return 1
		end
		Wirte("mimoio\/机器授权\/"..msg..CurrentQQ..".txt","999")
		sendfrimsg(CurrentQQ,data,"∴添加授权者成功")
	end
	--删除授权者操作(私聊机器人发送)
	if (string.find(data.Content, "^删除授权者")) then
	    msg = data.Content:gsub("删除授权者", "")
		--Wirte("mimoio\/状态数据\/抢红包\/"..data.FromUin..".txt","关闭")
		root = Read("mimoio\/"..data.FromUin..".txt")
	    if (root == nil) then
		    sendfrimsg(CurrentQQ,data,"∴你不是我的管理者")
			return 1
		end
		os.remove("mimoio\/机器授权\/"..msg..CurrentQQ..".txt")
		sendfrimsg(CurrentQQ,data,"∴删除授权者成功")
	end
    return 1
end
function ReceiveGroupMsg(CurrentQQ, data)
    if (tostring(data.FromUserId) == CurrentQQ) then
	    return 1
	end
	--群聊授权(到需要授权的群里操作)
	if (string.find(data.Content, "^授权")) then
	    root = Read("mimoio\/机器授权\/"..data.FromUserId..CurrentQQ..".txt","999")
		if (root == nil) then
		    sedmsg(CurrentQQ,data,"∴你不是我的授权者")
			return 1
		end
		msg = data.Content:gsub("授权", "")
		os.execute('mkdir mimoio/机器调教/'..data.FromGroupId)
		os.execute('mkdir mimoio/机器配置/机器主人/'..data.FromGroupId)
		Wirte("mimoio\/机器配置\/机器主人\/"..data.FromGroupId.."\/"..msg..".txt","999")
		Wirte("mimoio\/状态数据\/抢红包\/"..data.FromGroupId..".txt","关闭")
		Wirte("mimoio\/状态数据\/机器聊天\/"..data.FromGroupId..".txt","关闭")
		Wirte("mimoio\/状态数据\/撤回检测\/"..data.FromGroupId..".txt","关闭")
		Wirte("mimoio\/状态数据\/视频解析\/"..data.FromGroupId..".txt","关闭")
		Wirte("mimoio\/状态数据\/闪照检测\/"..data.FromGroupId..".txt","关闭")
		Wirte("mimoio\/状态数据\/图片解析\/"..data.FromGroupId..".txt","关闭")
		Wirte("mimoio\/机器配置\/机器聊天\/"..data.FromGroupId..".txt","回复聊天")
		sedmsg(CurrentQQ,data,"∴授权成功！\n发送[开启机器人]使用吧")
	end
	--删除授权操作(到需要删除授权的群里操作)
	if (string.find(data.Content, "^删除授权")) then
	    root = Read("mimoio\/机器授权\/"..data.FromUserId..CurrentQQ..".txt","999")
		if (root == nil) then
		    sedmsg(CurrentQQ,data,"∴你不是我的授权者")
			return 1
		end
		msg = data.Content:gsub("删除授权", "")
		os.remove("mimoio\/机器配置\/机器主人\/"..data.FromGroupId.."\/"..msg..".txt")
		os.remove("mimoio\/状态数据\/机器开关\/"..data.FromGroupId..CurrentQQ..".txt")
		sedmsg(CurrentQQ,data,"∴删除授权成功！")
	end
	--机器开关指令
	if (data.Content == "开启机器人" or data.Content == "关闭机器人") then
        mim = Read("mimoio\/机器配置\/机器主人\/"..data.FromGroupId.."\/"..data.FromUserId..".txt")
        if (mim ~= nil) then
            msg = data.Content:gsub("机器人", "")
            str = Read("mimoio\/状态数据\/机器开关\/"..data.FromGroupId..CurrentQQ..".txt")
			if (str == nil) then
			    Wirte("mimoio\/状态数据\/机器开关\/"..data.FromGroupId..CurrentQQ..".txt",msg)
                sedmsg(CurrentQQ,data,"∴机器人"..msg.."成功！")
				log.info("Str ====> %s", str)
                return 1
			end
			
            if (string.find(str, msg)) then
                sedmsg(CurrentQQ,data,"∴机器一直是"..msg.."的呐")
                return 1
            end
            Wirte("mimoio\/状态数据\/机器开关\/"..data.FromGroupId..CurrentQQ..".txt",msg)
            sedmsg(CurrentQQ,data,"∴机器人"..msg.."成功！")
            return 1
        else
            sedmsg(CurrentQQ,data,"∴你不是我主人呐")
            return 1
        end
	end
    --机器人开启检测
    str = Read("mimoio\/状态数据\/机器开关\/"..data.FromGroupId..CurrentQQ..".txt")
	if (str == nil) then
	    log.info("Str ====> %s", str)
        return 1
	end
	if (string.find(str, "关闭")) then
	    return 1
	end
	--at消息处理
	msgs = ""
	atqq = 0
	if (string.find(data.Content, "AT消息")) then
	    msgs = json.decode(data.Content).Content
		atqq = json.decode(data.Content).UserID
	end
	--尾巴自定义(待完善)
	tips = "——凤飞翱翔兮丷"
    --功能模块
    if (data.Content == "功能" or data.Content == "主界面") then
        face = faceArray()
        sedimgmsg(CurrentQQ,data,"http://q1.qlogo.cn/g?b=qq&nk="..data.FromUserId.."&s=640",face.."影视搜索\n"..face.."聊天娱乐\n"..face.."便利功能\n"..face.."机器调教\n"..face.."管理系统\n"..face.."bug反馈\n"..face.."本群状态\n"..face.."更新检测\n\n"..tips)
    end
    --影视搜索模块
    if (data.Content == "影视搜索") then
        face = faceArray()
		sedimgmsg(CurrentQQ,data,"http://q1.qlogo.cn/g?b=qq&nk="..data.FromUserId.."&s=640",face.."搜索+影视名\n"..face.."我想看+影视名\n"..face.."我要看+影视名\n\n"..tips)
    elseif (string.find(data.Content, "^搜索")) then
	    msg = data.Content:gsub("搜索", "")
		Sousuo(CurrentQQ,data,msg)
	elseif (string.find(data.Content, "^我想看")) then
	    msg = data.Content:gsub("我想看", "")
		Sousuo(CurrentQQ,data,msg)
    elseif (string.find(data.Content, "^我要看")) then
	    msg = data.Content:gsub("我要看", "")
		Sousuo(CurrentQQ,data,msg)
	end
	--聊天娱乐模块
	if (data.Content == "聊天娱乐") then
        face = faceArray()
		sedimgmsg(CurrentQQ,data,"http://q1.qlogo.cn/g?b=qq&nk="..data.FromUserId.."&s=640",face.."切换文字聊天\n"..face.."切换回复聊天\n"..face.."切换语音聊天\n\n"..tips)
    elseif (data.Content == "切换文字聊天") then
		liaotian(CurrentQQ,data,1)
	elseif (data.Content == "切换语音聊天") then
	    liaotian(CurrentQQ,data,2)
    elseif (data.Content == "切换回复聊天") then
	    liaotian(CurrentQQ,data,3)
	else
	    ownthink(CurrentQQ,data,msgs,atqq)
	end
	--便利功能模块
	if (data.Content == "便利功能") then
        face = faceArray()
		sedimgmsg(CurrentQQ,data,"http://q1.qlogo.cn/g?b=qq&nk="..data.FromUserId.."&s=640",face.."百科大全\n"..face.."音乐点歌\n"..face.."闪他@xx\n"..face.."天气查询\n\n"..tips)
	elseif (data.Content == "百科大全") then
		sedmsg(CurrentQQ,data,"发送:[百科+关键词]\n例如:百科洛天依")
    elseif (data.Content == "音乐点歌") then
		sedmsg(CurrentQQ,data,"发送:[点歌+歌名]\n例如:点歌青柠")
	elseif (data.Content == "天气查询") then
		sedmsg(CurrentQQ,data,"发送:[天气+地方名]\n例如:天气北京(限于国内)")
    elseif (string.find(data.Content, "^天气")) then
        tianqi(CurrentQQ,data)
	    --msg = data.Content:gsub("搜索", "")
		--Sousuo(CurrentQQ,data,msg)
	elseif (string.find(data.Content, "^百科")) then
	    baike(CurrentQQ,data)
	    --msg = data.Content:gsub("我想看", "")
		--Sousuo(CurrentQQ,data,msg)music(CurrentQQ,data)
    elseif (string.find(data.Content, "^点歌")) then
	    music(CurrentQQ,data)
	end
	--机器调教模块
	if (data.Content == "机器调教") then
        face = faceArray()
		sedimgmsg(CurrentQQ,data,"http://q1.qlogo.cn/g?b=qq&nk="..data.FromUserId.."&s=640",face.."文字调教\n"..face.."语音调教\n"..face.."唱歌调教\n"..face.."音乐调教\n"..face.."图片调教\n"..face.."删除调教\n\n"..tips)
    elseif (data.Content == "文字调教") then
		sedmsg(CurrentQQ,data,"发送[调教(指令)#(内容)]\n例如:调教你好#你好啊")
	elseif (data.Content == "语音调教") then
		sedmsg(CurrentQQ,data,"发送[调教(指令)#语音(内容)]\n例如:调教你好#语音你好啊")
	elseif (data.Content == "图片调教") then
		sedmsg(CurrentQQ,data,"发送[调教(指令)#图片(链接)]\n例如:调教你好#图片http://../1.jpg")
	elseif (data.Content == "音乐调教") then
		sedmsg(CurrentQQ,data,"发送[调教(指令)#点歌(歌名)]\n例如:调教喵#点歌学猫叫")
	elseif (data.Content == "唱歌调教") then
		sedmsg(CurrentQQ,data,"发送[调教(指令)#唱歌(歌名)]\n例如:调教喵#唱歌学猫叫")
	elseif (data.Content == "删除调教") then
		sedmsg(CurrentQQ,data,"发送[删除调教(指令)]\n例如:删除调教你好")
	elseif (string.find(data.Content, "^调教")) then
        tiaojiao(CurrentQQ,data)
	elseif (string.find(data.Content, "^删除调教")) then
        tiaojiao(CurrentQQ,data)
	end
	--管理系统模块
	if (data.Content == "管理系统") then
        face = faceArray()
		sedimgmsg(CurrentQQ,data,"http://q1.qlogo.cn/g?b=qq&nk="..data.FromUserId.."&s=640",face.."开启/关闭机器人\n"..face.."开启/关闭抢红包\n"..face.."开启/关闭机器聊天\n"..face.."开启/关闭闪照检测\n"..face.."开启/关闭图片解析\n"..face.."开启/关闭视频解析\n"..face.."开启/关闭撤回检测\n\n"..tips)
    elseif (data.Content == "开启机器聊天" or data.Content == "关闭机器聊天") then
        adminio(CurrentQQ,data,"机器聊天")
    elseif (data.Content == "开启撤回检测" or data.Content == "关闭撤回检测") then
        adminio(CurrentQQ,data,"撤回检测")
	elseif (data.Content == "开启闪照检测" or data.Content == "关闭闪照检测") then
        adminio(CurrentQQ,data,"闪照检测")
	elseif (data.Content == "开启抢红包" or data.Content == "关闭抢红包") then
        adminio(CurrentQQ,data,"抢红包")
	elseif (data.Content == "开启视频解析" or data.Content == "关闭视频解析") then
        adminio(CurrentQQ,data,"视频解析")
	elseif (data.Content == "开启图片解析" or data.Content == "关闭图片解析") then
        adminio(CurrentQQ,data,"图片解析")
	end
	--bug反馈模块
	if (data.Content == "BUG反馈" or data.Content == "bug反馈") then
        face = faceArray()
		sedimgmsg(CurrentQQ,data,"http://q1.qlogo.cn/g?b=qq&nk="..data.FromUserId.."&s=640",face.."邮件反馈\n"..face.."QQ反馈\n\n"..tips)
    elseif (data.Content == "QQ反馈") then
        sedmsg(CurrentQQ,data,"???Σ(ﾟ∀ﾟﾉ)ﾉ\n插件有问题可以反馈到:\nQQ:2353065854")
    elseif (data.Content == "邮件反馈") then
        sedmsg(CurrentQQ,data,"宝贝咋啦=͟͟͞͞(꒪ᗜ꒪ ‧̣̥̇)\n插件有问题可以反馈到:\n邮箱📬:ym-o@qq.com")
	end
	--本群状态模板
	if (data.Content == "本群状态") then
        face = faceArray()
        hb = Read("mimoio\/状态数据\/抢红包\/"..data.FromGroupId..".txt")
        sz = Read("mimoio\/状态数据\/闪照检测\/"..data.FromGroupId..".txt")
		tp = Read("mimoio\/状态数据\/图片解析\/"..data.FromGroupId..".txt")
        sp = Read("mimoio\/状态数据\/视频解析\/"..data.FromGroupId..".txt")
        jqr = Read("mimoio\/状态数据\/机器开关\/"..data.FromGroupId..CurrentQQ..".txt")
        lt = Read("mimoio\/状态数据\/机器聊天\/"..data.FromGroupId..".txt")
        ch = Read("mimoio\/状态数据\/撤回检测\/"..data.FromGroupId..".txt")
		sedmsg(CurrentQQ,data,"状态数据列表↓↓↓\n"..face.."机器人:"..jqr.."\n"..face.."抢红包:"..hb.."\n"..face.."图片解析:"..tp.."\n"..face.."撤回检测:"..ch.."\n"..face.."视频解析:"..sp.."\n"..face.."机器聊天:"..lt.."\n"..face.."闪照检测:"..sz.."\n\n"..tips)
	end
	--更新模块
	if (data.Content == "更新检测") then
        str = geturl("GET","http://118.25.41.32/Lsb/lua/Vabr.txt","")
		log.info("Str ====> %s", str)
        if (string.find(str, Vabr)) then
            sedmsg(CurrentQQ,data,"当前版本为最新版")
        else
            sedmsg(CurrentQQ,data,"发现新版本!\n当前版本:"..Vabr.."\n新版本号:"..str.."\n赶快发送[更新插件]吧")
        end
	elseif (data.Content == "更新插件") then
	    mim = Read("mimoio\/机器配置\/机器主人\/"..data.FromGroupId.."\/"..data.FromUserId..".txt")
        if (mim == nil) then
            sedmsg(CurrentQQ,data,"∴你不是我主人呐")
            return 1
        end
        str = geturl("GET","http://118.25.41.32/Lsb/lua/Vabr.txt","")
		log.info("Str ====> %s", str)
        if (string.find(str, Vabr)) then
            sedmsg(CurrentQQ,data,"当前版本为最新版")
        else
            str = geturl("GET","http://118.25.41.32/Lsb/lua/mimoio.txt","")
            Wirte("Plugins\/mimoio.lua",str)
            sedmsg(CurrentQQ,data,"更新完毕！")
        end
	end
	--图片类型消息处理
    if (data.MsgType == "PicMsg") then
	    msg = Read("mimoio\/状态数据\/图片解析\/"..data.FromGroupId..".txt")
		jData = json.decode(data.Content)
	    if (msg ~= nil and jData.tips ~= "[群消息-QQ闪照]") then
            if (string.find(str, "开启")) then
	            sedmsg(CurrentQQ,data,"图片链接解析如下↓↓\n"..jData.url)
				return 1
	        end
	    end
	    --开关判断模块
	    str = Read("mimoio\/状态数据\/闪照检测\/"..data.FromGroupId..".txt")
	    if (str == nil) then
            return 1
	    end
	    if (string.find(str, "关闭")) then
	        return 1
	    end
	    --闪照、图片处理模块
		PicFlag(CurrentQQ, data)
    end
	--抢红包处理
	if (string.find(data.MsgType, "RedBagMsg") == 1) then
	    --开关判断模块
	    str = Read("mimoio\/状态数据\/抢红包\/"..data.FromGroupId..".txt")
		if (str == nil) then
	        log.info("Str ====> %s", str)
            return 1
	    end
	    if (string.find(str, "关闭")) then
	        return 1
	    end
	    RedBag(CurrentQQ, data)
	end
	--视频解析处理
	if (string.find(data.MsgType, "VideoMsg") == 1) then
	    --开关判断模块
	    str = Read("mimoio\/状态数据\/视频解析\/"..data.FromGroupId..".txt")
		if (str == nil) then
	        log.info("Str ====> %s", str)
            return 1
	    end
	    if (string.find(str, "关闭")) then
	        return 1
	    end
	    Video(CurrentQQ, data)
	end
	--at闪图
	if (data.MsgType == "AtMsg") and (string.find(data.Content, "闪他")) then
	    shantu(CurrentQQ, data)
    end
	--调教搜索引擎
	mim = Read("mimoio\/机器调教\/"..data.FromGroupId.."\/"..data.Content..".txt")
	if (mim == nil) then
	    --人类的本质是复读机
	    msg = Read("mimoio\/复读机\/内容\/"..data.FromGroupId..".txt")
		if (msg ~= nil) then
		    cs = Read("mimoio\/复读机\/次数\/"..data.FromGroupId..".txt")
			ii = tonumber(cs)
			if (string.find(msg, "^"..data.Content.."$")) then
			    if (ii > 2) then
			         math.randomseed(os.time())
                     sj = math.random(1, 5)
		             if (sj == 1 or sj == 2) then
			             sedmsg(CurrentQQ,data,msg)
					     rr = ii + 1
		                 Wirte("mimoio\/复读机\/次数\/"..data.FromGroupId..".txt",tostring(rr))
				     elseif (sj == 3) then
				         os.remove("mimoio\/复读机\/次数\/"..data.FromGroupId..".txt")
					     os.remove("mimoio\/复读机\/内容\/"..data.FromGroupId..".txt")
					     fdArray = {"突然截断复读(ﾟ⊿ﾟ)ﾂ","复读可耻(•̀へ •́ ╮ )","不要复读了啦","这就是所谓的人类的本质","你们咋不上天呐","又复读上瘾了啊"}
                         math.randomseed(os.time())
                         fdsj = math.random(1, 6)
				         sedmsg(CurrentQQ,data,fdArray[fdsj])
				     else
			             rr = ii + 1
		                 Wirte("mimoio\/复读机\/次数\/"..data.FromGroupId..".txt",tostring(rr))
		             end
			    else
			        rr = ii + 1
		            Wirte("mimoio\/复读机\/次数\/"..data.FromGroupId..".txt",tostring(rr))
			    end
			else
			    if (ii > 2) then
			        math.randomseed(os.time())
                    sj2 = math.random(1, 3)
					if (sj2 == 2) then
					    fdArray2 = {"中断复读可耻","打断复读可耻(•̀へ •́ ╮ )","你为什么要打断复读啊","复读不香嘛","破坏氛围(งᵒ̌皿ᵒ̌)ง⁼³₌₃"}
                        math.randomseed(os.time())
                        fdsj2 = math.random(1, 5)
				        sedmsg(CurrentQQ,data,fdArray2[fdsj2])
					end
				end
				Wirte("mimoio\/复读机\/次数\/"..data.FromGroupId..".txt","1")
			    Wirte("mimoio\/复读机\/内容\/"..data.FromGroupId..".txt",data.Content)
			end
		else
		    Wirte("mimoio\/复读机\/次数\/"..data.FromGroupId..".txt","1")
			Wirte("mimoio\/复读机\/内容\/"..data.FromGroupId..".txt",data.Content)
		end
	    --如果调教指令不存在，则进行其他操作
	    msgsql(CurrentQQ,data)--数据储蓄
		--随机回复消息概率0.04
	    math.randomseed(os.time())
        num = math.random(1, 40)
		if (num == 12) then
		    j = xiaosiapi(CurrentQQ,data,data.Content)
			sedmsg(CurrentQQ,data,j.data.info.text)
		end
	else
	    --触发调教指令
		funic(CurrentQQ,data,mim)
	end
    return 1
end

function ReceiveEvents(CurrentQQ, data, extData)
  if data.MsgType == "ON_EVENT_GROUP_REVOKE" then --监听 群撤回事件
    --撤回事件处理
    str = Read("mimoio\/状态数据\/撤回检测\/"..extData.GroupID..".txt")
    if (str == nil) then
	    log.info("Str ====> %s", str)
        return 1
	end
	if (string.find(str, "关闭")) then
		return 1
	end
	CheHui(CurrentQQ, data, extData)
	--xxxxxxxxxxxxxxx
    return 1
  end
  --进群秀图欢迎
  if (string.find(data.MsgType, "ON_EVENT_GROUP_JOIN") == 1) then
      --机器人开启检测
    str = Read("mimoio\/状态数据\/机器开关\/"..data.FromUin..CurrentQQ..".txt")
	if (str == nil) then
	    log.info("Str ====> %s", str)
        return 1
	end
	if (string.find(str, "关闭")) then
	    return 1
	end
      xiutu(CurrentQQ, data, extData)
  end
end

--秀图函数
function xiutu(CurrentQQ, data, extData)
    math.randomseed(os.time())
    num = math.random(40001, 40002)
    Api.Api_SendMsg( --通过图片md5发送图片 秒发不用上传 相当于转发
           CurrentQQ,
           {
               toUser = data.FromUin,
               sendToType = 2,
               sendMsgType = "PicMsg",
               --发送图文消息
               content = string.format("[秀图%d]欢迎【%s】加入[PICFLAG]",40002,extData.UserName),
               --通过宏[PICFLAG]改变图文顺序  改为现文字后图片
               --通过宏[秀图40001] 范围 40000-40006 实现秀图发送 群有效好友无效
               atUser = 0,
               picUrl = "http://q1.qlogo.cn/g?b=qq&nk=".. extData.UserID .. "&s=640",
               pi机器人ase64Buf = "",
               fileMd5 = ""
           }
       )
end

--闪图检测处理
function shantu(CurrentQQ, data)
        math.randomseed(os.time())
        ShowType = math.random(40001, 40002)
        jData = json.decode(data.Content)
        Api.Api_SendMsg( --通过Url发送图片
            CurrentQQ,
            {
                toUser = data.FromGroupId,
                sendToType = 2,
                sendMsgType = "PicMsg",
                --发送图文消息
                content = string.format("[秀图%d]", ShowType),
                --通过宏[PICFLAG]改变图文顺序  改为现文字后图片
                --通过宏[秀图40001] 范围 40000-40005 实现秀图发送 群有效好友无效
                atUser = 0,
                voiceUrl = "",
                voiceBase64Buf = "",
                picUrl = "http://q1.qlogo.cn/g?b=qq&nk=" .. jData.UserID .. "&s=640",
                pi机器人ase64Buf = "",
                fileMd5 = ""
            }
        )
		return 1
end

--闪照检测处理
function PicFlag(CurrentQQ, data)
    jData = json.decode(data.Content)
		if (jData.tips == "[群消息-QQ闪照]") then
			Api.Api_SendMsg( --通过图片md5发送图片 秒发不用上传 相当于转发
                        CurrentQQ,
                        {
                            toUser = data.FromGroupId,
                            sendToType = 2,
                            sendMsgType = "PicMsg",
                            --发送图文消息
                            content = string.format(
                                "捕获到成员 %d\n═══════════\n闪照内容为:[PICFLAG]",
                                data.FromUserId
                            ),
                            --通过宏[PICFLAG]改变图文顺序  改为现文字后图片
                            atUser = 0,
                            voiceUrl = "",
                            voiceBase64Buf = "",
                            picUrl = "",
                            pi机器人ase64Buf = "",
                            fileMd5 = jData.FileMd5
                        }
                    )
             return 1
	    end
end

--功能组
function funic(CurrentQQ,data,msg)
    if string.find(msg, "^点歌") then
	    data.Content = msg
        music(CurrentQQ,data,msg)
		return 1
	elseif string.find(msg, "^语音") then
	    keyWord = msg:gsub("语音", "")
        sedvoicemsg(CurrentQQ,data,keyWord)
		return 1
	elseif string.find(msg, "^图片") then
	    keyWord = msg:gsub("图片", "")
        sedimgmsg(CurrentQQ,data,keyWord,"")
		return 1
    elseif string.find(msg, "^唱歌") then
        keyWord = msg:gsub("唱歌", "")
		if (keyWord == "") then
		    sedmsg(CurrentQQ,data,"歌名不能空着哦")
		    return 1
		end
		sedmsg(CurrentQQ,data,"天依正在努力加载٩(˃̶͈̀௰˂̶͈́)و")
        response, error_message =
            http.request(
            "POST",
            "http://127.0.0.1:8888/SilkApi/UrlToBuf",--修改此处ip及端口即可
            {
                body = keyWord --传入歌曲名
            }
        )
        log.notice("err   %v", error_message)
        html = response.body --返回silk base64 buf
		if (string.find(html, "δ")) then
				    sedmsg(CurrentQQ,data,"天依没有找到相关的歌呀(ÒωÓױ)！")
					c.close(c)
				    return 2
				end
        luaRes =
            Api.Api_SendMsg(
            CurrentQQ,
            {
                toUser = data.FromGroupId,
                sendToType = 2,
                sendMsgType = "VoiceMsg",
                groupid = 0,
                content = "",
                atUser = 0,
                voiceUrl = "",
                voiceBase64Buf = html 
            }
        )
		return 1
	end
    sedmsg(CurrentQQ,data,msg)
end

--影视搜索用
function Sousuo(CurrentQQ,data,msg)
    response, error_message =
        http.request(
            "GET",
            "http://localhost/index.php/ajax/suggest",
            {
                query = "mid=1&f=admin&wd="..msg.."&limit=10&timestamp=1567914326746"
            }
        )
    html = response.body
	json = json.decode(html)
	if (json.total == 0) then
	    sedmsg(CurrentQQ,data,"影视查询错误\n请检查影视名是否正确\n═══════════\n注意⚠️影视名不要带无关或多余的字符")
	else
        sedmsg(CurrentQQ,data,"资源地址如下↓↓↓\n══════════\nhttp://118.25.41.32/index.php/vod/search/wd/"..escape(msg)..".html\n═══════════\n注意:如果QQ出现停止访问现象，请复制链接用浏览器打开")
	end
end

--单纯发消息图文通用
function sedimgmsg(CurrentQQ,data,url,msg)
    ApiRet = Api.Api_SendMsg(
        CurrentQQ,
        {
        toUser = data.FromGroupId,
        sendToType = 2,
        sendMsgType = "PicMsg",
        groupid = 0,
        content = msg,
        pi机器人ase64Buf = "",
        --发本地送图片的buf 转 bas64 编码 文本型
        fileMd5 = "",
		picUrl = url,
        atUser = 0
        }
    )
	return ApiRet
end

--单纯发消息用
function sedmsg(CurrentQQ,data,msg)
    ApiRet = Api.Api_SendMsg(
        CurrentQQ,
        {
        toUser = data.FromGroupId,
        sendToType = 2,
        sendMsgType = "TextMsg",
        groupid = 0,
        content = msg,
        pi机器人ase64Buf = "",
        --发本地送图片的buf 转 bas64 编码 文本型
        fileMd5 = "",
		picUrl = "",
        atUser = 0
        }
    )
	return ApiRet
end

--单纯发私聊消息用
function sendfrimsg(CurrentQQ,data,msg)
    ApiRet = Api.Api_SendMsg(
        CurrentQQ,
        {
        toUser = data.FromUin,
        sendToType = 1,
        sendMsgType = "TextMsg",
        groupid = 0,
        content = msg,
        pi机器人ase64Buf = "",
        --发本地送图片的buf 转 bas64 编码 文本型
        fileMd5 = "",
		picUrl = "",
        atUser = 0
        }
    )
	return ApiRet
end

--单纯发json消息用
function sedjsonmsg(CurrentQQ,data,msg)
    ApiRet = Api.Api_SendMsg(
        CurrentQQ,
        {
        toUser = data.FromGroupId,
        sendToType = 2,
        sendMsgType = "JsonMsg",
        groupid = 0,
        content = msg,
        pi机器人ase64Buf = "",
        --发本地送图片的buf 转 bas64 编码 文本型
        fileMd5 = "",
		picUrl = "",
        atUser = 0
        }
    )
	return ApiRet
end

--聊天模块切换函数
function liaotian(CurrentQQ,data,msg)
    mim = Read("mimoio\/机器配置\/机器主人\/"..data.FromGroupId.."\/"..data.FromUserId..".txt")
    if (mim == nil) then
        sedmsg(CurrentQQ,data,"∴你不是我主人呐")
        return 1
    end
    str = Read("mimoio\/状态数据\/机器聊天\/"..data.FromGroupId..".txt")
	if (str == nil) then
        return 1
    end
	if (string.find(str, "关闭")) then
	    sedmsg(CurrentQQ,data,"机器聊天处于关闭状态\n∴请先开启机器聊天")
	    return 1
	end
	--切换处理
	file = io.open("mimoio\/机器配置\/机器聊天\/"..data.FromGroupId..".txt", "w")
	if (msg == 1) then
	    file:write("文字聊天")
	    sedmsg(CurrentQQ,data,"∴成功切换到文字聊天")
	elseif (msg == 2) then
	    file:write("语音聊天")
	    sedmsg(CurrentQQ,data,"∴成功切换到语音聊天")
	elseif (msg == 3) then
	    file:write("回复聊天")
	    sedmsg(CurrentQQ,data,"∴成功切换到回复聊天")
	end
	file:close()
end

--随机表情函数
function faceArray()
    faceArray = {"[表情147]","🍀","🔥","🍻","💎","[表情185]","[表情219]","[表情176]"}
    math.randomseed(os.time())
    num = math.random(1, 9)
    return faceArray[num]
end

--url编码转换
function escape(w)
	pattern="[^%w%d%._%-%* ]"
	s=string.gsub(w,pattern,function(c)
		local c=string.format("%%%02X",string.byte(c))
		return c
	end)
	s=string.gsub(s," ","+")
	return s
end

--读取数据函数
function Read(url)
    file = io.open(url, "r")
	if (file == nil) then
	    return nil
	else
        file:seek("set")
	    str = file:read("*a")
	    file:close()
        return str
	end
end

--写入数据函数
function Wirte(url,msg)
    file = io.open(url, "w+")
    file:write(msg)
	file:close()
    return "ok"
end

--小思聊天函数
function xiaosiapi(CurrentQQ,data,str)
    response, error_message =
            http.request(
            "GET",
            "https://api.ownthink.com/bot",
            {
                query = "appid="..tostring(data.FromUserId).."&spoken=" .. url_encode(str),
                headers = {
                    Accept = "*/*"
                }
            }
        )
        html = response.body
		jData = json.decode(html)
		return jData
end

--机器聊天函数
function ownthink(CurrentQQ,data,msgs,atqq)
    if (tostring(atqq) == CurrentQQ) then
        m = Read("mimoio\/状态数据\/机器聊天\/"..data.FromGroupId..".txt")
        if (m == nil) then
	        log.info("Str ====> %s", m)
            return 1
	    end
	    if (string.find(m, "关闭")) then
	        sedmsg(CurrentQQ,data,"机器聊天处于关闭状态\n∴请先开启机器聊天")
	        return 1
	    end
		res2 = string.find(msgs, " ")
		str = string.sub(msgs,res2)
		jData = xiaosiapi(CurrentQQ,data,str)
		Data = json.decode(data.Content)
		m = Read("mimoio\/机器配置\/机器聊天\/"..data.FromGroupId..".txt")
		if (m == nil) then
	        log.info("Str ====> %s", m)
            return 1
	    end
		if (string.find(m, "回复聊天")) then
		    Api.Api_SendMsg(
                CurrentQQ,
                {
                toUser = data.FromGroupId,
                sendToType = 2,
                sendMsgType = "ReplayMsg",
                groupid = 0,
                content = jData.data.info.text,
                atUser = 0,
				replayInfo = {
                    MsgSeq = data.MsgSeq,
                    --回复消息的Seq
                    MsgTime = data.MsgTime,
                    --回复消息的事件
                    UserID = data.FromUserId,
                    --回复消息对象
                    RawContent = Data.Content --回复消息的原内容
                }
				}
            )
			return 1
		elseif (string.find(m, "文字聊天")) then
		    sedmsg(CurrentQQ,data,jData.data.info.text)
		else
		    sedvoicemsg(CurrentQQ,data,url_encode(jData.data.info.text))
		end
    end
end

--发送语音消息
function sedvoicemsg(CurrentQQ,data,str)
    ApiRet = Api.Api_SendMsg(
        CurrentQQ,
        {
        toUser = data.FromGroupId,
        sendToType = 2,
        sendMsgType = "VoiceMsg",
        groupid = 0,
		voiceUrl = "https://dds.dui.ai/runtime/v1/synthesize?voiceId=qianranfa&speed=0.7&volume=100&audioType=wav&text="..str, --发送语音的网络地址 文本型
        voiceBase64Buf = "",
        content = "",
        atUser = 0
        }
    )
	return ApiRet
end

--天气查询函数
function tianqi(CurrentQQ,data)
    keyWord = data.Content:gsub("天气", "")
        if keyWord == "" then
            return 1
        end

        cookies = Api.Api_GetUserCook(CurrentQQ)

        response, error_message =
            http.request(
            "GET",
            "https://weather.mp.qq.com/cgi-bin/rich",
            {
                query = "g_tk=" .. cookies.Gtk .. "&city=" .. url_encode(keyWord),
                headers = {
                    Referer = "http://weather.mp.qq.com/ark"
                },
                cookies = {
                    uin = CurrentQQ,
                    skey = cookies.Skey
                }
            }
        )
        local html = response.body
        log.notice("From Lua html -->%s", html)

        local j = json.decode(html)
        if j.code ~= 0 then
            return 1
        end

        ApiRet =
            Api.Api_SendMsg(
            CurrentQQ,
            {
                toUser = data.FromGroupId,
                sendToType = 2,
                sendMsgType = "JsonMsg",
                groupid = 0,
                content = string.format(
                    --{"config":{"forward":1,"autosize":1},"prompt":"[应用]天气","app":"com.tencent.weather","ver":"0.0.0.1","view":"RichInfoView","meta":{"richinfo":{"adcode":"101210701","city":"成都","air":"58","min":"20","ts":"1500550866","wind":"1","date":"6月27日 周四","max":"28","type":"201"}},"desc":"天气"}
                    --[[{"app":"com.tencent.weather","desc":"","meta":{"weather":{"ad":[{"icon":"http://imgcache.qq.com/ac/tq/xz2/tp.jpg","p":"ptype=star","t":"2","title":"星座 | 今天会因为感情和家庭的问题，影响工作，还有，也要注意人...","url":""},{"icon":"http://imgcache.qq.com/ac/qqweather/image/2019/6/27.png","p":"ptype=lunar","t":"4","title":"黄历 | 农历五月廿五。宜订盟.纳采.出行.祈福.斋醮.安床.会...","url":""}],"info":{"it1":{"adcode":"101050101","city":"武汉","hour":"18","max":"29","min":"17","temp":"24","type":"202","ut":"1561630401","wea":"多云"},"it2":{"hour":"19","temp":"22","type":"202"},"it3":{"hour":"20","temp":"21","type":"202"},"ts":"1561631244"},"url":""}},"prompt":"【哈尔滨】多云 17°/29°, 18:13更新~","ver":"1.0.0.106","view":"WeatherThreeView"}]]
                    [[{"app":"com.tencent.weather","desc":"天气","view":"RichInfoView","ver":"1.0.0.217","prompt":"[应用]天气","meta":{"richinfo":{"adcode":"%s","air":"%s","city":"%s","date":"%s","max":"%s","min":"%s","ts":"1554951408","type":"%s","wind":"%s"}},"config":{"forward":1,"autosize":1,"type":"card"}}]],
                    j.data.adcode,
                    j.data.air,
                    j.data.city,
                    j.data.date,
                    j.data.max,
                    j.data.min,
                    j.data.type,
                    j.data.wind
                ),
                atUser = 0
            }
        )
end

--调教处理函数(待处理)
function tiaojiao(CurrentQQ,data)
    mim = Read("mimoio\/机器配置\/机器主人\/"..data.FromGroupId.."\/"..data.FromUserId..".txt")
	if (mim == nil) then
		sedmsg(CurrentQQ,data,"∴你不是我主人哇")
		return 1
	end
	if (string.find(data.Content, "^删除调教")) then
	    msg = data.Content:gsub("删除调教", "")
	    if (msg == "") then
		    sedmsg(CurrentQQ,data,"要删除的调教指令不能为空哦")
		    return 1
		end
		rese = Read("mimoio\/机器调教\/"..tostring(data.FromGroupId).."\/"..msg..".txt")
	    if (rese == nil) then
			sedmsg(CurrentQQ,data,"这个指令不存在了哦")
		    return 1
		end
		rm_file = os.remove("mimoio\/机器调教\/"..tostring(data.FromGroupId).."\/"..msg..".txt")
		log.info("删除调教 ====> %s", rm_file)
		sedmsg(CurrentQQ,data,"删除成功\n你不喜欢被这样调教的我吗[表情9]")
		return 1
	end
    msgs = data.Content:gsub("调教", "")
		res2 = string.find(msgs, "#")
		str = string.sub(msgs,res2+1)
		str2 = string.sub(msgs,1,res2-1)
		        
		        if (str == "") then
		            sedmsg(CurrentQQ,data,"调教的回答内容不能为空哦")
			        return 1
		        end
				if (str2 == "") then
		            sedmsg(CurrentQQ,data,"调教的指令内容不能为空哦")
			        return 1
		        end
		        rese = Read("mimoio\/机器调教\/"..data.FromGroupId.."\/"..str2..".txt")
					if (rese ~= nil) then
				        sedmsg(CurrentQQ,data,"指令已经存在了哦")
				        return 1
				    end
				Wirte("mimoio\/机器调教\/"..data.FromGroupId.."\/"..str2..".txt",str)
				sedmsg(CurrentQQ,data,"调教成功\n你还想再调教我一次吗[表情6]")
		        return 1
end

function url_encode(str)
    if (str) then
        str = string.gsub(str, "\n", "\r\n")
        str =
            string.gsub(
            str,
            "([^%w ])",
            function(c)
                return string.format("%%%02X", string.byte(c))
            end
        )
        str = string.gsub(str, " ", "+")
    end
    return str
end

--抢红包处理
function RedBag(CurrentQQ, data)
    Api.Api_OpenRedBag(CurrentQQ, data.RedBaginfo)
    if (data.RedBaginfo.RedType == 12) then
         luaRes =
                Api.Api_SendMsg(
                CurrentQQ,
                {
                    toUser = data.FromGroupId,
                    sendToType = 2,
                    sendMsgType = "TextMsg",
                    groupid = 0,
                    content = data.RedBaginfo.Tittle,
                    atUser = 0
                }
            )
        log.notice("From Lua SendMsg Ret\n%d", luaRes.Ret)
    end
end

--视频解析处理
function Video(CurrentQQ, data)
    vdata = json.decode(data.Content)
        videodata = {
            GroupID = data.FromGroupId,
            VideoUrl = vdata.VideoUrl,
            VideoMd5 = vdata.VideoMd5
        }
        --构造table 参数表
        luaResp = Api.Api_CallFunc(CurrentQQ, "PttCenterSvr.ShortVideoDownReq", videodata) --通过cmd调用功能包
        luaRes =
            Api.Api_SendMsg(
            CurrentQQ,
            {
                toUser = data.FromGroupId,
                sendToType = 2,
                sendMsgType = "TextMsg",
                groupid = 0,
                content = "解析视频URL-->" .. luaResp.VideoUrl,
                atUser = 0
            }
        )
end

--管理开关通用
function adminio(CurrentQQ,data,oio)
    mim = Read("mimoio\/机器配置\/机器主人\/"..data.FromGroupId.."\/"..data.FromUserId..".txt")
        if (mim ~= nil) then
            msg = data.Content:gsub(oio, "")
            str = Read("mimoio\/状态数据\/机器开关\/"..data.FromGroupId..CurrentQQ..".txt")
            if (string.find(str, "关闭")) then
                sedmsg(CurrentQQ,data,"∴机器人已被关闭...\n请先开启机器人")
                return 1
            end
			str2 = Read("mimoio\/状态数据\/"..oio.."\/"..data.FromGroupId..".txt")
			if (string.find(str2, msg)) then
			    sedmsg(CurrentQQ,data,"∴"..oio.."本就是"..str2.."状态")
                return 1
			end
            Wirte("mimoio\/状态数据\/"..oio.."\/"..data.FromGroupId..".txt",msg)
            sedmsg(CurrentQQ,data,"∴"..oio..msg.."成功")
            return 1
        else
            sedmsg(CurrentQQ,data,"∴你不是我主人呐")
            return 1
        end
end

--百科大全
function baike(CurrentQQ,data)
    keyWord = data.Content:gsub("百科", "")
        if keyWord == "" then
            return 1
        end
        response, error_message =
            http.request(
            "GET",
            "http://baike.baidu.com/api/openapi/BaikeLemmaCardApi",
            {
                query = "scope=103&format=json&appid=379020&bk_key=" .. url_encode(keyWord) .. "&bk_length=600"
            }
        )
        html = response.body
        while(string.find(html, '"errno":2')) do
            response, error_message =
            http.request(
            "GET",
            "http://baike.baidu.com/api/openapi/BaikeLemmaCardApi",
            {
                query = "scope=103&format=json&appid=379020&bk_key=" .. url_encode(keyWord) .. "&bk_length=600"
            })
			html = response.body
        end
        local j = json.decode(html)
        sedmsg(CurrentQQ,data,j.abstract.."\n"..j.url)
end

--音乐点歌
function music(CurrentQQ,data)
    keyWord = data.Content:gsub("点歌", "")
        if keyWord == "" then
            return 1
        end
        response, error_message =
            http.request(
            "GET",
            "https://c.y.qq.com/soso/fcgi-bin/client_search_cp",
            {
                query = "aggr=1&cr=1&flag_qc=0&p=1&n=6&w=" .. url_encode(keyWord)
            }
        )
        html = response.body
		str = string.sub(html,10,-2)
        j = json.decode(str)
        if (j.code == 0) then
            msg = ""
            num = j.data.song.list
            list = num[1]
            songname = list.songname
            singername = list.singer[1].name
            payplay = list.pay.payplay
			albummid = list.albummid
			songmid = list.songmid
	        sedjsonmsg(CurrentQQ,data,'{"app":"com.tencent.structmsg","desc":"音乐","view":"music","ver":"0.0.0.1","prompt":"[分享]' ..songname.. '","meta":{"music":{"sourceMsgId":"0","title":"' ..songname.. '","desc":"' ..singername.. '","preview":"y.gtimg.cn/music/photo_new/T002R150x150M000'..albummid..'.jpg","tag":"QQ音乐","musicUrl":"https://v1.itooi.cn/tencent/url?id='..songmid..'","jumpUrl":"y.qq.com/n/yqq/song/'..songmid..'.html","appid":100497308,"app_type":1,"action":"","source_url":"url.cn/5aSZ8Gc","source_icon":"url.cn/5tLgzTm","android_pkg_name":"com.tencent.qqmusic"}},"config":{"forward":true,"type":"normal","autosize":true}}')
			return 1
        else
            sedmsg(CurrentQQ,data,"∴Error:"..j.code)
			return 1
        end
end

--访问url
function geturl(url_class,url,caulrt)
        response, error_message =
            http.request(
            url_class,
            url,
            {
                query = caulrt
            }
        )
        html = response.body
		return html
end

--消息储蓄
function msgsql(CurrentQQ,data)
    if (mysqlpass == "") then
	    return 1
	end
    c = mysql.new()
    -- 初始化mysql对象
    ok, err = c:connect({host = mysqlhost, port = 3306, database = mysqldb, user = mysqluser, password = mysqlpass})
    --建立连接
    if ok then
        sqlstr =
            string.format(
            [[INSERT INTO msgcache (GroupID, MsgSeq, MsgRandom,MsgType,Data,MsgTime)VALUES (%d,%d,%d,'%s','%s',%d)]],
            data.FromGroupId,
            data.MsgSeq,
            data.MsgRandom,
            data.MsgType,
            data.Content,
            data.MsgTime
        )
        res, err = c:query(sqlstr) --入库缓存消息
        log.info("%s", err)
        c.close(c)
    --释放连接
    end
    return 1
end

--撤回检测
function CheHui(CurrentQQ, data, extData)
    c = mysql.new()
    -- 初始化mysql对象
	if (mysqlpass == "") then
	    return 1
	end
	
    if data.MsgType == "ON_EVENT_GROUP_REVOKE" then --监听 群撤回事件
        str = string.format("群成 %d  成员 UserID %s 撤回了消息Seq %s \n", extData.GroupID, extData.UserID, extData.MsgSeq)
        log.info("%s", str)
        ok, err = c:connect({host = mysqlhost, port = 3306, database = mysqldb, user = mysqluser, password = mysqlpass})
        --建立连接
        log.info("sql %v", err)
        if ok then
            sqlstr =
                string.format(
                "select * from msgcache where `GroupID`= %d and `MsgSeq` = %d",
                extData.GroupID,
                extData.MsgSeq
            )
            res, err = c:query(sqlstr) --跟群群id和消息SEQ查询出撤回的消息内容
            if err == nil then
                c.close(c)
                GroupID = tonumber(res[1]["GroupID"])
                MsgType = res[1]["MsgType"]
                Data = res[1]["Data"]

                if MsgType == "TextMsg" then
                    Api.Api_SendMsg(
                        CurrentQQ,
                        {
                            toUser = GroupID,
                            sendToType = 2,
                            sendMsgType = "TextMsg",
                            --发送文本消息
                            groupid = 0,
                            content = string.format(
                                "捕获到成员 %d\n═══════════\n撤回了一条文本消息\n消息内容为：\n%s",
                                extData.UserID,
                                Data
                            ),
                            atUser = 0
                        }
                    )
                end
                if MsgType == "SmallFaceMsg" then
                    --Data {"Content":"[表情101]","Hex":"FKY=","Index":101,"tips":"[小表情]"}
                    Api.Api_SendMsg(
                        CurrentQQ,
                        {
                            toUser = GroupID,
                            sendToType = 2,
                            sendMsgType = "TextMsg",
                            groupid = 0,
                            content = string.format(
                                "捕获到成员 %d\n═══════════\n撤回了一条表情消息\n消息内容为：\n%s",
                                extData.UserID,
                                json.decode(Data).Content
                            ),
                            atUser = 0
                        }
                    )
                end
                if MsgType == "PicMsg" then
                    --Data {"Content":"","FileId":2820717626,"FileMd5":"q0oEC5aloJJMFr10mplaXw==","FileSize":7026,"tips":"[群图片]","url":"http://gchat.qpic.cn/gchatpic_new/1700487478/960839480-2534335053-AB4A040B96A5A0924C16BD749A995A5F/0?vuin=u0026term=255u0026pictype=0"}
                    jData = json.decode(Data)
					if (jData.tips == "[群消息-QQ闪照]") then
					    
					Api.Api_SendMsg( 
                    CurrentQQ,
                    {
                        toUser = GroupID,
                        sendToType = 2,
                        sendMsgType = "ForwordMsg",
                        content = "",
                        atUser = 0,
                        groupid = 0,
                        voiceUrl = "",
                        voiceBase64Buf = "",
                        picUrl = "",
                        pi机器人ase64Buf = "",
                        forwordBuf = json.decode(Data).ForwordBuf, --欲转发的base64buf 图片消息 视频消息 会给出此参数
                        forwordField = json.decode(Data).ForwordField --欲写入协议的字段ID 图片消息 视频消息 会给出此参数
                    }
                )
				    return 1
					end
                    Api.Api_SendMsg( --通过图片md5发送图片 秒发不用上传 相当于转发
                        CurrentQQ,
                        {
                            toUser = GroupID,
                            sendToType = 2,
                            sendMsgType = "PicMsg",
                            --发送图文消息
                            content = string.format(
                                "捕获到成员 %d\n═══════════\n撤回了一条图片消息\n消息内容为：[PICFLAG]%s",
                                extData.UserID,
                                jData.Content
                            ),
                            --通过宏[PICFLAG]改变图文顺序  改为现文字后图片
                            atUser = 0,
                            voiceUrl = "",
                            voiceBase64Buf = "",
                            picUrl = "",
                            pi机器人ase64Buf = "",
                            fileMd5 = jData.FileMd5
                        }
                    )
                end
                if MsgType == "AtMsg" then
                    --Data {"Content":"@Kar98k skjjkssjkjs","UserID":123456789,"tips":"[AT消息]"}
                    Api.Api_SendMsg(
                        CurrentQQ,
                        {
                            toUser = GroupID,
                            sendToType = 2,
                            sendMsgType = "TextMsg",
                            groupid = 0,
                            content = string.format(
                                "捕获到成员 %d\n═══════════\n撤回了一条at消息\n消息内容为：\n%s",
                                extData.UserID,
                                json.decode(Data).Content
                            ),
                            atUser = 0
                        }
                    )
                end
                if MsgType == "VoiceMsg" then
                    --Data {"tips":"[语音]","url":"http://grouptalk.c2c.qq.com/?ver=0u0026rkey=3062020101045b305902010102010102041fdef8ae042439416931554e5142586c536d78706a314c686843664959725f327a5f573064697653755902045dac2a21041f0000000866696c6574797065000000013100000005636f64656300000001310400u0026filetype=1u0026voice_codec=1"}
                    --log.info("sql %s", json.decode(Data).url)
                    Api.Api_SendMsg(
                        CurrentQQ,
                        {
                            toUser = GroupID,
                            sendToType = 2,
                            sendMsgType = "VoiceMsg",
                            --发送群语音消息
                            groupid = 0,
                            content = "",
                            atUser = 0,
                            voiceUrl = json.decode(Data).url,
                            --通过网络url进行发送语音
                            voiceBase64Buf = "",
                            picUrl = "",
                            pi机器人ase64Buf = ""
                        }
                    )
                end

                if MsgType == "ReplayMsg" then
                    --Data {"MsgSeq":3536,"ReplayContent":"11 @Mac","SrcContent":"...","UserID":123123,"tips":"[回复]"}
                    --log.info("sql %s", json.decode(Data).url)
                    Api.Api_SendMsg(
                        CurrentQQ,
                        {
                            toUser = GroupID,
                            sendToType = 2,
                            sendMsgType = "TextMsg",
                            groupid = 0,
                            content = string.format(
                                "捕获到成员 %d\n═══════════\n撤回了一条回复消息\n消息内容为：\n%s",
                                extData.UserID,
                                json.decode(Data).ReplayContent
                            ),
                            atUser = 0
                        }
                    )
                end
				if MsgType == "VideoMsg" then
	             Api.Api_SendMsg( 
                    CurrentQQ,
                    {
                        toUser = GroupID,
                        sendToType = 2,
                        sendMsgType = "ForwordMsg",
                        content = "",
                        atUser = 0,
                        groupid = 0,
                        voiceUrl = "",
                        voiceBase64Buf = "",
                        picUrl = "",
                        pi机器人ase64Buf = "",
                        forwordBuf = json.decode(Data).ForwordBuf, --欲转发的base64buf 图片消息 视频消息 会给出此参数
                        forwordField = json.decode(Data).ForwordField --欲写入协议的字段ID 图片消息 视频消息 会给出此参数
                    }
                )
				end
                if MsgType == "XmlMsg" then
				    
                    --Data {"MsgSeq":3536,"ReplayContent":"11 @Mac","SrcContent":"...","UserID":123123,"tips":"[回复]"}
                    --log.info("sql %s", json.decode(Data).url)
                    Api.Api_SendMsg(
                        CurrentQQ,
                        {
                            toUser = GroupID,
                            sendToType = 2,
                            sendMsgType = "XmlMsg",
                            groupid = 0,
                            content = string.format("%s", Data),
                            atUser = 0
                        }
                    )
                end
				if MsgType == "JsonMsg" then
				    
                    --Data {"MsgSeq":3536,"ReplayContent":"11 @Mac","SrcContent":"...","UserID":123123,"tips":"[回复]"}
                    --log.info("sql %s", json.decode(Data).url)
                    Api.Api_SendMsg(
                        CurrentQQ,
                        {
                            toUser = GroupID,
                            sendToType = 2,
                            sendMsgType = "JsonMsg",
                            groupid = 0,
                            content = string.format("%s", Data),
                            atUser = 0
                        }
                    )
                end
            end
        end
    end
    return 1
end
2020/09/06 23:36:48.375 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136464 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:474200814 MsgSeq:136464 UserID:1689236904]
2020/09/06 23:36:51.373 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136466 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:126103166 MsgSeq:136466 UserID:1689236904]
2020/09/06 23:36:53.804 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136468 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:1561574927 MsgSeq:136468 UserID:1689236904]
2020/09/06 23:36:56.540 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136470 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:797193631 MsgSeq:136470 UserID:1689236904]
2020/09/06 23:37:01.145 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136472 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:3050977805 MsgSeq:136472 UserID:1689236904]
2020/09/06 23:37:04.168 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136475 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:2164962582 MsgSeq:136475 UserID:1689236904]
2020/09/06 23:37:09.018 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136477 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:4145495905 MsgSeq:136477 UserID:1689236904]
2020/09/06 23:37:12.312 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136479 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:2475147882 MsgSeq:136479 UserID:1689236904]
2020/09/06 23:37:18.590 [E]  QQLuaVmRun CallGlobal err Unknow Lua Function:ReceiveEvents detail File weatherfy4a.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136482 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:1830697576 MsgSeq:136482 UserID:1689236904]
2020/09/06 23:37:41.462 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136484 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:3259470897 MsgSeq:136484 UserID:1689236904]
2020/09/06 23:37:58.848 [E]  QQLuaVmRun CallGlobal err <string>:42: context deadline exceeded
stack traceback:
	<string>:42: in main chunk
	[G]: ? detail File setulolicon.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{581168848 Diamond事务所·伍·楼 1042531394 王益达 涩图 TextMsg 1599406602 536890 1343848527 <nil>} 
2020/09/06 23:38:32.631 [E]  QQLuaVmRun CallGlobal err <string>:1140: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1140: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136486 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:850749327 MsgSeq:136486 UserID:1689236904]
2020/09/06 23:39:05.322 [E]  QQLuaVmRun CallGlobal err <string>:42: context deadline exceeded
stack traceback:
	<string>:42: in main chunk
	[G]: ? detail File setulolicon.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{581168848 Diamond事务所·伍·楼 2450459910 凤飞翱翔兮丷 涩图 TextMsg 1599406667 536895 2657435161 <nil>} 
2020/09/06 23:40:44.972 [E]  QQLuaVmRun CallGlobal err <string>:22: attempt to index a non-table object(nil) with key 'body'
stack traceback:
	<string>:22: in main chunk
	[G]: ? detail File setulolicon.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{581168848 Diamond事务所·伍·楼 1042531394 王益达 涩图 TextMsg 1599406827 536903 1882689186 <nil>} 
2020/09/06 23:43:29.548 [E]  QQLuaVmRun CallGlobal err Unknow Lua Function:ReceiveEvents detail File weatherfy4a.lua when  call ReceiveEvents params [0] 1689236904  [1] &{1146869436 1689236904 ON_EVENT_GROUP_ADMINSYSNOTIFY 0 退群消息 <nil>}  [2] &{1598785932121988 5 退群消息 1689236904 凤飞翱翔兮丷 已将你移出群   0 0 1146869436 1146869436 2450459910 凤飞翱翔兮丷 凤飞翱翔兮丷 0}
2020/09/06 23:50:51.303 [E]  QQLuaVmRun CallGlobal err <string>:1060: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1060: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136497 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:4212176253 MsgSeq:136497 UserID:1689236904]
2020/09/06 23:50:59.483 [E]  QQLuaVmRun CallGlobal err <string>:1060: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1060: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136499 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:2834457511 MsgSeq:136499 UserID:1689236904]
2020/09/06 23:51:07.481 [E]  QQLuaVmRun CallGlobal err <string>:1060: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1060: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136501 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:1931455739 MsgSeq:136501 UserID:1689236904]
2020/09/06 23:51:15.065 [E]  QQLuaVmRun CallGlobal err <string>:1060: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1060: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136503 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:3890624761 MsgSeq:136503 UserID:1689236904]
2020/09/06 23:51:43.070 [E]  QQLuaVmRun CallGlobal err <string>:1060: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1060: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136505 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:2107636955 MsgSeq:136505 UserID:1689236904]
2020/09/06 23:51:54.514 [E]  QQLuaVmRun CallGlobal err <string>:1060: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1060: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136508 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:3257991837 MsgSeq:136508 UserID:1689236904]
2020/09/06 23:51:55.672 [E]  QQLuaVmRun CallGlobal err <string>:1060: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1060: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136509 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:2917549050 MsgSeq:136509 UserID:1689236904]
2020/09/06 23:52:01.623 [E]  QQLuaVmRun CallGlobal err <string>:1060: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1060: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136511 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:217613075 MsgSeq:136511 UserID:1689236904]
2020/09/06 23:52:04.558 [E]  QQLuaVmRun CallGlobal err <string>:1060: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1060: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136513 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:3795390116 MsgSeq:136513 UserID:1689236904]
2020/09/06 23:52:10.656 [E]  QQLuaVmRun CallGlobal err <string>:1060: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1060: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136517 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:586812741 MsgSeq:136517 UserID:1689236904]
2020/09/06 23:52:10.725 [E]  QQLuaVmRun CallGlobal err <string>:1060: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1060: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136518 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:586812741 MsgSeq:136518 UserID:1689236904]
2020/09/06 23:52:30.912 [E]  QQLuaVmRun CallGlobal err <string>:1060: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1060: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136520 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:683139155 MsgSeq:136520 UserID:1689236904]
2020/09/06 23:52:40.517 [E]  QQLuaVmRun CallGlobal err <string>:1060: attempt to index a non-table object(nil) with key 'GroupID'
stack traceback:
	<string>:1060: in function 'CheHui'
	<string>:417: in main chunk
	[G]: ? detail File mimoio.lua when  call ReceiveEvents params [0] 1689236904  [1] &{383770908 0 ON_EVENT_GROUP_REVOKE 136523 群成员撤回消息事件 <nil>}  [2] map[AdminUserID:1689236904 GroupID:383770908 MsgRandom:1945070562 MsgSeq:136523 UserID:1689236904]
2020/09/06 23:53:23.747 [E]  QQLuaVmRun CallGlobal err <string>:42: context deadline exceeded
stack traceback:
	<string>:42: in main chunk
	[G]: ? detail File setulolicon.lua when  call ReceiveGroupMsg params [0] 1689236904  [1] &{581168848 Diamond事务所·伍·楼 714228069 @qq.com 涩图 TextMsg 1599406632 536891 946533762 <nil>} 
